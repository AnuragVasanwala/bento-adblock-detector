(self.AMP=self.AMP||[]).push({m:0,v:"2110121450047",n:"amp-story-panning-media",ev:"0.1",l:true,f:function(AMP,_){"use strict";function l(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var n="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function p(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],d=0;d<b.length;++d){var c=b[d];if(c&&c.Math==Math)return}(function(){throw Error("Cannot find global object")})()}p(this);"function"===typeof Symbol&&Symbol("x");var q;if("function"==typeof Object.setPrototypeOf)q=Object.setPrototypeOf;else{var r;a:{var t={a:!0},u={};try{u.__proto__=t;r=u.a;break a}catch(a){}r=!1}q=r?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var v=q;var w=Array.isArray;function x(){var a=this;this.promise=new Promise((function(b,d){a.resolve=b;a.reject=d}))}function z(a){a.tagName.startsWith("AMP-");if(a.createdCallback)return Promise.resolve(a);if(!a.__AMP_UPG_PRM){var b=new x;a.__AMP_UPG_PRM=b.promise;a.__AMP_UPG_RES=b.resolve}return a.__AMP_UPG_PRM}function A(a){var b;return!(null==(b=a.matchMedia("(prefers-reduced-motion: reduce)"))||!b.matches)}
/* https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function B(a,b){for(;a&&void 0!==a;a=a.parentElement)if(b(a))return a;return null}var C,D="Webkit webkit Moz moz ms O o".split(" ");function E(a,b){a=a.style;for(var d in b){var c=a,h=c.setProperty;var g=d;if(!g.startsWith("--")){C||(C=Object.create(null));var e=C[g];if(!e){e=g;if(void 0===a[g]){var f=g;f=f.charAt(0).toUpperCase()+f.slice(1);b:{for(var k=0;k<D.length;k++){var m=D[k]+f;if(void 0!==a[m]){f=m;break b}}f=""}void 0!==a[f]&&(e=f)}C[g]=e}g=e}h.call(c,g,String(b[d]),"important")}}function F(a,b){if(!isFinite(5))throw Error("Invalid depth: 5");if(a===b)return!0;for(a=[{a:a,b:b,depth:5}];0<a.length;){var d=a.shift();b=d.a;var c=d.b;d=d.depth;if(0<d){if(typeof b!==typeof c)return!1;if(w(b)&&w(c)){if(b.length!==c.length)return!1;for(var h=0;h<b.length;h++)a.push({a:b[h],b:c[h],depth:d-1});continue}else if(b&&c&&"object"===typeof b&&"object"===typeof c){var g=Object.keys(b),e=Object.keys(c);if(g.length!==e.length)return!1;h=g;var f="undefined"!=typeof Symbol&&Symbol.iterator&&h[Symbol.iterator];h=f?f.call(h):{next:l(h)};for(f=h.next();!f.done;f=h.next())f=f.value,a.push({a:b[f],b:c[f],depth:d-1});continue}}if(b!==c)return!1}return!0}function G(a,b,d){if(b(a))d();else{var c=(a.ownerDocument||a).defaultView;if(c.MutationObserver){var h=new c.MutationObserver((function(){b(a)&&(h.disconnect(),d())}));h.observe(a,{childList:!0})}else var g=c.setInterval((function(){b(a)&&(c.clearInterval(g),d())}),5)}}function H(a,b){G(a.documentElement,(function(){return!!a.body}),b)}function I(a){return new Promise((function(b){return H(a,b)}))}var J=self.AMP_CONFIG||{},K=("string"==typeof J.cdnProxyRegex?new RegExp(J.cdnProxyRegex):J.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function L(a){if(self.document&&self.document.head&&(!self.location||!K.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}J.cdnUrl||L("runtime-host");J.geoApiUrl||L("amp-geo-api");function N(a){if(!a)return[];for(var b=a.querySelectorAll("script[custom-element],script[custom-template]"),d=[],c=0;c<b.length;c++){var e,h=b[c],g=h.getAttribute("custom-element")||h.getAttribute("custom-template");if(e=h.src){var f=e.match(/^(.*)\/(.*)-([0-9.]+|latest)(\.max)?\.(?:js|mjs)$/i);e=f?f[2]:void 0;f=f?f[3]:void 0;e=e&&f?{extensionId:e,extensionVersion:f}:null}else e=null;g&&e&&d.push({script:h,extensionId:g,extensionVersion:e.extensionVersion})}return d}function aa(a){return N(a.document.head).some((function(b){var d=b.extensionVersion;return"amp-story"==b.extensionId&&"1.0"==d}))}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var O=self.__AMP_LOG;function P(){if(!O.user)throw Error("failed to call initLogConstructor");return O.user}function Q(a,b){a=R(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function S(a){var b=R(a)["story-store"];if(b){if(b.promise)return b.promise;Q(a,"story-store");return b.promise=Promise.resolve(b.obj)}return null}function R(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function ba(){var a=new x,b=a.promise,d=a.reject;a=a.resolve;b.catch((function(){}));return{obj:null,promise:b,resolve:a,reject:d,context:null,ctor:null}}function ca(a){var b=S(a);return b?b:da(a)}function da(a){return I(a.document).then((function(){var b=a;b=b.__AMP_TOP||(b.__AMP_TOP=b);b=Q(b,"extensions");return aa(b.win)?b.waitForExtension("amp-story","1.0"):null})).then((function(b){b?(b=S(a),b||(b=R(a),b["story-store"]=ba(),b=b["story-store"].promise)):b=null;return b}))}function T(a){var b=AMP.BaseElement.call(this,a)||this;b.j=a;b.h=null;b.o={};b.D=null;b.C={};b.B=null;b.G=null;b.F=!1;b.H=null;b.A=null;return b}var U=AMP.BaseElement;T.prototype=n(U.prototype);T.prototype.constructor=T;if(v)v(T,U);else for(var V in U)if("prototype"!=V)if(Object.defineProperties){var W=Object.getOwnPropertyDescriptor(U,V);W&&Object.defineProperty(T,V,W)}else T[V]=U[V];T.I=U.prototype;T.prototype.buildCallback=function(){var a=this;return ca(this.win).then((function(b){a.B=b}))};T.prototype.layoutCallback=function(){var a=this;this.h=this.j.querySelector("amp-img");this.A=this.j.getAttribute("group-id")||this.h.getAttribute("src");ea(this);return z(this.h).then((function(){return a.h.signals().whenSignal("load-end")})).then((function(){a.j.querySelector("img").classList="";X(a)})).catch((function(){return P().error("AMP_STORY_PANNING_MEDIA","Failed to load the amp-img.")}))};function ea(a){a.B.subscribe("pageSize",(function(){a.D={width:a.j.offsetWidth,height:a.j.offsetHeight};X(a);var c=parseFloat(a.j.getAttribute("data-x")||0),h=parseFloat(a.j.getAttribute("data-y")||0);var g=parseFloat(a.j.getAttribute("data-zoom")||1);if(a.j.hasAttribute("lock-bounds")){a.o.zoom=1>g?1:g;var e=a.D;g=e.height;var f=e.width;var k=a.h.getAttribute("width");e=a.h.getAttribute("height");k&&e||P().error("AMP_STORY_PANNING_MEDIA",'"lock-bounds" requires "width" and "height" to be set on the amp-img child.');var m=f/g<k/e?g/e:f/k;f=50*(1-f/(m*k*a.o.zoom));g=50*(1-g/(m*e*a.o.zoom));a.o.x=Math.max(-f,Math.min(c,f));a.o.y=Math.max(-g,Math.min(h,g))}else a.o={x:c,y:h,zoom:g};Y(a)}),!0);a.B.subscribe("currentPageId",(function(c){null==a.G&&(a.G=Z(a).getAttribute("id"));a.F=c===a.G;Y(a)}),!0);a.B.subscribe("panningMediaState",(function(c){1>=a.H&&c[a.A]&&!F(a.C,c[a.A])&&(a.C=c[a.A],fa(a))}),!0);var b={attributes:!0,attributeFilter:["distance"]},d=new MutationObserver((function(c){a.H=parseInt(c[0].target.getAttribute("distance"),10)}));Z(a)&&d.observe(Z(a),b)}function Y(a){if(a.F){var b=a.B.get("panningMediaState")[a.A];if(!b||A(a.win)){var d={};a.B.dispatch("addPanningMediaState",(d[a.A]=a.o,d))}else{var h,c=function(e){return.5>e?2*e*e:1-Math.pow(-2*e+2,2)/2},g=function(e){h||(h=e);var f=e-h;if(1e3>f){var k=a.o,m=k.x,ha=k.y;k=k.zoom;var y=c(f/1e3),M={};a.B.dispatch("addPanningMediaState",(M[a.A]={x:b.x+(m-b.x)*y,y:b.y+(ha-b.y)*y,zoom:b.zoom+(k-b.zoom)*y},M));a.F&&requestAnimationFrame(g)}else m={},a.B.dispatch("addPanningMediaState",(m[a.A]=a.o,m))};requestAnimationFrame(g)}}}function X(a){var b=a.j.querySelector("img");if(b){var d=a.D,c=d.width/d.height;d=a.h.getAttribute("width");var h=a.h.getAttribute("height"),g=d/h;a.mutateElement((function(){c<g?(E(a.h,{left:"auto",right:"auto",top:"0",bottom:"0",width:"auto",height:"100%"}),E(b,{width:"auto",height:"100%"})):(E(a.h,{left:"0",right:"0",top:"auto",bottom:"auto",width:"100%",height:"auto"}),E(b,{width:"100%",height:"auto"}))}))}}function fa(a){var b=a.C,d=b.x,c=b.y,h=b.zoom;a.mutateElement((function(){var g=a.h;var e=(h-1)/h;e=isFinite(e)?e:-1e5;E(g,{transform:"translate3d("+d+"%, "+c+"%, "+e+"px)"})}))}function Z(a){return B(a.element,(function(b){return"amp-story-page"===b.tagName.toLowerCase()}))}T.prototype.isLayoutSupported=function(a){return"fill"==a};AMP.registerElement("amp-story-panning-media",T,"amp-story-panning-media{display:-ms-flexbox!important;display:flex!important;-ms-flex-pack:center!important;justify-content:center!important;-ms-flex-align:center!important;align-items:center!important;perspective:1px!important}amp-story-panning-media amp-img{-webkit-backface-visibility:hidden!important;backface-visibility:hidden!important}amp-story-grid-layer[template=fill] amp-story-panning-media amp-img img{position:relative!important;display:inline-block!important}\n/*# sourceURL=/extensions/amp-story-panning-media/0.1/amp-story-panning-media.css*/")}});//# sourceMappingURL=amp-story-panning-media-0.1.js.map