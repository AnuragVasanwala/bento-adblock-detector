(self.AMP=self.AMP||[]).push({m:0,v:"2110121450047",n:"amp-access-laterpay",ev:"0.1",l:false,f:function(AMP,_){"use strict";
/*
    https://mths.be/cssescape v1.5.1 by @mathias | MIT license */var g=self.AMP_CONFIG||{},m=("string"==typeof g.cdnProxyRegex?new RegExp(g.cdnProxyRegex):g.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function n(a){if(self.document&&self.document.head&&(!self.location||!m.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}g.cdnUrl||n("runtime-host");g.geoApiUrl||n("amp-geo-api");var p=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function q(a,b){var c=b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(d){return c}}function r(a){a=(a||self).location;a=a.originalHash||a.hash;var b=Object.create(null);if(a)for(var c;c=p.exec(a);){var d=q(c[1],c[1]);c=c[2]?q(c[2].replace(/\+/g," "),c[2]):"";b[d]=c}return b}var t="";self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var u=self.__AMP_LOG;function v(){throw Error("failed to call initLogConstructor")}function w(){u.user||(u.user=v());return u.user}function x(a,b,c,d,e,f){return w().assert(a,b,c,d,e,f,void 0,void 0,void 0,void 0,void 0)}var y;function z(){return y?y:y=Promise.resolve(void 0)}function A(){var a=this;this.promise=new Promise((function(b,c){a.resolve=b;a.reject=c}))}function B(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return C(a,b)}function D(a){var b=E(a);b=F(b);return C(b,"viewport")}function E(a){return a.nodeType?B((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function F(a){a=E(a);return a.isSingleDoc()?a.win:a}function C(a,b){a=G(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function H(a){var b=G(a).access;if(b){if(b.promise)return b.promise;C(a,"access");return b.promise=Promise.resolve(b.obj)}return null}function G(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function I(){var a=new A,b=a.promise,c=a.reject;a=a.resolve;b.catch((function(){}));return{obj:null,promise:b,resolve:a,reject:c,context:null,ctor:null}}function J(a){return M(a).then((function(b){return x(b,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.","access","amp-access","amp-access","amp-access")}))}function M(a){var b=H(F(a));if(b)return b;var c=E(a);return c.whenExtensionsKnown().then((function(){var d=c.getExtensionVersion("amp-access");return d?B(c.win,"extensions").waitForExtension("amp-access",d):null})).then((function(d){if(d){var e=F(a);var f=H(e);f?e=f:(e=G(e),e.access=I(),e=e.access.promise)}else e=null;return e}))}var N;function aa(a,b,c){function d(k){try{return f(k)}catch(K){var l,L;null==(L=(l=self).__AMP_REPORT_ERROR)||L.call(l,K);throw K}}var e=a,f=c,h=ba();e.addEventListener(b,d,h?void 0:!1);return function(){var k;null==(k=e)||k.removeEventListener(b,d,h?void 0:!1);d=e=f=null}}function ba(){if(void 0!==N)return N;N=!1;try{var a={get capture(){N=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return N}function O(a,b,c){return aa(a,b,c)}function ca(a,b){var c=a.getHeadNode(),d=da(c,ea(c));if(b){var e=a.getRootNode();if(P(e,d))b(d);else var f=setInterval((function(){P(e,d)&&(clearInterval(f),b(d))}),4)}}function da(a,b){var c=a.__AMP_CSS_SM;c||(c=a.__AMP_CSS_SM=Object.create(null));var d=Q(a,c,"amp-extension=amp-access-laterpay");if(d)return d.textContent!==b&&(d.textContent=b),d;var e=(a.ownerDocument||a).createElement("style");e.textContent=b;e.setAttribute("amp-extension","amp-access-laterpay");b=Q(a,c,"amp-runtime");(b=void 0===b?null:b)?a.insertBefore(e,b.nextSibling):a.insertBefore(e,a.firstChild);return c["amp-extension=amp-access-laterpay"]=e}function Q(a,b,c){return b[c]?b[c]:(a=a.querySelector("style["+c+"]"))?b[c]=a:null}function ea(a){return(a=a.__AMP_CSS_TR)?a(".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.1/amp-access-laterpay.css*/"):".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.1/amp-access-laterpay.css*/"}function P(a,b){var c=a.styleSheets;for(a=0;a<c.length;a++)if(c[a].ownerNode==b)return!0;return!1}var fa={eu:"https://connector.laterpay.net",us:"https://connector.uselaterpay.com"},ha={eu:"https://connector.sandbox.laterpaytest.net",us:"https://connector.sandbox.uselaterpaytest.com"},ia={premiumContentTitle:"Buy only this article",payLaterButton:"Buy Now, Pay Later",payNowButton:"Buy Now",defaultButton:"Buy Now",alreadyPurchasedLink:"I already bought this",sandbox:"Site in test mode. No payment required."};function R(a,b){this.ampdoc=a.ampdoc;this.B=b;this.P=D(this.ampdoc);this.h=this.B.getAdapterConfig();this.D=this.F=this.o=null;this.J=[];this.G=!0;this.I=this.C=this.j=null;this.L=this.h.locale||"en";this.A=Object.assign({},ia,this.h.localeMessages||{});this.H=ja(this)+"/api/v1/public/amp?article_url=CANONICAL_URL&amp_reader_id=READER_ID&return_url=RETURN_URL";var c=this.h.articleId;c&&(this.H+="&article_id="+encodeURIComponent(c));this.O=C(this.ampdoc.win,"timer");this.K=B(this.ampdoc.win,"vsync");this.R=B(this.ampdoc.win,"xhr");ca(this.ampdoc,(function(){}))}function ja(a){var b=a.h.region||"eu",c=self;if(c.__AMP_MODE)c=c.__AMP_MODE;else{var d=r(c)||r(c);d=["1","actions","amp","amp4ads","amp4email"].includes(d.development)||!!c.AMP_DEV_MODE;if(!t){var e;t=(null==(e=c.AMP_CONFIG)?void 0:e.v)||"012110121450047"}c=c.__AMP_MODE={localDev:!1,development:d,esm:!1,test:!1,rtvVersion:t}}return c.development&&a.h.configUrl?a.h.configUrl:a.h.sandbox?ha[b]:fa[b]}R.prototype.authorize=function(){var a=this;return ka(this).then((function(b){if(204===b.status)throw w().createError("No merchant domains have been matched for this article, or no paid content configurations are setup.");a.h.scrollToTopAfterAuth&&a.K.mutate((function(){return a.P.setScrollTop(0)}));S(a);return{access:b.access}}),(function(b){if(!b||!b.response)throw b;var c=b.response;if(402!==c.status)throw b;return c.json().catch((function(){})).then((function(d){a.o=d;S(a).then(a.N.bind(a));return{access:!1}}))}))};function ka(a){var b=a.H+"&article_title="+encodeURIComponent(T(a));return a.B.buildUrl(b,!1).then((function(c){return a.B.getLoginUrl(c)})).then((function(c){(u.dev||(u.dev=v())).info("amp-access-laterpay","Authorization URL: ",c);return a.O.timeoutPromise(3e3,a.R.fetchJson(c,{credentials:"include"})).then((function(d){return d.json()}))}))}function U(a,b){return a.ampdoc.win.document.createElement(b)}function T(a){var b=a.ampdoc.getRootNode().querySelector(a.h.articleTitleSelector);x(b,"No article title element found with selector %s",a.h.articleTitleSelector);return b.textContent.trim()}function V(a){var b=a.ampdoc.getElementById("amp-access-laterpay-dialog");return w().assertElement(b,"No element found with id amp-access-laterpay-dialog")}function S(a){if(a.G)return z();for(var b;b=a.J.shift();)b();a.F&&(a.F(),a.F=null);a.D&&(a.D(),a.D=null);return a.K.mutatePromise((function(){a.G=!0;a.j=null;for(var c=V(a);c.firstChild;)c.removeChild(c.firstChild)}))}R.prototype.N=function(){var a=this,b=V(this);this.j=U(this,"div");this.j.className="amp-access-laterpay-container";this.h.sandbox&&W(this,"sandbox");W(this,"header");var c=U(this,"ul");this.o.premiumcontent.title=this.A.premiumContentTitle;this.o.premiumcontent.description=T(this);c.appendChild(X(this,this.o.premiumcontent));this.o.timepasses.forEach((function(e){c.appendChild(X(a,e))}));this.o.subscriptions.forEach((function(e){c.appendChild(X(a,e))}));var d=U(this,"button");d.className="amp-access-laterpay-purchase-button";d.textContent=this.A.defaultButton;this.I=d;this.F=O(d,"click",(function(e){Y(a,e,a.C.value,a.C.dataset.purchaseType)}));this.j.appendChild(c);this.j.appendChild(d);this.j.appendChild(la(this,this.o.apl));W(this,"footer");b.appendChild(this.j);b.appendChild(ma(this));this.G=!1;na(this,c.firstElementChild)};function na(a,b){var c=b.querySelector('input[type="radio"]');c.checked=!0;Z(a,c)}function W(a,b){if(a.A[b]){var c=U(a,"p");c.className="amp-access-laterpay-"+b;c.textContent=a.A[b];a.j.appendChild(c)}}function ma(a){var b=U(a,"a");b.href="https://laterpay.net";b.target="_blank";b.textContent="LaterPay";a=U(a,"p");a.className="amp-access-laterpay-badge";a.textContent="Powered by ";a.appendChild(b);return a}function X(a,b){var c=U(a,"li"),d=U(a,"label");d.for=b.title;var e=d.appendChild,f=U(a,"input");f.name="purchaseOption";f.type="radio";f.id=b.title;f.value=b.purchase_url;var h="ppu"===b.purchase_type?"payLater":"payNow";f.setAttribute("data-purchase-action-label",a.A[h+"Button"]);f.setAttribute("data-purchase-type",h);a.J.push(O(f,"change",a.M.bind(a)));e.call(d,f);var k=U(a,"div");k.className="amp-access-laterpay-metadata";e=U(a,"span");e.className="amp-access-laterpay-title";e.textContent=b.title;k.appendChild(e);e=U(a,"p");e.className="amp-access-laterpay-description";e.textContent=b.description;k.appendChild(e);d.appendChild(k);c.appendChild(d);e=c.appendChild;h=b.price;f=Object.keys(h)[0];var l=(h[f]/100).toLocaleString(a.L,{style:"decimal",minimumFractionDigits:0});h=U(a,"span");h.className="amp-access-laterpay-price";h.textContent=l;l=U(a,"sup");l.className="amp-access-laterpay-currency";l.textContent=f;a=U(a,"p");a.className="amp-access-laterpay-price-container";a.appendChild(h);a.appendChild(l);e.call(c,a);return c}function la(a,b){var c=U(a,"p");c.className="amp-access-laterpay-already-purchased-link-container";var d=U(a,"a");d.href=b;d.textContent=a.A.alreadyPurchasedLink;a.D=O(d,"click",(function(e){Y(a,e,b,"alreadyPurchased")}));c.appendChild(d);return c}R.prototype.M=function(a){a.preventDefault();Z(this,a.target)};function Z(a,b){var c=a.C,d=b.dataset.purchaseActionLabel;c&&c.classList.contains("amp-access-laterpay-selected")&&c.classList.remove("amp-access-laterpay-selected");a.C=b;a.C.classList.add("amp-access-laterpay-selected");a.I.textContent=d}function Y(a,b,c,d){b.preventDefault();a.B.buildUrl(c,!1).then((function(e){(u.dev||(u.dev=v())).fine("amp-access-laterpay","Authorization URL: ",e);a.B.loginWithUrl(e,d)}))}R.prototype.pingback=function(){return z()};AMP.registerServiceForDoc("laterpay",(function(a){a=a.getHeadNode();return J(a).then((function(b){var c=b.getVendorSource("laterpay"),d=new R(b,c);c.getAdapter().registerVendor(d);return d}))}))}});//# sourceMappingURL=amp-access-laterpay-0.1.js.map