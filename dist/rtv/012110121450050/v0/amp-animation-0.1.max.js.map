{
  "version": 3,
  "sources": ["../../src/core/data-structures/promise.js", "../../src/core/mode/prod.js", "../../src/core/mode/test.js", "../../src/core/mode/local-dev.js", "../../src/core/mode/minified.js", "../../src/core/mode/version.js", "../../src/core/mode/esm.js", "../../src/core/types/array.js", "../../src/core/types/enum.js", "../../src/core/types/string/index.js", "../../src/core/types/object/index.js", "../../src/core/types/index.js", "../../src/core/error/message-helpers.js", "../../src/core/assert/base.js", "../../src/core/assert/dev.js", "../../src/core/constants/action-constants.js", "../../src/core/types/object/json.js", "../../src/core/window/index.js", "../../third_party/css-escape/css-escape.js", "../../src/core/dom/css-selectors.js", "../../src/core/dom/query.js", "../../src/core/dom/index.js", "../../src/core/error/index.js", "../../src/core/dom/style.js", "../../src/core/math.js", "../../src/config.js", "../../src/core/types/string/url.js", "../../src/mode.js", "../../src/service/extension-script.js", "../../src/utils/log.js", "../../src/service-helpers.js", "../../src/element-service.js", "../../src/service/index.js", "../../src/core/dom/event-helper-listen.js", "../../src/utils/event-helper.js", "../../extensions/amp-animation/0.1/install-polyfill.js", "../../extensions/amp-animation/0.1/web-animation-types.js", "../../src/core/dom/layout/rect.js", "../../src/experiments/index.js", "../../extensions/amp-animation/0.1/parsers/css-expr-ast.js", "../../build/parsers/css-expr-impl.js", "../../extensions/amp-animation/0.1/parsers/css-expr.js", "../../extensions/amp-animation/0.1/parsers/keyframes-extractor.js", "../../src/core/data-structures/observable.js", "../../extensions/amp-animation/0.1/runners/animation-runner.js", "../../extensions/amp-animation/0.1/runners/utils.js", "../../extensions/amp-animation/0.1/runners/native-web-animation-runner.js", "../../extensions/amp-animation/0.1/runners/scrolltimeline-worklet-runner.js", "../../src/core/data-structures/lru-cache.js", "../../src/url.js", "../../src/iframe-helper.js", "../../extensions/amp-animation/0.1/web-animations.js", "../../extensions/amp-animation/0.1/web-animation-service.js", "../../src/pass.js", "../../extensions/amp-animation/0.1/amp-animation.js"],
  "sourcesContent": ["let resolved;\n\n/**\n * Returns a cached resolved promise.\n * Babel converts direct calls to Promise.resolve() (with no arguments) into\n * calls to this.\n *\n * @return {!Promise<undefined>}\n */\nexport function resolvedPromise() {\n  if (resolved) {\n    return resolved;\n  }\n\n  // It's important that we call with `undefined` here, to prevent a transform\n  // recursion. If we didn't pass an arg, then the transformer would replace\n  // this callsite with a call to `resolvedPromise()`.\n  resolved = Promise.resolve(undefined);\n  return resolved;\n}\n\n/**\n * Returns a Deferred struct, which holds a pending promise and its associated\n * resolve and reject functions.\n *\n * This is preferred instead of creating a Promise instance to extract the\n * resolve/reject functions yourself:\n *\n * ```\n * // Avoid doing\n * let resolve;\n * const promise = new Promise(res => {\n *   resolve = res;\n * });\n *\n * // Good\n * const deferred = new Deferred();\n * const { promise, resolve } = deferred;\n * ```\n *\n * @template T\n */\nexport class Deferred {\n  /** Constructor. */\n  constructor() {\n    /** @const {!Promise<T>} */\n    this.promise = new /*OK*/ Promise((res, rej) => {\n      /** @const {function(T=)} */\n      this.resolve = res;\n      /** @const {function(*=)} */\n      this.reject = rej;\n    });\n  }\n}\n\n/**\n * Creates a promise resolved to the return value of fn.\n * If fn sync throws, it will cause the promise to reject.\n *\n * @param {function():T} fn\n * @return {!Promise<T>}\n * @template T\n */\nexport function tryResolve(fn) {\n  return new Promise((resolve) => {\n    resolve(fn());\n  });\n}\n\n/**\n * Resolves with the result of the last promise added.\n * @implements {IThenable}\n */\nexport class LastAddedResolver {\n  /**\n   * @param {!Array<!IThenable>=} opt_promises\n   */\n  constructor(opt_promises) {\n    /** @private @const {!Deferred} */\n    this.deferred_ = new Deferred();\n\n    /** @private */\n    this.count_ = 0;\n\n    if (opt_promises) {\n      for (const promise of opt_promises) {\n        this.add(promise);\n      }\n    }\n  }\n\n  /**\n   * Add a promise to possibly be resolved.\n   * @param {!IThenable} promise\n   * @return {!Promise}\n   */\n  add(promise) {\n    const countAtAdd = ++this.count_;\n    promise.then(\n      (result) => {\n        if (this.count_ === countAtAdd) {\n          this.deferred_.resolve(result);\n        }\n      },\n      (error) => {\n        // Don't follow behavior of Promise.all and Promise.race error so that\n        // this will only reject when most recently added promise fails.\n        if (this.count_ === countAtAdd) {\n          this.deferred_.reject(error);\n        }\n      }\n    );\n    return this.deferred_.promise;\n  }\n\n  /** @override */\n  then(opt_resolve, opt_reject) {\n    return this.deferred_.promise.then(opt_resolve, opt_reject);\n  }\n}\n", "/**\n * Returns true when the build is meant for distribution.\n * This means `amp dist` was called _without_ the --fortesting flag.\n *\n * This is a magic constant replaced by babel.\n *\n * Calls are DCE'd when compiled.\n * @return {boolean}\n */\nexport function isProd() {\n  return IS_PROD;\n}\n", "import {isProd} from './prod';\n\n/**\n * Returns true if executing in a testing environment. Calls may be DCE'd when\n * compiled based on isForDistribution.\n * @param {!Window=} opt_win\n * @return {boolean}\n */\nexport function isTest(opt_win) {\n  if (isProd()) {\n    return false;\n  }\n  const win = opt_win || self;\n  return !!(win.AMP_CONFIG?.test || win.__AMP_TEST || win['__karma__']);\n}\n", "import {isProd} from './prod';\nimport {isTest} from './test';\n\n/**\n * Returns true if executing in a local development or testing environment.\n * Calls may be DCE'd when compiled based on isForDistribution and isTest.\n *\n * @param {!Window=} opt_win\n * @return {boolean}\n */\nexport function isLocalDev(opt_win) {\n  if (isProd()) {\n    return false;\n  }\n\n  return !!self.AMP_CONFIG?.localDev || isTest(opt_win);\n}\n", "/**\n * Returns true whenever closure compiler is used.\n * This is a magic constant that is replaced by babel.\n *\n * @return {boolean}\n */\nexport function isMinified() {\n  return IS_MINIFIED;\n}\n", "/**\n * Returns the internal AMP runtime version. Note that this is not the RTV,\n * which is a prefix and the runtime version.\n *\n * The call sites for this function are replaced with a compile time constant\n * string.\n *\n * @return {string}\n */\nexport function version() {\n  return INTERNAL_RUNTIME_VERSION;\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isProd} from './prod';\n\n/**\n * Returns true when compiling an esm binary.\n * This is a magic constant that is replaced by babel.\n *\n * @return {boolean}\n */\nexport function isEsm() {\n  if (isProd()) {\n    return IS_ESM;\n  }\n\n  return self?.__AMP_MODE?.esm ?? IS_ESM;\n}\n", "/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  return arrayLike ? Array.prototype.slice.call(arrayLike) : [];\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport const {isArray} = Array;\n\n/**\n * If the specified argument is an array, it's returned as is. If it's a\n * single item, the array containing this item is created and returned.\n *\n * The double-template pattern here solves a bug where CC can be passed a value\n * with declared type {string|!Array<string>} and return a value with a type of\n * {!Array<string|Array<string>>}.\n *\n * @param {!Array<T>|S} arrayOrSingleItem\n * @return {!Array<T>|!Array<S>}\n * @template S\n * @template T\n */\nexport function arrayOrSingleItemToArray(arrayOrSingleItem) {\n  return isArray(arrayOrSingleItem)\n    ? /** @type {!Array<T>} */ (arrayOrSingleItem)\n    : [/** @type {!S} */ (arrayOrSingleItem)];\n}\n\n/**\n * Compares if two arrays contains exactly same elements of same number\n * of same order. Note that it does NOT handle NaN case as expected.\n *\n * @param {!Array<T>} arr1\n * @param {!Array<T>} arr2\n * @return {boolean}\n * @template T\n */\nexport function areEqualOrdered(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Removes elements that shouldRemove returns true for from the array.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} shouldRemove\n * @return {!Array<T>}\n * @template T\n */\nexport function remove(array, shouldRemove) {\n  const removed = [];\n  let index = 0;\n  for (let i = 0; i < array.length; i++) {\n    const item = array[i];\n    if (shouldRemove(item, i, array)) {\n      removed.push(item);\n    } else {\n      if (index < i) {\n        array[index] = item;\n      }\n      index++;\n    }\n  }\n  if (index < array.length) {\n    array.length = index;\n  }\n  return removed;\n}\n\n/**\n * Returns the index of the first element matching the predicate.\n * Like Array#findIndex.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} predicate\n * @return {number}\n * @template T\n */\nexport function findIndex(array, predicate) {\n  for (let i = 0; i < array.length; i++) {\n    if (predicate(array[i], i, array)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Converts the given iterator to an array.\n *\n * @param {!Iterator<T>} iterator\n * @return {Array<T>}\n * @template T\n */\nexport function fromIterator(iterator) {\n  const array = [];\n  for (let e = iterator.next(); !e.done; e = iterator.next()) {\n    array.push(e.value);\n  }\n  return array;\n}\n\n/**\n * Adds item to array if it is not already present.\n *\n * @param {Array<T>} array\n * @param {T} item\n * @return {boolean}\n * @template T\n */\nexport function pushIfNotExist(array, item) {\n  if (array.indexOf(item) < 0) {\n    array.push(item);\n    return true;\n  }\n  return false;\n}\n\n/**\n * Removes the first matching item in the array. Returns `true` if the array\n * has changed.\n *\n * @param {!Array<T>} array\n * @param {T} item\n * @return {boolean}\n * @template T\n */\nexport function removeItem(array, item) {\n  const index = array.indexOf(item);\n  if (index == -1) {\n    return false;\n  }\n  array.splice(index, 1);\n  return true;\n}\n\n/**\n * Returns the last item in an array.\n *\n * @param {Array<T>} array\n * @template T\n * @return {?T}\n */\nexport function lastItem(array) {\n  return array[array.length - 1];\n}\n", "/**\n * Checks whether `val` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} val\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, val) {\n  for (const k in enumObj) {\n    if (enumObj[k] === val) {\n      return true;\n    }\n  }\n  return false;\n}\n", "/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} match\n * @return {string}\n */\nfunction prependDashAndToLowerCase(match) {\n  return '-' + match.toLowerCase();\n}\n\n/**\n * @param {string} name Attribute name containing dashes.\n * @return {string} Dashes removed and successive character sent to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * Converts a string that is in camelCase to one that is in dash-case.\n *\n * @param {string} string The string to convert.\n * @return {string} The string in dash-case.\n */\nexport function camelCaseToDash(string) {\n  return string.replace(/(?!^)[A-Z]/g, prependDashAndToLowerCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.includes.\n * @param {string} string\n * @param {string} substring\n * @param {number=} start\n * @return {boolean}\n */\nexport function includes(string, substring, start) {\n  if (typeof start !== 'number') {\n    start = 0;\n  }\n  if (start + substring.length > string.length) {\n    return false;\n  }\n  return string.indexOf(substring, start) !== -1;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n * @return {string}\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n\n/**\n * Hash function djb2a\n * This is intended to be a simple, fast hashing function using minimal code.\n * It does *not* have good cryptographic properties.\n * @param {string} str\n * @return {string} 32-bit unsigned hash of the string\n */\nexport function stringHash32(str) {\n  const {length} = str;\n  let hash = 5381;\n  for (let i = 0; i < length; i++) {\n    hash = (hash * 33) ^ str.charCodeAt(i);\n  }\n  // Convert from 32-bit signed to unsigned.\n  return String(hash >>> 0);\n}\n\n/**\n * Trims a string on the end, removing whitespace characters.\n * @param {string} str  A string to trim.\n * @return {string} The string, with trailing whitespace removed.\n */\nexport function trimEnd(str) {\n  // TODO(sparhami) Does this get inlined for an ES2019 build?\n  if (str.trimEnd) {\n    return str.trimEnd();\n  }\n\n  return ('_' + str).trim().slice(1);\n}\n\n/**\n * Trims any leading whitespace from a string.\n * @param {string} str  A string to trim.\n * @return {string} The string, with leading whitespace removed.\n */\nexport function trimStart(str) {\n  if (str.trimStart) {\n    return str.trimStart();\n  }\n\n  return (str + '_').trim().slice(0, -1);\n}\n\n/**\n * Wrapper around String.replace that handles asynchronous resolution.\n * @param {string} str\n * @param {RegExp} regex\n * @param {Function|string} replacer\n * @return {!Promise<string>}\n */\nexport function asyncStringReplace(str, regex, replacer) {\n  if (isString(replacer)) {\n    return Promise.resolve(str.replace(regex, replacer));\n  }\n  const stringBuilder = [];\n  let lastIndex = 0;\n\n  str.replace(regex, function (match) {\n    // String.prototype.replace will pass 3 to n number of arguments to the\n    // callback function based on how many capture groups the regex may or may\n    // not contain. We know that the match will always be first, and the\n    // index will always be second to last.\n    const matchIndex = arguments[arguments.length - 2];\n    stringBuilder.push(str.slice(lastIndex, matchIndex));\n    lastIndex = matchIndex + match.length;\n\n    // Store the promise in it's eventual string position.\n    const replacementPromise = replacer.apply(null, arguments);\n    stringBuilder.push(replacementPromise);\n  });\n  stringBuilder.push(str.slice(lastIndex));\n\n  return Promise.all(stringBuilder).then((resolved) => resolved.join(''));\n}\n\n/**\n * Pads the beginning of a string with a substring to a target length.\n * @param {string} s\n * @param {number} targetLength\n * @param {string} padString\n * @return {string}\n */\nexport function padStart(s, targetLength, padString) {\n  if (s.length >= targetLength) {\n    return s;\n  }\n  targetLength = targetLength - s.length;\n  let padding = padString;\n  while (targetLength > padding.length) {\n    padding += padString;\n  }\n  return padding.slice(0, targetLength) + s;\n}\n\n/**\n * Tests if a value is a string.\n * @param {?} s\n * @return {boolean}\n */\nexport function isString(s) {\n  return typeof s == 'string';\n}\n", "/* @const */\nconst {hasOwnProperty: hasOwn_, toString: toString_} = Object.prototype;\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString_.call(value) === '[object Object]';\n}\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Return an empty JsonObject or makes the passed in object literal\n * an JsonObject.\n * The JsonObject type is just a simple object that is at-dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * The linter enforces that the argument is, in fact, at-dict like.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  // We do not copy. The linter enforces that the passed in object is a literal\n  // and thus the caller cannot have a reference to it.\n  return /** @type {!JsonObject} */ (opt_initial || {});\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Deep merges source into target.\n *\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} depth The maximum merge depth. If exceeded, Object.assign\n *                       will be used instead.\n * @return {!Object}\n * @throws {Error} If source contains a circular reference.\n * Note: Only nested objects are deep-merged, primitives and arrays are not.\n */\nexport function deepMerge(target, source, depth = 10) {\n  // Keep track of seen objects to detect recursive references.\n  const seen = [];\n\n  /** @type {!Array<{t: !Object, s: !Object, d: number}>} */\n  const queue = [];\n  queue.push({t: target, s: source, d: 0});\n\n  // BFS to ensure objects don't have recursive references at shallower depths.\n  while (queue.length > 0) {\n    const {d, s, t} = queue.shift();\n    if (seen.includes(s)) {\n      throw new Error('Source object has a circular reference.');\n    }\n    seen.push(s);\n    if (t === s) {\n      continue;\n    }\n    if (d > depth) {\n      Object.assign(t, s);\n      continue;\n    }\n    for (const key of Object.keys(s)) {\n      const newValue = s[key];\n      // Perform a deep merge IFF both target and source have the same key\n      // whose corresponding values are objects.\n      if (hasOwn(t, key)) {\n        const oldValue = t[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({t: oldValue, s: newValue, d: d + 1});\n          continue;\n        }\n      }\n      t[key] = newValue;\n    }\n  }\n  return target;\n}\n\n/**\n * @param {!Object} o An object to remove properties from\n * @param {!Array<string>} props A list of properties to remove from the Object\n * @return {!Object} An object with the given properties removed\n */\nexport function omit(o, props) {\n  return Object.keys(o).reduce((acc, key) => {\n    if (!props.includes(key)) {\n      acc[key] = o[key];\n    }\n    return acc;\n  }, {});\n}\n\n/**\n * @param {!Object|null|undefined} o1\n * @param {!Object|null|undefined} o2\n * @return {boolean}\n */\nexport function objectsEqualShallow(o1, o2) {\n  if (o1 == null || o2 == null) {\n    // Null is only equal to null, and undefined to undefined.\n    return o1 === o2;\n  }\n\n  for (const k in o1) {\n    if (o1[k] !== o2[k]) {\n      return false;\n    }\n  }\n  for (const k in o2) {\n    if (o2[k] !== o1[k]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * @param {T} obj\n * @param {string} prop\n * @param {function(T, string):R} factory\n * @return {R}\n * @template T,R\n */\nexport function memo(obj, prop, factory) {\n  let result = /** @type {?R} */ (obj[prop]);\n  if (result === undefined) {\n    result = factory(obj, prop);\n    obj[prop] = result;\n  }\n  return result;\n}\n\n/**\n * Recreates objects with prototype-less copies.\n * @param {!JsonObject} obj\n * @return {!JsonObject}\n */\nexport function recreateNonProtoObject(obj) {\n  const copy = map();\n  for (const k in obj) {\n    if (!hasOwn(obj, k)) {\n      continue;\n    }\n    const v = obj[k];\n    copy[k] = isObject(v) ? recreateNonProtoObject(v) : v;\n  }\n  return /** @type {!JsonObject} */ (copy);\n}\n\n/**\n * Returns a value from an object for a field-based expression. The expression\n * is a simple nested dot-notation of fields, such as `field1.field2`. If any\n * field in a chain does not exist or is not an object or array, the returned\n * value will be `undefined`.\n *\n * @param {!JsonObject} obj\n * @param {string} expr\n * @return {*}\n */\nexport function getValueForExpr(obj, expr) {\n  // The `.` indicates \"the object itself\".\n  if (expr == '.') {\n    return obj;\n  }\n  // Otherwise, navigate via properties.\n  const parts = expr.split('.');\n  let value = obj;\n  for (const part of parts) {\n    if (\n      part &&\n      value &&\n      value[part] !== undefined &&\n      typeof value == 'object' &&\n      hasOwn(value, part)\n    ) {\n      value = value[part];\n      continue;\n    }\n    value = undefined;\n    break;\n  }\n  return value;\n}\n", "// Export all type-checking helpers for convenience\nexport {isArray} from './array';\nexport {isEnumValue} from './enum';\nexport {isString} from './string';\nexport {isObject} from './object';\n\n/**\n * Determines if value is an ELement\n * @param {*} value\n * @return {boolean}\n */\nexport function isElement(value) {\n  return value?.nodeType == /* Node.ELEMENT_NODE */ 1;\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return typeof value === 'number' && isFinite(value);\n}\n", "import {isElement} from '#core/types';\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n/**\n * Four zero width space.\n *\n * @const {string}\n */\nexport const USER_ERROR_EMBED_SENTINEL = '\\u200B\\u200B\\u200B\\u200B';\n\n/**\n * Converts an element to a readable string; all other types are unchanged.\n * TODO(rcebulko): Unify with log.js\n * @param {*} val\n * @return {*}\n */\nexport function elementStringOrPassThru(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (isElement(val)) {\n    val = /** @type {Element} */ (val);\n    return val.tagName.toLowerCase() + (val.id ? `#${val.id}` : '');\n  }\n  return val;\n}\n\n/**\n * Tests if an error message contains the user sentinel.\n * @param {string} message\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a a user error from an iframe embed.\n */\nexport function isUserErrorEmbedMessage(message) {\n  return message.indexOf(USER_ERROR_EMBED_SENTINEL) >= 0;\n}\n\n/**\n * Strips the user error sentinel from an error message.\n * @param {string} message\n * @return {string} The new message without USER_ERROR_SENTINEL\n */\nexport function stripUserError(message) {\n  return message.replace(USER_ERROR_SENTINEL, '');\n}\n", "import {elementStringOrPassThru} from '#core/error/message-helpers';\nimport {isArray, isElement, isString} from '#core/types';\nimport {remove} from '#core/types/array';\n\n/**\n * @fileoverview This file provides the base implementation for assertion\n * functions. Most files should never import from this; instead, import from\n * `dev` or `user`. It is also used by the Log class for its assertions.\n */\n\n/**\n * A base assertion function, provided to various assertion helpers.\n * @typedef {function(?, string=, ...*):?|function(?, !Array<*>)}\n */\nexport let AssertionFunctionDef;\n\n/**\n * Throws an error if the second argument isn't trueish.\n *\n * Supports argument substitution into the message via %s placeholders.\n *\n * Throws an error object that has two extra properties:\n * - messageArray: The elements of the substituted message as non-stringified\n *   elements in an array. When e.g. passed to console.error this yields\n *   native displays of things like HTML elements.\n * @param {?string} sentinel\n * @param {T} shouldBeTruthy\n * @param {string} opt_message\n * @param {...*} var_args Arguments substituted into %s in the message\n * @return {T}\n * @template T\n * @throws {Error} when shouldBeTruthy is not truthy.\n */\nexport function assert(\n  sentinel,\n  shouldBeTruthy,\n  opt_message = 'Assertion failed',\n  var_args\n) {\n  if (shouldBeTruthy) {\n    return shouldBeTruthy;\n  }\n\n  // Include the sentinel string if provided and not already present\n  if (sentinel && opt_message.indexOf(sentinel) == -1) {\n    opt_message += sentinel;\n  }\n\n  // Skip the first 3 arguments to isolate format params\n  // const messageArgs = Array.prototype.slice.call(arguments, 3);\n  // Index at which message args start\n  let i = 3;\n\n  // Substitute provided values into format string in message\n  const splitMessage = opt_message.split('%s');\n  let message = splitMessage.shift();\n  const messageArray = [message];\n\n  while (splitMessage.length) {\n    const subValue = arguments[i++];\n    const nextConstant = splitMessage.shift();\n\n    message += elementStringOrPassThru(subValue) + nextConstant;\n    messageArray.push(subValue, nextConstant.trim());\n  }\n\n  const error = new Error(message);\n  error.messageArray = remove(messageArray, (x) => x !== '');\n  // __AMP_REPORT_ERROR is installed globally per window in the entry point in\n  // AMP documents. It may not be present for Bento/Preact elements on non-AMP\n  // pages.\n  self.__AMP_REPORT_ERROR?.(error);\n  throw error;\n}\n\n/**\n * Asserts types, backbone of `assertNumber`, `assertString`, etc.\n *\n * It understands array-based \"id\"-contracted messages.\n *\n * Otherwise creates a sprintf syntax string containing the optional message or the\n * default. The `subject` of the assertion is added at the end.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {T} subject\n * @param {*} shouldBeTruthy\n * @param {string} defaultMessage\n * @param {!Array<*>|string=} opt_message\n * @return {T}\n * @template T\n * @private\n */\nfunction assertType_(\n  assertFn,\n  subject,\n  shouldBeTruthy,\n  defaultMessage,\n  opt_message\n) {\n  if (isArray(opt_message)) {\n    assertFn(\n      shouldBeTruthy,\n      /** @type {!Array} */ (opt_message).concat([subject])\n    );\n  } else {\n    assertFn(shouldBeTruthy, `${opt_message || defaultMessage}: %s`, subject);\n  }\n\n  return subject;\n}\n\n/**\n * Throws an error if the first argument isn't an Element.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeElement\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {!Element} The value of shouldBeTrueish.\n * @throws {Error} when shouldBeElement is not an Element\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertElement(assertFn, shouldBeElement, opt_message) {\n  return /** @type {!Element} */ (\n    assertType_(\n      assertFn,\n      shouldBeElement,\n      isElement(shouldBeElement),\n      'Element expected',\n      opt_message\n    )\n  );\n}\n\n/**\n * Throws an error if the first argument isn't a string. The string can\n * be empty.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeString\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {string} The string value. Can be an empty string.\n * @throws {Error} when shouldBeString is not an String\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertString(assertFn, shouldBeString, opt_message) {\n  return /** @type {string} */ (\n    assertType_(\n      assertFn,\n      shouldBeString,\n      isString(shouldBeString),\n      'String expected',\n      opt_message\n    )\n  );\n}\n\n/**\n * Throws an error if the first argument isn't a number. The allowed values\n * include `0` and `NaN`.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeNumber\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {number} The number value. The allowed values include `0`\n *   and `NaN`.\n * @throws {Error} when shouldBeNumber is not an Number\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertNumber(assertFn, shouldBeNumber, opt_message) {\n  return /** @type {number} */ (\n    assertType_(\n      assertFn,\n      shouldBeNumber,\n      typeof shouldBeNumber == 'number',\n      'Number expected',\n      opt_message\n    )\n  );\n}\n\n/**\n * Throws an error if the first argument is not an array.\n * The array can be empty.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeArray\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {!Array} The array value\n * @throws {Error} when shouldBeArray is not an Array\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertArray(assertFn, shouldBeArray, opt_message) {\n  return /** @type {!Array} */ (\n    assertType_(\n      assertFn,\n      shouldBeArray,\n      isArray(shouldBeArray),\n      'Array expected',\n      opt_message\n    )\n  );\n}\n\n/**\n * Throws an error if the first argument isn't a boolean.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeBoolean\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {boolean} The boolean value.\n * @throws {Error} when shouldBeBoolean is not an Boolean\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertBoolean(assertFn, shouldBeBoolean, opt_message) {\n  return /** @type {boolean} */ (\n    assertType_(\n      assertFn,\n      shouldBeBoolean,\n      !!shouldBeBoolean === shouldBeBoolean,\n      'Boolean expected',\n      opt_message\n    )\n  );\n}\n", "import * as mode from '#core/mode';\n\nimport * as assertions from './base';\n\n/**\n * @fileoverview This file provides the entrypoint for dev assertions. It's\n * designed so all functions are pure function calls to improve inlining. All\n * functions in this file get DCE'd away during compilation.\n */\n\n/**\n * This will never execute regardless, but will be included on unminified builds\n * builds. It will be DCE'd away from minified builds, and so can be used to\n * validate that Babel is properly removing dev assertions in minified builds.\n */\nfunction devAssertDceCheck() {\n  if (self.__AMP_ASSERTION_CHECK) {\n    console /*OK*/\n      .log('__devAssert_sentinel__');\n  }\n}\n\n/**\n * Throws an error if the first argument isn't trueish. Mirrors devAssert in\n * src/log.js.\n * @param {T} shouldBeTruthy\n * @param {string=} opt_message\n * @param {*=} opt_1 Optional argument (var arg as individual params for better\n * @param {*=} opt_2 Optional argument inlining)\n * @param {*=} opt_3 Optional argument\n * @param {*=} opt_4 Optional argument\n * @param {*=} opt_5 Optional argument\n * @param {*=} opt_6 Optional argument\n * @param {*=} opt_7 Optional argument\n * @param {*=} opt_8 Optional argument\n * @param {*=} opt_9 Optional argument\n * @return {T}\n * @template T\n * @throws {Error} when shouldBeTruthy is not truthy.\n * @closurePrimitive {asserts.truthy}\n */\nexport function devAssert(\n  shouldBeTruthy,\n  opt_message,\n  opt_1,\n  opt_2,\n  opt_3,\n  opt_4,\n  opt_5,\n  opt_6,\n  opt_7,\n  opt_8,\n  opt_9\n) {\n  if (mode.isMinified()) {\n    return shouldBeTruthy;\n  }\n  devAssertDceCheck();\n\n  return assertions.assert(\n    '',\n    shouldBeTruthy,\n    opt_message,\n    opt_1,\n    opt_2,\n    opt_3,\n    opt_4,\n    opt_5,\n    opt_6,\n    opt_7,\n    opt_8,\n    opt_9\n  );\n}\n\n/**\n * Throws an error if the first argument isn't an Element.\n *\n * For more details see `assert`.\n *\n * @param {*} shouldBeElement\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {!Element} The value of shouldBeTrueish.\n * @throws {Error} when shouldBeElement is not an Element\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function devAssertElement(shouldBeElement, opt_message) {\n  if (mode.isMinified()) {\n    return /** @type {!Element} */ (shouldBeElement);\n  }\n  devAssertDceCheck();\n\n  return assertions.assertElement(\n    /** @type {!assertions.AssertionFunctionDef} */ (devAssert),\n    shouldBeElement,\n    opt_message\n  );\n}\n\n/**\n * Throws an error if the first argument isn't a string. The string can\n * be empty.\n *\n * For more details see `assert`.\n *\n * @param {*} shouldBeString\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {string} The string value. Can be an empty string.\n * @throws {Error} when shouldBeString is not an String\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function devAssertString(shouldBeString, opt_message) {\n  if (mode.isMinified()) {\n    return /** @type {string} */ (shouldBeString);\n  }\n  devAssertDceCheck();\n\n  return assertions.assertString(\n    /** @type {!assertions.AssertionFunctionDef} */ (devAssert),\n    shouldBeString,\n    opt_message\n  );\n}\n\n/**\n * Throws an error if the first argument isn't a number. The allowed values\n * include `0` and `NaN`.\n *\n * For more details see `assert`.\n *\n * @param {*} shouldBeNumber\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {number} The number value. The allowed values include `0`\n *   and `NaN`.\n * @throws {Error} when shouldBeNumber is not an Number\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function devAssertNumber(shouldBeNumber, opt_message) {\n  if (mode.isMinified()) {\n    return /** @type {number} */ (shouldBeNumber);\n  }\n  devAssertDceCheck();\n\n  return assertions.assertNumber(\n    /** @type {!assertions.AssertionFunctionDef} */ (devAssert),\n    shouldBeNumber,\n    opt_message\n  );\n}\n\n/**\n * Throws an error if the first argument is not an array.\n * The array can be empty.\n *\n * For more details see `assert`.\n *\n * @param {*} shouldBeArray\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {!Array} The array value\n * @throws {Error} when shouldBeArray is not an Array\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function devAssertArray(shouldBeArray, opt_message) {\n  if (mode.isMinified()) {\n    return /** @type {!Array} */ (shouldBeArray);\n  }\n  devAssertDceCheck();\n\n  return assertions.assertArray(\n    /** @type {!assertions.AssertionFunctionDef} */ (devAssert),\n    shouldBeArray,\n    opt_message\n  );\n}\n\n/**\n * Throws an error if the first argument isn't a boolean.\n *\n * For more details see `assert`.\n *\n * @param {*} shouldBeBoolean\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {boolean} The boolean value.\n * @throws {Error} when shouldBeBoolean is not an Boolean\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function devAssertBoolean(shouldBeBoolean, opt_message) {\n  if (mode.isMinified()) {\n    return /** @type {boolean} */ (shouldBeBoolean);\n  }\n  devAssertDceCheck();\n\n  return assertions.assertBoolean(\n    /** @type {!assertions.AssertionFunctionDef} */ (devAssert),\n    shouldBeBoolean,\n    opt_message\n  );\n}\n", "import {devAssert} from '#core/assert';\n\n/**\n * Key string in an action arguments map for an unparsed object literal string.\n *\n * E.g. for the action in <p on=\"tap:AMP.setState({foo: 'bar'})\",\n * then `args[RAW_OBJECT_ARGS_KEY]` is the string \"{foo: 'bar'}\".\n *\n * The action service delegates parsing of object literals to the corresponding\n * extension (in the example above, amp-bind).\n *\n * @see ./service/action-impl.ActionInfoDef\n * @const {string}\n */\nexport const RAW_OBJECT_ARGS_KEY = '__AMP_OBJECT_STRING__';\n\n/**\n * Identifier for an element's default action.\n *\n * @const {string}\n */\nexport const DEFAULT_ACTION = 'activate';\n\n/**\n * Corresponds to degree of user intent, i.e. events triggered with strong\n * user intent have high trust.\n *\n * @enum {number}\n */\nexport const ActionTrust = {\n  /**\n   * Events that are triggered without a user gesture, or triggered by a user\n   * gesture with weak intent (e.g. scroll) are \"low trust\".\n   *\n   * Actions that have low impact on the page's visual state should require\n   * \"low trust\" (e.g. pausing a video).\n   */\n  LOW: 1,\n  /**\n   * Events that are triggered nearly immediately (up to a few seconds) after\n   * a user gesture with strong intent (e.g. tap or swipe) are \"default trust\".\n   *\n   * Actions that can modify the page's visual state (e.g. content jumping)\n   * should require \"default trust\". This is the default required trust level\n   * for actions.\n   */\n  DEFAULT: 2,\n  /**\n   * Events that are triggered immediately after a user gesture with\n   * strong intent (e.g. tap or swipe) are \"high trust\".\n   *\n   * There are no actions yet that require high trust.\n   */\n  HIGH: 3,\n};\n\n/**\n * @param {!ActionTrust} actionTrust\n * @return {string}\n */\nexport function actionTrustToString(actionTrust) {\n  switch (actionTrust) {\n    case ActionTrust.LOW:\n      return 'low';\n    case ActionTrust.HIGH:\n      return 'high';\n    default:\n      devAssert(actionTrust === ActionTrust.DEFAULT);\n      return 'default';\n  }\n}\n", "import {isArray} from '#core/types/array';\n\n/**\n * @fileoverview This module declares JSON types as defined in the\n * {@link http://json.org/}.\n */\n\n// NOTE Type are changed to {*} because of\n// https://github.com/google/closure-compiler/issues/1999\n\n/**\n * JSON scalar. It's either string, number or boolean.\n * @typedef {string|number|boolean|null}\n */\nlet JSONScalarDef;\n\n/**\n * JSON object. It's a map with string keys and JSON values.\n * @typedef {!Object<string, ?*>} (* should be JSONValueDef)\n */\nlet JSONObjectDef;\n\n/**\n * JSON array. It's an array with JSON values.\n * @typedef {!Array<?*>} (* should be JSONValueDef)\n */\nlet JSONArrayDef;\n\n/**\n * JSON value. It's either a scalar, an object or an array.\n * @typedef {!JSONScalarDef|!JSONObjectDef|!JSONArrayDef}\n */\nlet JSONValueDef;\n\n/**\n * @typedef {{\n *   YOU_MUST_USE: string,\n *   jsonLiteral: function(),\n *   TO_MAKE_THIS_TYPE: string,\n * }}\n */\nlet InternalJsonLiteralTypeDef;\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {string} json JSON string to parse\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function parseJson(json) {\n  return /** @type {?JsonObject} */ (JSON.parse(json));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {string} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    opt_onFailed?.(e);\n    return null;\n  }\n}\n\n/**\n * Deeply checks strict equality of items in nested arrays and objects.\n *\n * @param {JSONValueDef} a\n * @param {JSONValueDef} b\n * @param {number} depth The maximum depth. Must be finite.\n * @return {boolean}\n * @throws {Error} If depth argument is not finite.\n */\nexport function deepEquals(a, b, depth = 5) {\n  if (!isFinite(depth) || depth < 0) {\n    throw new Error('Invalid depth: ' + depth);\n  }\n  if (a === b) {\n    return true;\n  }\n  /** @type {!Array<{a: JSONValueDef, b: JSONValueDef, depth: number}>} */\n  const queue = [{a, b, depth}];\n  while (queue.length > 0) {\n    const {a, b, depth} = queue.shift();\n    // Only check deep equality if depth > 0.\n    if (depth > 0) {\n      if (typeof a !== typeof b) {\n        return false;\n      } else if (isArray(a) && isArray(b)) {\n        if (a.length !== b.length) {\n          return false;\n        }\n        for (let i = 0; i < a.length; i++) {\n          queue.push({a: a[i], b: b[i], depth: depth - 1});\n        }\n        continue;\n      } else if (a && b && typeof a === 'object' && typeof b === 'object') {\n        const keysA = Object.keys(a);\n        const keysB = Object.keys(b);\n        if (keysA.length !== keysB.length) {\n          return false;\n        }\n        for (const k of keysA) {\n          queue.push({a: a[k], b: b[k], depth: depth - 1});\n        }\n        continue;\n      }\n    }\n    // If we get here, then depth == 0 or (a, b) are primitives.\n    if (a !== b) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * This helper function handles configurations specified in a JSON format.\n *\n * It allows the configuration is to be written in plain JS (which has better\n * dev ergonomics like comments and trailing commas), and allows the\n * configuration to be transformed into an efficient JSON-parsed representation\n * in the dist build. See https://v8.dev/blog/cost-of-javascript-2019#json\n *\n * @param {!Object} obj\n * @return {!JsonObject}\n */\nexport function jsonConfiguration(obj) {\n  return /** @type {!JsonObject} */ (obj);\n}\n\n/**\n * This converts an Object into a suitable type to be used in `includeJsonLiteral`.\n * This doesn't actually do any conversion, it only changes the closure type.\n *\n * @param {?JSONValueDef} value\n * @return {!InternalJsonLiteralTypeDef}\n */\nexport function jsonLiteral(value) {\n  return /** @type {!InternalJsonLiteralTypeDef} */ (value);\n}\n\n/**\n * Allows inclusion of a variable (that's wrapped in a jsonLiteral\n * call) to be included inside a jsonConfiguration.\n *\n * @param {!InternalJsonLiteralTypeDef} value\n * @return {*}\n */\nexport function includeJsonLiteral(value) {\n  return value;\n}\n", "/**\n * Externs declare that access `defaultView` from `document` or\n * `ownerDocument` is of type `(Window|null)` but most of our parameter types\n * assume that it is never null. This is OK in practice as we ever only get\n * null on disconnected documents or old IE.\n * This helper function casts it into just a simple Window return type.\n *\n * @param {?Window} winOrNull\n * @return {!Window}\n */\nexport function toWin(winOrNull) {\n  return /** @type {!Window} */ (winOrNull);\n}\n\n/**\n * Returns the associated Window for a node.\n *\n * @param {!Node} node\n * @return {!Window}\n */\nexport function getWin(node) {\n  return toWin(\n    (node.ownerDocument || /** @type {!Document} */ (node)).defaultView\n  );\n}\n", "/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n\n\n/**\n * This regex consists of 4 matching capture groups and one (non-matching) fallback:\n *\n * - (\\0), catch the null terminator character so it may be replaced by UTF\n *   Replacement Char\n * - ^(-)$, catch a solitary dash char, so that it may be backslash escaped.\n *   This is a separate capture group so that the legal-chars (group 4) doesn't\n *   capture it first, since that group doesn't need to escape its dash.\n * - ([\\x01-\\x1f\\x7f]|^-?[0-9]), catch a UTF control char, or any leading\n *   number (with an optional leading dash). The control or the number (but not\n *   the leading dash) must be hex-escaped,.\n * - ([\\x80-\\uffff0-9a-zA-Z_-]+), catch legal-chars, with the exception of a\n *   solitary dash, which will already have matched in group 1.\n * - [^], finally, a catch-all that allows us to backslash escape the char.\n *\n * Together, this matches everything necessary for CSS.escape.\n */\nvar regex = /(\\0)|^(-)$|([\\x01-\\x1f\\x7f]|^-?[0-9])|([\\x80-\\uffff0-9a-zA-Z_-]+)|[^]/g;\n\nfunction escaper(match, nil, dash, hexEscape, chars) {\n  // Chars is the legal-chars (group 4) capture\n  if (chars) {\n    return chars;\n  }\n  // Nil is the null terminator (group 1) capture\n  if (nil) {\n    return '\\uFFFD';\n  }\n  // Both UTF control chars, and leading numbers (with optional leading dash)\n  // (group 3) must be backslash escaped with a trailing space.  Funnily, the\n  // leading dash must not be escaped, but the number. :shrug:\n  if (hexEscape) {\n    return match.slice(0, -1) + '\\\\' + match.slice(-1).charCodeAt(0).toString(16) + ' '\n  }\n  // Finally, the solitary dash and the catch-all chars require backslash\n  // escaping.\n  return '\\\\' + match;\n}\n\n/**\n * https://drafts.csswg.org/cssom/#serialize-an-identifier\n * @param {string} value\n * @return {string}\n */\nexport function cssEscape(value) {\n  return String(value).replace(regex, escaper);\n}\n", "import {devAssert} from '#core/assert';\nimport * as mode from '#core/mode';\n\nimport {cssEscape} from '#third_party/css-escape/css-escape';\n\n/**\n * @type {boolean|undefined}\n */\nlet scopeSelectorSupported;\n\n/**\n * @param {boolean|undefined} val\n * @visibleForTesting\n */\nexport function setScopeSelectorSupportedForTesting(val) {\n  scopeSelectorSupported = val;\n}\n\n/**\n * Test that the :scope selector is supported and behaves correctly.\n * @param {!Element|!ShadowRoot} el\n * @return {boolean}\n */\nexport function isScopeSelectorSupported(el) {\n  if (scopeSelectorSupported !== undefined) {\n    return scopeSelectorSupported;\n  }\n\n  return (scopeSelectorSupported = testScopeSelector(el));\n}\n\n/**\n * Test that the :scope selector is supported and behaves correctly.\n * @param {!Element|!ShadowRoot} el\n * @return {boolean}\n */\nfunction testScopeSelector(el) {\n  try {\n    const doc = el.ownerDocument;\n    const testElement = doc.createElement('div');\n    const testChild = doc.createElement('div');\n    testElement.appendChild(testChild);\n    // NOTE(cvializ, #12383): Firefox's implementation is incomplete,\n    // therefore we test actual functionality of`:scope` as well.\n    return testElement./*OK*/ querySelector(':scope div') === testChild;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Prefixes a selector for ancestor selection. Splits in subselectors and\n * applies prefix to each.\n *\n * e.g.\n * ```\n *   prependSelectorsWith('div', '.i-amphtml-scoped');\n *   // => '.i-amphtml-scoped div'\n *   prependSelectorsWith('div, ul', ':scope');\n *   // => ':scope div, :scope ul'\n *   prependSelectorsWith('div, ul', 'article >');\n *   // => 'article > div, article > ul'\n * ```\n *\n * @param {string} selector\n * @param {string} distribute\n * @return {string}\n */\nexport function prependSelectorsWith(selector, distribute) {\n  return selector.replace(/^|,/g, `$&${distribute} `);\n}\n\n/**\n * Escapes an ident (ID or a class name) to be used as a CSS selector.\n *\n * See https://drafts.csswg.org/cssom/#serialize-an-identifier.\n *\n * @param {string} ident\n * @return {string}\n * @suppress {uselessCode}\n */\nexport function escapeCssSelectorIdent(ident) {\n  // This gets rewritten to true/false during compilation. It will trigger an\n  // JSC_UNREACHABLE_CODE warning, but that's intentional for DCE.\n  if (mode.isEsm()) {\n    return CSS.escape(ident);\n  }\n  return cssEscape(ident);\n}\n\n/**\n * Escapes an ident in a way that can be used by :nth-child() psuedo-class.\n *\n * See https://github.com/w3c/csswg-drafts/issues/2306.\n *\n * @param {string|number} ident\n * @return {string}\n */\nexport function escapeCssSelectorNth(ident) {\n  const escaped = String(ident);\n  // Ensure it doesn't close the nth-child psuedo class.\n  devAssert(escaped.indexOf(')') === -1);\n  return escaped;\n}\n", "import {devAssert, devAssertElement} from '#core/assert';\nimport * as mode from '#core/mode';\n\nimport {isScopeSelectorSupported, prependSelectorsWith} from './css-selectors';\n\n/** @fileoverview Helper functions for DOM queries. */\n\n/**\n * Asserts that name is just an alphanumeric word, and does not contain\n * advanced CSS selector features like attributes, psuedo-classes, class names,\n * nor ids.\n * @param {string} name\n */\nfunction assertIsName(name) {\n  devAssert(\n    /^[\\w-]+$/.test(name),\n    `Expected \"${name}\" to be a CSS name composed of alphanumerics and hyphens.`\n  );\n}\n\n/**\n * Finds all elements that matche `selector`, scoped inside `root`\n * for user-agents that do not support native scoping.\n *\n * This method isn't required for modern builds, can be removed.\n *\n * @param {!Element|!ShadowRoot} root\n * @param {string} selector\n * @return {!NodeList<!Element>}\n */\nfunction scopedQuerySelectionFallback(root, selector) {\n  const unique = 'i-amphtml-scoped';\n  root.classList.add(unique);\n  const scopedSelector = prependSelectorsWith(selector, `.${unique}`);\n  const elements = root./*OK*/ querySelectorAll(scopedSelector);\n  root.classList.remove(unique);\n  return elements;\n}\n\n/**\n * Finds the first element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element|!ShadowRoot} root\n * @param {string} selector\n * @return {?Element}\n *\n * @suppress {suspiciousCode}\n */\nexport function scopedQuerySelector(root, selector) {\n  if (mode.isEsm() || isScopeSelectorSupported(root)) {\n    return root./*OK*/ querySelector(prependSelectorsWith(selector, ':scope'));\n  }\n\n  // Only IE.\n  const fallbackResult = scopedQuerySelectionFallback(root, selector);\n  return fallbackResult[0] === undefined ? null : fallbackResult[0];\n}\n\n/**\n * Finds every element that matches `selector`, scoped inside `root`.\n * Note: in IE, this causes a quick mutation of the element's class list.\n * @param {!Element|!ShadowRoot} root\n * @param {string} selector\n * @return {!NodeList<!Element>}\n *\n * @suppress {suspiciousCode}\n */\nexport function scopedQuerySelectorAll(root, selector) {\n  if (mode.isEsm() || isScopeSelectorSupported(root)) {\n    return root./*OK*/ querySelectorAll(\n      prependSelectorsWith(selector, ':scope')\n    );\n  }\n\n  // Only IE.\n  return scopedQuerySelectionFallback(root, selector);\n}\n\n/**\n * Checks if the given element matches the selector\n * @param  {!Element} el The element to verify\n * @param  {string} selector The selector to check against\n * @return {boolean} True if the element matched the selector. False otherwise.\n */\nexport function matches(el, selector) {\n  const matcher =\n    el.matches ||\n    el.webkitMatchesSelector ||\n    el.mozMatchesSelector ||\n    el.msMatchesSelector ||\n    el.oMatchesSelector;\n  if (matcher) {\n    return matcher.call(el, selector);\n  }\n  return false; // IE8 always returns false.\n}\n\n/**\n * Finds the closest element that satisfies the callback from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {function(!Element):boolean} callback\n * @param {Element=} opt_stopAt optional elemnt to stop the search at.\n * @return {?Element}\n */\nexport function closest(element, callback, opt_stopAt) {\n  for (let el = element; el && el !== opt_stopAt; el = el.parentElement) {\n    if (callback(el)) {\n      return el;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds the closest node that satisfies the callback from this node\n * up the DOM subtree.\n * @param {!Node} node\n * @param {function(!Node):boolean} callback\n * @return {?Node}\n */\nexport function closestNode(node, callback) {\n  for (let n = node; n; n = n.parentNode) {\n    if (callback(n)) {\n      return n;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds the closest ancestor element with the specified selector from this\n * element.\n * @param {!Element} element\n * @param {string} selector\n * @return {?Element} closest ancestor if found.\n */\nexport function closestAncestorElementBySelector(element, selector) {\n  return element.closest\n    ? element.closest(selector)\n    : closest(element, (el) => matches(el, selector));\n}\n\n/**\n * Finds all ancestor elements that satisfy predicate.\n * @param {!Element} child\n * @param {function(!Element):boolean} predicate\n * @return {!Array<!Element>}\n */\nexport function ancestorElements(child, predicate) {\n  const ancestors = [];\n  for (\n    let ancestor = child.parentElement;\n    ancestor;\n    ancestor = ancestor.parentElement\n  ) {\n    if (predicate(ancestor)) {\n      ancestors.push(ancestor);\n    }\n  }\n  return ancestors;\n}\n\n/**\n * Finds all ancestor elements that has the specified tag name.\n * @param {!Element} child\n * @param {string} tagName\n * @return {!Array<!Element>}\n */\nexport function ancestorElementsByTag(child, tagName) {\n  assertIsName(tagName);\n  tagName = tagName.toUpperCase();\n  return ancestorElements(child, (el) => el.tagName == tagName);\n}\n\n/**\n * Finds the first child element that satisfies the callback.\n * TODO(rcebulko): Can we start using generators in childElements and defer to\n * that here?\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function childElement(parent, callback) {\n  for (\n    let child = parent.firstElementChild;\n    child;\n    child = child.nextElementSibling\n  ) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds the last child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function lastChildElement(parent, callback) {\n  for (\n    let child = parent.lastElementChild;\n    child;\n    child = child.previousElementSibling\n  ) {\n    if (callback(child)) {\n      return child;\n    }\n  }\n  return null;\n}\n\n/**\n * Finds all child elements that satisfy the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {!Array<!Element>}\n */\nexport function childElements(parent, callback) {\n  const children = [];\n  for (\n    let child = parent.firstElementChild;\n    child;\n    child = child.nextElementSibling\n  ) {\n    if (callback(child)) {\n      children.push(child);\n    }\n  }\n  return children;\n}\n\n/**\n * Finds all child nodes that satisfy the callback.\n * These nodes can include Text, Comment and other child nodes.\n * @param {!Node} parent\n * @param {function(!Node):boolean} callback\n * @return {!Array<!Node>}\n */\nexport function childNodes(parent, callback) {\n  const nodes = [];\n  for (let child = parent.firstChild; child; child = child.nextSibling) {\n    if (callback(child)) {\n      nodes.push(child);\n    }\n  }\n  return nodes;\n}\n\n/**\n * Finds the first child element that has the specified attribute.\n * @param {!Element|!ShadowRoot} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function childElementByAttr(parent, attr) {\n  assertIsName(attr);\n  return /*OK*/ scopedQuerySelector(parent, `> [${attr}]`);\n}\n\n/**\n * Finds the last child element that has the specified attribute.\n * @param {!Element} parent\n * @param {string} attr\n * @return {?Element}\n */\nexport function lastChildElementByAttr(parent, attr) {\n  assertIsName(attr);\n  return lastChildElement(parent, (el) => {\n    return el.hasAttribute(attr);\n  });\n}\n\n/**\n * Finds all child elements that has the specified attribute.\n * @param {!Element|!ShadowRoot} parent\n * @param {string} attr\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByAttr(parent, attr) {\n  assertIsName(attr);\n  return /*OK*/ scopedQuerySelectorAll(parent, `> [${attr}]`);\n}\n\n/**\n * Finds the first child element that has the specified tag name.\n * @param {!Element|!ShadowRoot} parent\n * @param {string} tagName\n * @return {?Element}\n */\nexport function childElementByTag(parent, tagName) {\n  assertIsName(tagName);\n  return /*OK*/ scopedQuerySelector(parent, `> ${tagName}`);\n}\n\n/**\n * Finds all child elements with the specified tag name.\n * @param {!Element|!ShadowRoot} parent\n * @param {string} tagName\n * @return {!NodeList<!Element>}\n */\nexport function childElementsByTag(parent, tagName) {\n  assertIsName(tagName);\n  return /*OK*/ scopedQuerySelectorAll(parent, `> ${tagName}`);\n}\n\n/**\n * Finds the first descendant element with the specified name.\n * @param {!Element|!Document|!ShadowRoot} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function elementByTag(element, tagName) {\n  assertIsName(tagName);\n  return element./*OK*/ querySelector(tagName);\n}\n\n/**\n * Returns the original nodes of the custom element without any service\n * nodes that could have been added for markup. These nodes can include\n * Text, Comment and other child nodes.\n *\n * @param {!Node} element\n * @return {!Array<!Node>}\n */\nexport function realChildNodes(element) {\n  return childNodes(element, (node) => !isInternalOrServiceNode(node));\n}\n\n/**\n * Returns the original children of the custom element without any service\n * nodes that could have been added for markup.\n *\n * @param {!Element} element\n * @return {!Array<!Element>}\n */\nexport function realChildElements(element) {\n  return childElements(element, (element) => !isInternalOrServiceNode(element));\n}\n\n/**\n * Returns \"true\" for internal AMP nodes or for placeholder elements.\n * @param {!Node} node\n * @return {boolean}\n */\nexport function isInternalOrServiceNode(node) {\n  if (isInternalElement(node)) {\n    return true;\n  }\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return false;\n  }\n  devAssertElement(node);\n\n  return (\n    node.hasAttribute('placeholder') ||\n    node.hasAttribute('fallback') ||\n    node.hasAttribute('overflow')\n  );\n}\n\n/**\n * Whether the tag is an internal (service) AMP tag.\n * @param {!Node|string} nodeOrTagName\n * @return {boolean}\n */\nfunction isInternalElement(nodeOrTagName) {\n  /** @type string */\n  let tagName;\n  if (typeof nodeOrTagName == 'string') {\n    tagName = nodeOrTagName;\n  } else if (nodeOrTagName.nodeType === Node.ELEMENT_NODE) {\n    tagName = devAssertElement(nodeOrTagName).tagName;\n  }\n\n  return !!tagName && tagName.toLowerCase().startsWith('i-');\n}\n", "import * as mode from '#core/mode';\nimport {dict} from '#core/types/object';\nimport {parseJson} from '#core/types/object/json';\nimport {getWin} from '#core/window';\n\nimport {childElementsByTag, matches} from './query';\n\nconst HTML_ESCAPE_CHARS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n};\nconst HTML_ESCAPE_REGEX = /(&|<|>|\"|'|`)/g;\n\n/**\n * @typedef {{\n *   bubbles: (boolean|undefined),\n *   cancelable: (boolean|undefined),\n * }}\n */\nexport let CustomEventOptionsDef;\n\n/** @const {!CustomEventOptionsDef} */\nconst DEFAULT_CUSTOM_EVENT_OPTIONS = {bubbles: true, cancelable: true};\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * callback is executed.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @param {function()} callback\n */\nexport function waitForChild(parent, checkFunc, callback) {\n  if (checkFunc(parent)) {\n    callback();\n    return;\n  }\n  const win = getWin(parent);\n  if (mode.isEsm() || win.MutationObserver) {\n    const observer = new win.MutationObserver(() => {\n      if (checkFunc(parent)) {\n        observer.disconnect();\n        callback();\n      }\n    });\n    observer.observe(parent, {childList: true});\n  } else {\n    const interval = win.setInterval(() => {\n      if (checkFunc(parent)) {\n        win.clearInterval(interval);\n        callback();\n      }\n    }, /* milliseconds */ 5);\n  }\n}\n\n/**\n * Waits until the child element is constructed. Once the child is found, the\n * promise is resolved.\n * @param {!Element} parent\n * @param {function(!Element):boolean} checkFunc\n * @return {!Promise}\n */\nexport function waitForChildPromise(parent, checkFunc) {\n  return new Promise((resolve) => {\n    waitForChild(parent, checkFunc, resolve);\n  });\n}\n\n/**\n * Waits for document's body to be available and ready.\n * @param {!Document} doc\n * @param {function()} callback\n */\nexport function waitForBodyOpen(doc, callback) {\n  waitForChild(doc.documentElement, () => !!doc.body, callback);\n}\n\n/**\n * Waits for document's body to be available.\n * @param {!Document} doc\n * @return {!Promise}\n */\nexport function waitForBodyOpenPromise(doc) {\n  return new Promise((resolve) => waitForBodyOpen(doc, resolve));\n}\n\n/**\n * Removes the element.\n * @param {!Element} element\n */\nexport function removeElement(element) {\n  element.parentElement?.removeChild(element);\n}\n\n/**\n * Removes all child nodes of the specified element.\n * @param {!Element|!DocumentFragment} parent\n */\nexport function removeChildren(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n}\n\n/**\n * Copies all children nodes of element \"from\" to element \"to\". Child nodes\n * are deeply cloned. Notice, that this method should be used with care and\n * preferably on smaller subtrees.\n * @param {!Element} from\n * @param {!Element|!DocumentFragment} to\n */\nexport function copyChildren(from, to) {\n  const frag = to.ownerDocument.createDocumentFragment();\n  for (let n = from.firstChild; n; n = n.nextSibling) {\n    frag.appendChild(n.cloneNode(true));\n  }\n  to.appendChild(frag);\n}\n\n/**\n * Insert the element in the root after the element named after or\n * if that is null at the beginning.\n * @param {!Element|!ShadowRoot} root\n * @param {!Element} element\n * @param {?Node=} after\n */\nexport function insertAfterOrAtStart(root, element, after = null) {\n  if (!after) {\n    insertAtStart(root, element);\n    return;\n  }\n  const before = after.nextSibling;\n  root.insertBefore(element, before);\n}\n\n/**\n * Insert the element in the root after the element named after or\n * if that is null at the beginning.\n * @param {!Element|!ShadowRoot} root\n * @param {!Element} element\n */\nexport function insertAtStart(root, element) {\n  root.insertBefore(element, root.firstChild);\n}\n\n/**\n * Add attributes to an element.\n * @param {!Element} element\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function addAttributesToElement(element, attributes) {\n  for (const attr in attributes) {\n    element.setAttribute(attr, attributes[attr]);\n  }\n  return element;\n}\n\n/**\n * Create a new element on document with specified tagName and attributes.\n * @param {!Document} doc\n * @param {string} tagName\n * @param {!JsonObject<string, string>} attributes\n * @return {!Element} created element\n */\nexport function createElementWithAttributes(doc, tagName, attributes) {\n  const element = doc.createElement(tagName);\n  return addAttributesToElement(element, attributes);\n}\n\n/**\n * Returns true if node is connected (attached).\n * @param {!Node} node\n * @return {boolean}\n * @see https://dom.spec.whatwg.org/#connected\n */\nexport function isConnectedNode(node) {\n  const connected = node.isConnected;\n  if (connected !== undefined) {\n    return connected;\n  }\n\n  // \"An element is connected if its shadow-including root is a document.\"\n  let n = node;\n  do {\n    n = rootNodeFor(n);\n    if (n.host) {\n      n = n.host;\n    } else {\n      break;\n    }\n  } while (true);\n  return n.nodeType === Node.DOCUMENT_NODE;\n}\n\n/**\n * Returns the root for a given node. Does not cross shadow DOM boundary.\n * @param {!Node} node\n * @return {!Node}\n */\nexport function rootNodeFor(node) {\n  if (Node.prototype.getRootNode) {\n    // Type checker says `getRootNode` may return null.\n    return node.getRootNode() || node;\n  }\n  let n;\n  // Check isShadowRoot() is only needed for the polyfill case.\n  for (\n    n = node;\n    !!n.parentNode && !isShadowRoot(/** @type {HTMLElement} */ (n));\n    n = n.parentNode\n  ) {}\n  return n;\n}\n\n/**\n * Determines if value is actually a `ShadowRoot` node.\n * @param {?HTMLElement} value\n * @return {boolean}\n */\nexport function isShadowRoot(value) {\n  if (!value) {\n    return false;\n  }\n  // Node.nodeType == DOCUMENT_FRAGMENT to speed up the tests. Unfortunately,\n  // nodeType of DOCUMENT_FRAGMENT is used currently for ShadowRoot nodes.\n  if (value.tagName == 'I-AMPHTML-SHADOW-ROOT') {\n    return true;\n  }\n  return (\n    value.nodeType == /* DOCUMENT_FRAGMENT */ 11 &&\n    Object.prototype.toString.call(value) === '[object ShadowRoot]'\n  );\n}\n\n/**\n * Returns element data-param- attributes as url parameters key-value pairs.\n * e.g. data-param-some-attr=value -> {someAttr: value}.\n * @param {!HTMLElement} element\n * @param {function(string):string=} opt_computeParamNameFunc to compute the\n *    parameter name, get passed the camel-case parameter name.\n * @param {!RegExp=} opt_paramPattern Regex pattern to match data attributes.\n * @return {!JsonObject}\n */\nexport function getDataParamsFromAttributes(\n  element,\n  opt_computeParamNameFunc,\n  opt_paramPattern\n) {\n  const computeParamNameFunc = opt_computeParamNameFunc || ((key) => key);\n  const {dataset} = element;\n  const params = dict();\n  const paramPattern = opt_paramPattern || /^param(.+)/;\n  for (const key in dataset) {\n    const matches = key.match(paramPattern);\n    if (matches) {\n      const param = matches[1][0].toLowerCase() + matches[1].substr(1);\n      params[computeParamNameFunc(param)] = dataset[key];\n    }\n  }\n  return params;\n}\n\n/**\n * Whether the element have a next node in the document order.\n * This means either:\n *  a. The element itself has a nextSibling.\n *  b. Any of the element ancestors has a nextSibling.\n * @param {!Element} element\n * @param {?Node} opt_stopNode\n * @return {boolean}\n */\nexport function hasNextNodeInDocumentOrder(element, opt_stopNode) {\n  let currentElement = element;\n  do {\n    if (currentElement.nextSibling) {\n      return true;\n    }\n  } while (\n    (currentElement = currentElement.parentNode) &&\n    currentElement != opt_stopNode\n  );\n  return false;\n}\n\n/**\n * Returns a clone of the content of a template element.\n *\n * Polyfill to replace .content access for browsers that do not support\n * HTMLTemplateElements natively.\n *\n * @param {!HTMLTemplateElement|!Element} template\n * @return {!DocumentFragment}\n */\nexport function templateContentClone(template) {\n  if ('content' in template) {\n    return template.content.cloneNode(true);\n  } else {\n    const content = template.ownerDocument.createDocumentFragment();\n    copyChildren(template, content);\n    return content;\n  }\n}\n\n/**\n * Iterate over an array-like.\n * Test cases: https://jsbench.github.io/#f638cacc866a1b2d6e517e6cfa900d6b\n * @param {!IArrayLike<T>} iterable\n * @param {function(T, number)} cb\n * @template T\n */\nexport function iterateCursor(iterable, cb) {\n  const {length} = iterable;\n  for (let i = 0; i < length; i++) {\n    cb(iterable[i], i);\n  }\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonScriptTag(element) {\n  return (\n    element.tagName == 'SCRIPT' &&\n    element.getAttribute('type')?.toUpperCase() == 'APPLICATION/JSON'\n  );\n}\n\n/**\n * Whether the element is a script tag with application/json type.\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isJsonLdScriptTag(element) {\n  return (\n    element.tagName == 'SCRIPT' &&\n    element.getAttribute('type')?.toUpperCase() == 'APPLICATION/LD+JSON'\n  );\n}\n\n/**\n * Whether the page's direction is right to left or not.\n * @param {!Document} doc\n * @return {boolean}\n */\nexport function isRTL(doc) {\n  const dir =\n    doc.body.getAttribute('dir') ||\n    doc.documentElement.getAttribute('dir') ||\n    'ltr';\n  return dir == 'rtl';\n}\n\n/**\n * Escapes `<`, `>` and other HTML charcaters with their escaped forms.\n * @param {string} text\n * @return {string}\n */\nexport function escapeHtml(text) {\n  if (!text) {\n    return text;\n  }\n  return text.replace(HTML_ESCAPE_REGEX, escapeHtmlChar);\n}\n\n/**\n * @param {string} c\n * @return {string}\n */\nfunction escapeHtmlChar(c) {\n  return HTML_ESCAPE_CHARS[c];\n}\n\n/**\n * Tries to focus on the given element; fails silently if browser throws an\n * exception.\n * @param {!Element} element\n */\nexport function tryFocus(element) {\n  try {\n    element./*OK*/ focus();\n  } catch (e) {\n    // IE <= 7 may throw exceptions when focusing on hidden items.\n  }\n}\n\n/**\n * Whether the given window is in an iframe or not.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isIframed(win) {\n  return win.parent && win.parent != win;\n}\n\n/**\n * Returns true if node is not disabled.\n *\n * IE8 can return false positives, see {@link matches}.\n * @param {!HTMLInputElement} element\n * @return {boolean}\n * @see https://www.w3.org/TR/html5/forms.html#concept-fe-disabled\n */\nexport function isEnabled(element) {\n  return !(element.disabled || matches(element, ':disabled'));\n}\n\n/**\n * A sorting comparator that sorts elements in DOM tree order.\n * A first sibling is sorted to be before its nextSibling.\n * A parent node is sorted to be before a child.\n * See https://developer.mozilla.org/en-US/docs/Web/API/Node/compareDocumentPosition\n *\n * @param {!Element} element1\n * @param {!Element} element2\n * @return {number}\n */\nexport function domOrderComparator(element1, element2) {\n  if (element1 === element2) {\n    return 0;\n  }\n\n  const pos = element1.compareDocumentPosition(element2);\n  const precedingOrContains =\n    Node.DOCUMENT_POSITION_PRECEDING | Node.DOCUMENT_POSITION_CONTAINS;\n\n  // if fe2 is preceding or contains fe1 then, fe1 is after fe2\n  if (pos & precedingOrContains) {\n    return 1;\n  }\n\n  // if fe2 is following or contained by fe1, then fe1 is before fe2\n  return -1;\n}\n\n/**\n * Like `Element.prototype.toggleAttribute`. This either toggles an attribute\n * on by adding an attribute with an empty value, or toggles it off by removing\n * the attribute. This does not mutate the element if the new state matches\n * the existing state.\n * @param {!Element} element An element to toggle the attribute for.\n * @param {string} name The name of the attribute.\n * @param {boolean=} forced Whether the attribute should be forced on/off. If\n *    not specified, it will be toggled from the current state.\n * @return {boolean} Whether or not the element now has the attribute.\n */\nexport function toggleAttribute(element, name, forced) {\n  const hasAttribute = element.hasAttribute(name);\n  const enabled = forced !== undefined ? forced : !hasAttribute;\n\n  if (enabled !== hasAttribute) {\n    if (enabled) {\n      element.setAttribute(name, '');\n    } else {\n      element.removeAttribute(name);\n    }\n  }\n\n  return enabled;\n}\n\n/**\n * Parses a string as a boolean value using the expanded rules for DOM boolean\n * attributes:\n * - a `null` or `undefined` returns `null`;\n * - an empty string returns `true`;\n * - a \"false\" string returns `false`;\n * - otherwise, `true` is returned.\n *\n * @param {?string|undefined} s\n * @return {boolean|undefined}\n */\nexport function parseBooleanAttribute(s) {\n  return s == null ? undefined : s !== 'false';\n}\n\n/**\n * @param {!Window} win\n * @return {number} The width of the vertical scrollbar, in pixels.\n */\nexport function getVerticalScrollbarWidth(win) {\n  const {documentElement} = win.document;\n  const windowWidth = win./*OK*/ innerWidth;\n  const documentWidth = documentElement./*OK*/ clientWidth;\n  return windowWidth - documentWidth;\n}\n\n/**\n * Dispatches a custom event.\n *\n * @param {!Node} node\n * @param {string} name\n * @param {!Object=} opt_data Event data.\n * @param {!CustomEventOptionsDef=} opt_options\n */\nexport function dispatchCustomEvent(node, name, opt_data, opt_options) {\n  const data = opt_data || {};\n  // Constructors of events need to come from the correct window. Sigh.\n  const event = node.ownerDocument.createEvent('Event');\n\n  // Technically .data is not a property of Event.\n  event.data = data;\n\n  const {bubbles, cancelable} = opt_options || DEFAULT_CUSTOM_EVENT_OPTIONS;\n  event.initEvent(name, bubbles, cancelable);\n  node.dispatchEvent(event);\n}\n\n/**\n * Ensures the child is contained by the parent, but not the parent itself.\n *\n * @param {!Node} parent\n * @param {!Node} child\n * @return {boolean}\n */\nexport function containsNotSelf(parent, child) {\n  return child !== parent && parent.contains(child);\n}\n\n/**\n * Helper method to get the json config from an element <script> tag\n * @param {!Element} element\n * @return {?JsonObject}\n * @throws {!Error} If element does not have exactly one <script> child\n * with type=\"application/json\", or if the <script> contents are not valid JSON.\n */\nexport function getChildJsonConfig(element) {\n  const scripts = childElementsByTag(element, 'script');\n  const {length} = scripts;\n  if (length !== 1) {\n    throw new Error(`Found ${length} <script> children. Expected 1.`);\n  }\n\n  const script = scripts[0];\n  if (!isJsonScriptTag(script)) {\n    throw new Error('<script> child must have type=\"application/json\"');\n  }\n\n  try {\n    return parseJson(script.textContent);\n  } catch {\n    throw new Error('Failed to parse <script> contents. Is it valid JSON?');\n  }\n}\n", "/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error}\n */\nexport function duplicateErrorIfNecessary(error) {\n  const messageProperty = Object.getOwnPropertyDescriptor(error, 'message');\n  if (messageProperty?.writable) {\n    return error;\n  }\n\n  const {message, stack} = error;\n  const e = new Error(message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = stack;\n  return e;\n}\n\n/**\n * Creates an error object.\n * @param {...*} var_args\n * @return {!Error}\n */\nexport function createError(var_args) {\n  let error = null;\n  let message = '';\n  for (const arg of arguments) {\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n/**\n * Reports an error, if the global error reporting function is defined.\n * @param {!Error} error\n */\nfunction maybeReportError(error) {\n  self.__AMP_REPORT_ERROR?.(error);\n}\n\n/**\n * Constructs and throws an error without terminating the current context. This\n * preserves whether the original error designation is a user error or a dev\n * error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createError.apply(null, arguments);\n  setTimeout(() => {\n    // __AMP_REPORT_ERROR is installed globally per window in the entry point.\n    // It may not exist for Bento components without the runtime.\n    maybeReportError(error);\n    throw error;\n  });\n}\n\n/**\n * Executes the provided callback in a try/catch and rethrows any errors\n * asynchronously.\n *\n * @param {function(S):T} callback\n * @param {S} args\n * @return {T}\n * @template T\n * @template S\n */\nexport function tryCallback(callback, ...args) {\n  try {\n    return callback.apply(null, args);\n  } catch (e) {\n    rethrowAsync(e);\n  }\n}\n\n/**\n * Creates an error object with its expected property set to true.\n * @param {...*} var_args\n * @return {!Error}\n */\nexport function createExpectedError(var_args) {\n  const error = createError.apply(null, arguments);\n  error.expected = true;\n  return error;\n}\n\n/**\n * Reports an error message.\n * @param {string} tag\n * @param {...*} args\n */\nexport function devError(tag, ...args) {\n  const error = createError.apply(null, args);\n  // TODO(rcebulko): Determine if/how this Error#name property is used.\n  error.name = tag || error.name;\n  maybeReportError(error);\n}\n\n/**\n * Reports an error message and marks with an expected property. If the\n * logging is disabled, the error is rethrown asynchronously.\n * @param {string} unusedTag\n * @param {...*} args\n */\nexport function devExpectedError(unusedTag, ...args) {\n  maybeReportError(createExpectedError.apply(null, args));\n}\n", "// Note: loaded by 3p system. Cannot rely on babel polyfills.\nimport {devAssert} from '#core/assert';\nimport {devError} from '#core/error';\nimport {map} from '#core/types/object';\n\n/** @type {Object<string, string>} */\nlet propertyNameCache;\n\n/** @const {!Array<string>} */\nconst vendorPrefixes = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\nconst DISPLAY_STYLE_MESSAGE =\n  '`display` style detected. You must use toggle instead.';\n\nconst EMPTY_CSS_DECLARATION = /** @type {!CSSStyleDeclaration} */ ({\n  'getPropertyPriority': () => '',\n  'getPropertyValue': () => '',\n});\n\n/**\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n  Checks the style if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} style\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(style, titleCase) {\n  for (let i = 0; i < vendorPrefixes.length; i++) {\n    const propertyName = vendorPrefixes[i] + titleCase;\n    if (style[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @param {!Object} style\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(style, camelCase, opt_bypassCache) {\n  if (isVar(camelCase)) {\n    // CSS vars are returned as is.\n    return camelCase;\n  }\n  if (!propertyNameCache) {\n    propertyNameCache = map();\n  }\n  let propertyName = propertyNameCache[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (style[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(style, titleCase);\n\n      if (style[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n/**\n * Sets the CSS styles of the specified element with !important. The styles\n * are specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setImportantStyles(element, styles) {\n  const {style} = element;\n  for (const k in styles) {\n    style.setProperty(\n      getVendorJsPropertyName(style, k),\n      String(styles[k]),\n      'important'\n    );\n  }\n}\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {?Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(\n    element.style,\n    property,\n    opt_bypassCache\n  );\n  if (!propertyName) {\n    return;\n  }\n  const styleValue = /** @type {string} */ (\n    opt_units ? value + opt_units : value\n  );\n  if (isVar(propertyName)) {\n    element.style.setProperty(propertyName, styleValue);\n  } else {\n    element.style[propertyName] = styleValue;\n  }\n}\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(\n    element.style,\n    property,\n    opt_bypassCache\n  );\n  if (!propertyName) {\n    return undefined;\n  }\n  if (isVar(propertyName)) {\n    return element.style.getPropertyValue(propertyName);\n  }\n  return element.style[propertyName];\n}\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n/**\n * Sets the initial display style of an element. This is a last resort. If you\n * can set the initial display using CSS, YOU MUST.\n * DO NOT USE THIS TO ARBITRARILY SET THE DISPLAY STYLE AFTER INITIAL SETUP.\n *\n * @param {!Element} el\n * @param {string} value\n */\nexport function setInitialDisplay(el, value) {\n  const {style} = el;\n  devAssert(\n    value !== '' && value !== 'none',\n    'Initial display value must not be \"none\". Use toggle instead.'\n  );\n  devAssert(\n    !style['display'],\n    'setInitialDisplay MUST NOT be used for ' +\n      'resetting the display style. If you are looking for display:none ' +\n      'toggling, use toggle instead.'\n  );\n  style['display'] = value;\n}\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = element.hasAttribute('hidden');\n  }\n  if (opt_display) {\n    element.removeAttribute('hidden');\n  } else {\n    element.setAttribute('hidden', '');\n  }\n}\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return `${value}px`;\n}\n\n/**\n * Returns a degree value.\n * @param {number} value\n * @return {string}\n */\nexport function deg(value) {\n  return `${value}deg`;\n}\n\n/**\n * Coerces a number into a string with units.\n * @param {number|string} value\n * @param {function(number):string} fn\n * @return {string}\n */\nfunction units(value, fn) {\n  return typeof value == 'number' ? fn(value) : value;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  return `translateX(${units(value, px)})`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string|null)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  return opt_y === undefined || opt_y === null\n    ? `translate(${units(x, px)})`\n    : `translate(${units(x, px)}, ${units(opt_y, px)})`;\n}\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n\n/**\n * Returns a \"rotate\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function rotate(value) {\n  return `rotate(${units(value, deg)})`;\n}\n\n/**\n * Remove alpha value from a rgba color value.\n * Return the new color property with alpha equals if has the alpha value.\n * Caller needs to make sure the input color value is a valid rgba/rgb value\n * @param {string} rgbaColor\n * @return {string}\n */\nexport function removeAlphaFromColor(rgbaColor) {\n  return rgbaColor.replace(\n    /\\(([^,]+),([^,]+),([^,)]+),[^)]+\\)/g,\n    '($1,$2,$3, 1)'\n  );\n}\n\n/**\n * Gets the computed style of the element. The helper is necessary to enforce\n * the possible `null` value returned by a buggy Firefox.\n *\n * @param {!Window} win\n * @param {!Element} el\n * @return {!CSSStyleDeclaration}\n */\nexport function computedStyle(win, el) {\n  const style = /** @type {?CSSStyleDeclaration} */ (win.getComputedStyle(el));\n  return style || EMPTY_CSS_DECLARATION;\n}\n\n/**\n * Resets styles that were set dynamically (i.e. inline)\n * @param {!Element} element\n * @param {!Array<string>} properties\n */\nexport function resetStyles(element, properties) {\n  for (let i = 0; i < properties.length; i++) {\n    setStyle(element, properties[i], null);\n  }\n}\n\n/**\n * Propagates the object-fit/position element attributes as styles.\n * @param {!Element} fromEl ie: amp-img\n * @param {!Element} toEl ie: the img within amp-img\n */\nexport function propagateObjectFitStyles(fromEl, toEl) {\n  if (fromEl.hasAttribute('object-fit')) {\n    setStyle(toEl, 'object-fit', fromEl.getAttribute('object-fit'));\n  }\n\n  if (fromEl.hasAttribute('object-position')) {\n    setStyle(toEl, 'object-position', fromEl.getAttribute('object-position'));\n  }\n}\n\n/**\n * @param {string} property\n * @return {boolean}\n */\nfunction isVar(property) {\n  return property.startsWith('--');\n}\n\n/**\n * Asserts that the style is not the `display` style.\n * This is the only possible way to pass a dynamic style to setStyle.\n *\n * If you wish to set `display`, use the `toggle` helper instead. This is so\n * changes to display can trigger necessary updates. See #17475.\n *\n * @param {string} style\n * @return {string}\n */\nexport function assertNotDisplay(style) {\n  // TODO(rcebulko): This calls itself an assert, but doesn't throw an error.\n  // Should it throw sync? If so, this/below can reduce to\n  // `return devAssert(style == 'display', DISPLAY_STYLE_MESSAGE);`\n  if (style === 'display') {\n    devError('STYLE', DISPLAY_STYLE_MESSAGE);\n  }\n  return style;\n}\n\n/**\n * Asserts that the styles does not contain the `display` style.\n * This is the only possible way to pass a dynamic styles object to setStyles\n * and setImportantStyles.\n *\n * If you wish to set `display`, use the `toggle` helper instead. This is so\n * changes to display can trigger necessary updates. See #17475.\n *\n * @param {!Object<string, *>} styles\n * @return {!Object<string, *>}\n */\nexport function assertDoesNotContainDisplay(styles) {\n  if ('display' in styles) {\n    devError('STYLE', DISPLAY_STYLE_MESSAGE);\n  }\n  return styles;\n}\n", "import {devAssert} from '#core/assert';\n\n/**\n * Maps a value in a first range to its equivalent in a second range\n * Ex.: 5 in the range [0,10] gives 60 in the range[40,80]\n *\n * NOTE: lower/upper bounds on the source range are detected automatically,\n * however the bounds on the target range are not altered (thus the target\n * range could be decreasing).\n * Ex1: 8 in the range [0, 10] gives 2 in the range [10, 0]\n * Ex2: also, 8 in the range [10, 0] gives 2 in the range [10, 0]\n *\n * NOTE: Input value is enforced to be bounded inside the source range\n * Ex1: -2 in the range [0, 10] is interpreted as 0 and thus gives 40 in [40,80]\n * Ex2: 19 in the range [0, 5] is interpreted as 5 and thus gives 80 in [40,80]\n *\n * @param {number} val the value in the source range\n * @param {number} min1 the lower bound of the source range\n * @param {number} max1 the upper bound of the source range\n * @param {number} min2 the lower bound of the target range\n * @param {number} max2 the upper bound of the target range\n * @return {number} the equivalent value in the target range\n */\nexport function mapRange(val, min1, max1, min2, max2) {\n  let max1Bound = max1;\n  let min1Bound = min1;\n  if (min1 > max1) {\n    max1Bound = min1;\n    min1Bound = max1;\n  }\n\n  if (val < min1Bound) {\n    val = min1Bound;\n  } else if (val > max1Bound) {\n    val = max1Bound;\n  }\n\n  return ((val - min1) * (max2 - min2)) / (max1 - min1) + min2;\n}\n\n/**\n * Computes the modulus of values `a` and `b`.\n *\n * This is needed because the % operator in JavaScript doesn't implement\n * modulus behavior as can be seen by the spec here:\n * http://www.ecma-international.org/ecma-262/5.1/#sec-11.5.3.\n * It instead is used to obtain the remainder of a division.\n * This function uses the remainder (%) operator to determine the modulus.\n * Derived from here:\n * https://stackoverflow.com/questions/25726760/javascript-modular-arithmetic/47354356#47354356\n *\n * @param {number} a\n * @param {number} b\n * @return {number} returns the modulus of the two numbers.\n * @example\n *\n * _.min(10, 5);\n * // => 0\n *\n * _.mod(-1, 5);\n * // => 4\n */\nexport function mod(a, b) {\n  return a > 0 && b > 0 ? a % b : ((a % b) + b) % b;\n}\n\n/**\n * Restricts a number to be in the given min/max range. The minimum value must\n * be less than or equal to the maximum value.\n *\n * Examples:\n * clamp(0.5, 0, 1) -> 0.5\n * clamp(1.5, 0, 1) -> 1\n * clamp(-0.5, 0, 1) -> 0\n *\n * @param {number} val the value to clamp.\n * @param {number} min the lower bound.\n * @param {number} max the upper bound.\n * @return {number} the clamped value.\n */\nexport function clamp(val, min, max) {\n  devAssert(min <= max, 'Minimum value is greater than the maximum.');\n  return Math.min(Math.max(val, min), max);\n}\n\n/**\n * Returns value bound to min and max values +/- extent. The lower bound must\n * be less than or equal to the upper bound.\n * @param {number} val the value to bound.\n * @param {number} min the lower bound.\n * @param {number} max the upper bound\n * @param {number} extent the allowed extent beyond the bounds.\n * @return {number} the bounded value.\n */\nexport function boundValue(val, min, max, extent) {\n  devAssert(min <= max, 'Lower bound is greater than the upper bound.');\n  return clamp(val, min - extent, max + extent);\n}\n\n/**\n * Returns the length of a vector given in X- and Y-coordinates.\n * @param {number} deltaX distance in the X direction.\n * @param {number} deltaY distance in the Y direction.\n * @return {number} the magnitude of the vector.\n */\nexport function magnitude(deltaX, deltaY) {\n  return Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n}\n\n/**\n * Returns the distance between two points.\n * @param {number} x1 X-coordinate of the first point.\n * @param {number} y1 Y-coordinate of the first point.\n * @param {number} x2 X-coordinate of the second point.\n * @param {number} y2 Y-coordinate of the second point.\n * @return {number} the distance between the two points.\n */\nexport function distance(x1, y1, x2, y2) {\n  return magnitude(x2 - x1, y2 - y1);\n}\n\n/**\n * @param {number} centerX\n * @param {number} centerY\n * @param {number} radius\n * @param {number} angleInDegrees\n * @return {{\n *  x: number,\n *  y: number,\n * }}\n */\nexport function polarToCartesian(centerX, centerY, radius, angleInDegrees) {\n  const angleInRadians = ((angleInDegrees - 90) * Math.PI) / 180.0;\n\n  return {\n    x: centerX + radius * Math.cos(angleInRadians),\n    y: centerY + radius * Math.sin(angleInRadians),\n  };\n}\n\n/**\n * Sums up the values of the given array and returns the result\n * @param {Array<number>} values\n * @return {number}\n */\nexport function sum(values) {\n  return values.reduce(function (a, b) {\n    return a + b;\n  });\n}\n", "/**\n * Allows for runtime configuration. Internally, the runtime should\n * use the src/config.js module for various constants. We can use the\n * AMP_CONFIG global to translate user-defined configurations to this\n * module.\n * @type {!Object<string, string>}\n */\nconst env = self.AMP_CONFIG || {};\n\nconst thirdPartyFrameRegex =\n  (typeof env['thirdPartyFrameRegex'] == 'string'\n    ? new RegExp(env['thirdPartyFrameRegex'])\n    : env['thirdPartyFrameRegex']) || /^d-\\d+\\.ampproject\\.net$/;\n\nconst cdnProxyRegex =\n  (typeof env['cdnProxyRegex'] == 'string'\n    ? new RegExp(env['cdnProxyRegex'])\n    : env['cdnProxyRegex']) ||\n  /^https:\\/\\/([a-zA-Z0-9_-]+\\.)?cdn\\.ampproject\\.org$/;\n\n/**\n * Check for a custom URL definition in special <meta> tags. Note that this does\n * not allow for distinct custom URLs in AmpDocShadow instances. The shell is\n * allowed to define one set of custom URLs via AMP_CONFIG (recommended) or by\n * including <meta> tags in the shell <head>. Those custom URLs then apply to\n * all AMP documents loaded in the shell.\n * @param {string} name\n * @return {?string}\n * @private\n */\nfunction getMetaUrl(name) {\n  // Avoid exceptions in unit tests\n  if (!self.document || !self.document.head) {\n    return null;\n  }\n\n  // Disallow on proxy origins\n  if (self.location && cdnProxyRegex.test(self.location.origin)) {\n    return null;\n  }\n\n  const metaEl = self.document.head./*OK*/ querySelector(\n    `meta[name=\"${name}\"]`\n  );\n  return (metaEl && metaEl.getAttribute('content')) || null;\n}\n\n/**\n * @typedef {{\n *   thirdParty: string,\n *   thirdPartyFrameHost: string,\n *   thirdPartyFrameRegex: !RegExp,\n *   cdn: string,\n *   cdnProxyRegex: !RegExp,\n *   localhostRegex: !RegExp,\n *   errorReporting: string,\n *   betaErrorReporting: string,\n *   localDev: boolean,\n *   trustedViewerHosts: !Array<!RegExp>,\n *   geoApi: ?string,\n * }}\n */\nexport const urls = {\n  thirdParty: env['thirdPartyUrl'] || 'https://3p.ampproject.net',\n  thirdPartyFrameHost: env['thirdPartyFrameHost'] || 'ampproject.net',\n  thirdPartyFrameRegex,\n  cdn:\n    env['cdnUrl'] || getMetaUrl('runtime-host') || 'https://cdn.ampproject.org',\n  /* Note that cdnProxyRegex is only ever checked against origins\n   * (proto://host[:port]) so does not need to consider path\n   */\n  cdnProxyRegex,\n  localhostRegex: /^https?:\\/\\/localhost(:\\d+)?$/,\n  errorReporting:\n    env['errorReportingUrl'] ||\n    'https://us-central1-amp-error-reporting.cloudfunctions.net/r',\n  betaErrorReporting:\n    env['betaErrorReportingUrl'] ||\n    'https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta',\n  localDev: env['localDev'] || false,\n  /**\n   * These domains are trusted with more sensitive viewer operations such as\n   * propagating the referrer. If you believe your domain should be here,\n   * file the issue on GitHub to discuss. The process will be similar\n   * (but somewhat more stringent) to the one described in the [3p/README.md](\n   * https://github.com/ampproject/amphtml/blob/main/3p/README.md)\n   *\n   * {!Array<!RegExp>}\n   */\n  trustedViewerHosts: [\n    /(^|\\.)google\\.(com?|[a-z]{2}|com?\\.[a-z]{2}|cat)$/,\n    /(^|\\.)gmail\\.(com|dev)$/,\n  ],\n  // Optional fallback API if amp-geo is left unpatched\n  geoApi: env['geoApiUrl'] || getMetaUrl('amp-geo-api'),\n};\n\nexport const config = {\n  urls,\n};\n", "import {map} from '#core/types/object';\n\nconst QUERY_STRING_REGEX = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * @param {string} component\n * @param {string=} fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent(component, fallback = '') {\n  try {\n    return decodeURIComponent(component);\n  } catch (e) {\n    return fallback;\n  }\n}\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString(queryString) {\n  const params = map();\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = QUERY_STRING_REGEX.exec(queryString))) {\n    const name = tryDecodeUriComponent(match[1], match[1]);\n    const value = match[2]\n      ? tryDecodeUriComponent(match[2].replace(/\\+/g, ' '), match[2])\n      : '';\n    params[name] = value;\n  }\n  return params;\n}\n\n/**\n * Parses the query # params.\n * @param {!Window=} opt_win\n * @return {!JsonObject}\n */\nexport function getHashParams(opt_win) {\n  const {location} = opt_win || self;\n  // location.originalHash is set by the viewer when it removes the fragment\n  // from the URL.\n  return parseQueryString(location['originalHash'] || location.hash);\n}\n", "import * as coreMode from '#core/mode';\nimport {getHashParams} from '#core/types/string/url';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   esm: boolean,\n *   test: boolean,\n *   rtvVersion: string,\n *   runtime: (null|string|undefined),\n *   a4aId: (null|string|undefined)\n * }}\n */\nexport let ModeDef;\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.__AMP_MODE) {\n    return win.__AMP_MODE;\n  }\n  return (win.__AMP_MODE = getMode_(win));\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  const hashParams = getHashParams(win);\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `amp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: coreMode.isLocalDev(win),\n    development: isModeDevelopment(win, hashParams),\n    esm: coreMode.isEsm(),\n    test: coreMode.isTest(win),\n    rtvVersion: getRtvVersion(win),\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @return {string}\n */\nfunction getRtvVersion(win) {\n  // Ignore memoized copy during testing to allow override.\n  if (!rtvVersion || coreMode.isTest(win)) {\n    // Currently `internalRuntimeVersion` and thus `mode.version` contain only\n    // major version. The full version however must also carry the minor version.\n    // We will default to production default `01` minor version for now.\n    // TODO(erwinmombay): decide whether internalRuntimeVersion should contain\n    // minor version.\n    rtvVersion = win.AMP_CONFIG?.v || `01${coreMode.version()}`;\n  }\n  return rtvVersion;\n}\n\n/**\n * Triggers validation or enable pub level logging. Validation can be\n * bypassed via #validate=0.\n * Note that AMP_DEV_MODE flag is used for testing purposes.\n * @param {!Window} win\n * @param {!JsonObject=} opt_hashParams\n * @return {boolean}\n */\nexport function isModeDevelopment(win, opt_hashParams) {\n  const devModes = ['1', 'actions', 'amp', 'amp4ads', 'amp4email'];\n  const devParam = opt_hashParams || getHashParams(win);\n  return devModes.includes(devParam['development']) || !!win.AMP_DEV_MODE;\n}\n\n/**\n * @param {!Window} win\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win) {\n  return getRtvVersion(win);\n}\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n", "import * as mode from '#core/mode';\n\nimport {urls} from '../config';\nimport {getMode} from '../mode';\n\nconst CUSTOM_TEMPLATES = ['amp-mustache'];\nconst LATEST_VERSION = 'latest';\n\n/**\n * Calculate the base url for any scripts.\n * @param {!Location} location The window's location\n * @param {boolean=} opt_isLocalDev\n * @return {string}\n */\nexport function calculateScriptBaseUrl(location, opt_isLocalDev) {\n  if (opt_isLocalDev) {\n    let prefix = `${location.protocol}//${location.host}`;\n    if (\n      location.protocol == 'about:' ||\n      location.protocol == 'blob:' ||\n      location.protocol == 'data:'\n    ) {\n      prefix = '';\n    }\n    return `${prefix}/dist`;\n  }\n  return urls.cdn;\n}\n\n/**\n * Calculate script url for an extension.\n * @param {!Location} location The window's location\n * @param {string} extensionId\n * @param {string} version\n * @param {boolean=} opt_isLocalDev\n * @return {string}\n */\nexport function calculateExtensionScriptUrl(\n  location,\n  extensionId,\n  version,\n  opt_isLocalDev\n) {\n  const fileExtension = mode.isEsm() ? '.mjs' : '.js';\n  const base = calculateScriptBaseUrl(location, opt_isLocalDev);\n  const rtv = getMode().rtvVersion;\n  const extensionVersion = version ? '-' + version : '';\n  return `${base}/rtv/${rtv}/v0/${extensionId}${extensionVersion}${fileExtension}`;\n}\n\n/**\n * Calculate script url for an entry point.\n * If `opt_rtv` is true, returns the URL matching the current RTV.\n * @param {!Location} location The window's location\n * @param {string} entryPoint\n * @param {boolean=} isLocalDev\n * @param {boolean=} opt_rtv\n * @return {string}\n */\nexport function calculateEntryPointScriptUrl(\n  location,\n  entryPoint,\n  isLocalDev,\n  opt_rtv\n) {\n  const fileExtension = mode.isEsm() ? '.mjs' : '.js';\n  const base = calculateScriptBaseUrl(location, isLocalDev);\n  if (isLocalDev) {\n    return `${base}/${entryPoint}${fileExtension}`;\n  }\n  if (opt_rtv) {\n    return `${base}/rtv/${getMode().rtvVersion}/${entryPoint}${fileExtension}`;\n  }\n  return `${base}/${entryPoint}${fileExtension}`;\n}\n\n/**\n * Parse the extension version from a given script URL.\n * @param {string} scriptUrl\n * @return {?{extensionId: string, extensionVersion: string}}\n */\nexport function parseExtensionUrl(scriptUrl) {\n  if (!scriptUrl) {\n    return null;\n  }\n  // Note that the \"(\\.max)?\" group only applies to local dev.\n  const matches = scriptUrl.match(\n    /^(.*)\\/(.*)-([0-9.]+|latest)(\\.max)?\\.(?:js|mjs)$/i\n  );\n  const extensionId = matches ? matches[2] : undefined;\n  const extensionVersion = matches ? matches[3] : undefined;\n  if (!extensionId || !extensionVersion) {\n    return null;\n  }\n  return {extensionId, extensionVersion};\n}\n\n/**\n * Create the missing amp extension HTML script element.\n * @param {!Window} win\n * @param {string} extensionId\n * @param {string} version\n * @return {!Element} Script object\n */\nexport function createExtensionScript(win, extensionId, version) {\n  const scriptElement = win.document.createElement('script');\n  scriptElement.async = true;\n  if (isIntermediateExtension(extensionId)) {\n    version = '';\n  } else {\n    scriptElement.setAttribute(\n      CUSTOM_TEMPLATES.indexOf(extensionId) >= 0\n        ? 'custom-template'\n        : 'custom-element',\n      extensionId\n    );\n  }\n  scriptElement.setAttribute('data-script', extensionId);\n  scriptElement.setAttribute('i-amphtml-inserted', '');\n  if (mode.isEsm()) {\n    scriptElement.setAttribute('type', 'module');\n  }\n\n  // Propagate nonce to all generated script tags.\n  const currentScript = win.document.head.querySelector('script[nonce]');\n  if (currentScript) {\n    scriptElement.setAttribute('nonce', currentScript.getAttribute('nonce'));\n  }\n\n  // Allow error information to be collected\n  // https://github.com/ampproject/amphtml/issues/7353\n  scriptElement.setAttribute('crossorigin', 'anonymous');\n  let loc = win.location;\n  if (getMode(win).test && win.testLocation) {\n    loc = win.testLocation;\n  }\n  const scriptSrc = calculateExtensionScriptUrl(\n    loc,\n    extensionId,\n    version,\n    getMode(win).localDev\n  );\n  scriptElement.src = scriptSrc;\n  return scriptElement;\n}\n\n/**\n * Returns the extension <script> element and attribute for the given\n * extension ID, if it exists. Otherwise, returns null.\n * @param {!Window} win\n * @param {string} extensionId\n * @param {string} version\n * @param {boolean} latest\n * @param {boolean=} includeInserted If true, includes script elements that\n *   are inserted by the runtime dynamically. Default is true.\n * @return {!Array<!Element>}\n */\nexport function getExtensionScripts(\n  win,\n  extensionId,\n  version,\n  latest,\n  includeInserted = true\n) {\n  // Always ignore <script> elements that have a mismatched RTV.\n  const modifier =\n    ':not([i-amphtml-loaded-new-version])' +\n    (includeInserted ? '' : ':not([i-amphtml-inserted])');\n  // We have to match against \"src\" because a few extensions, such as\n  // \"amp-viewer-integration\", do not have \"custom-element\" attribute.\n  const matches = win.document.head./*OK*/ querySelectorAll(\n    `script[src*=\"/${extensionId}-\"]${modifier}`\n  );\n  const filtered = [];\n  for (let i = 0; i < matches.length; i++) {\n    const match = matches[i];\n    const urlParts = parseExtensionUrl(match.src);\n    if (!urlParts) {\n      continue;\n    }\n    const {\n      extensionId: scriptExtensionId,\n      extensionVersion: scriptExtensionVersion,\n    } = urlParts;\n    if (\n      scriptExtensionId == extensionId &&\n      (isIntermediateExtension(extensionId) ||\n        scriptExtensionVersion == version ||\n        (scriptExtensionVersion == LATEST_VERSION && latest))\n    ) {\n      filtered.push(match);\n    }\n  }\n  return filtered;\n}\n\n/**\n * Get list of all the extension JS files.\n * @param {HTMLHeadElement|Element|ShadowRoot|Document} head\n * @return {!Array<{script: HTMLScriptElement, extensionId: string, extensionVersion: string}>}\n */\nexport function extensionScriptsInNode(head) {\n  // ampdoc.getHeadNode() can return null.\n  if (!head) {\n    return [];\n  }\n  // Note: Some extensions don't have [custom-element] or [custom-template]\n  // e.g. amp-viewer-integration.\n  const list = head.querySelectorAll(\n    'script[custom-element],script[custom-template]'\n  );\n  const scripts = [];\n  for (let i = 0; i < list.length; i++) {\n    const script = list[i];\n    const extensionId =\n      script.getAttribute('custom-element') ||\n      script.getAttribute('custom-template');\n    const urlParts = parseExtensionUrl(script.src);\n    if (extensionId && urlParts) {\n      scripts.push({\n        script,\n        extensionId,\n        extensionVersion: urlParts.extensionVersion,\n      });\n    }\n  }\n  return scripts;\n}\n\n/**\n * Verifies that an extension script is present in head for\n * installation.\n * @param {!Window} win\n * @param {string} id\n * @param {string} version\n * @return {boolean}\n */\nexport function extensionScriptInNode(win, id, version) {\n  return extensionScriptsInNode(win.document.head).some(\n    ({extensionId, extensionVersion}) =>\n      id == extensionId && version == extensionVersion\n  );\n}\n\n/**\n * @param {string} extensionId\n * @return {boolean}\n */\nfunction isIntermediateExtension(extensionId) {\n  return extensionId.startsWith('_');\n}\n", "import * as assertions from '#core/assert/base';\nimport {\n  createError,\n  createExpectedError,\n  duplicateErrorIfNecessary,\n} from '#core/error';\nimport {\n  USER_ERROR_EMBED_SENTINEL,\n  USER_ERROR_SENTINEL,\n  elementStringOrPassThru,\n  isUserErrorMessage,\n  stripUserError,\n} from '#core/error/message-helpers';\nimport * as mode from '#core/mode';\nimport {isArray, isString} from '#core/types';\nimport {once} from '#core/types/function';\nimport {getHashParams} from '#core/types/string/url';\n\nimport {urls} from '../config';\nimport {getMode} from '../mode';\n\nconst noop = () => {};\n\n// These are exported here despite being defined elswhere to avoid updating\n// imports across many files for now.\nexport {USER_ERROR_SENTINEL, isUserErrorMessage};\n\n/**\n * Sets reportError function. Called from error-reporting.js to break cyclic\n * dependency.\n * @param {function(this:Window, Error, (?Element)=): ?|undefined} fn\n */\nexport function setReportError(fn) {\n  self.__AMP_REPORT_ERROR = fn;\n}\n\n/**\n * @enum {number}\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * @type {!LogLevel|undefined}\n * @private\n */\nlet levelOverride_ = undefined;\n\n/**\n * @param {!LogLevel} level\n */\nexport function overrideLogLevel(level) {\n  levelOverride_ = level;\n}\n\n/**\n * Prefixes `internalRuntimeVersion` with the `01` channel signifier (for prod.) for\n * extracted message URLs.\n * (Specific channel is irrelevant: message tables are invariant on internal version.)\n * @return {string}\n */\nconst messageUrlRtv = () => `01${mode.version()}`;\n\n/**\n * Gets a URL to display a message on amp.dev.\n * @param {string} id\n * @param {!Array} interpolatedParts\n * @return {string}\n */\nconst externalMessageUrl = (id, interpolatedParts) =>\n  interpolatedParts.reduce(\n    (prefix, arg) => `${prefix}&s[]=${messageArgToEncodedComponent(arg)}`,\n    `https://log.amp.dev/?v=${messageUrlRtv()}&id=${encodeURIComponent(id)}`\n  );\n\n/**\n * URL to simple log messages table JSON file, which contains an Object<string, string>\n * which maps message id to full message template.\n * @return {string}\n */\nconst externalMessagesSimpleTableUrl = () =>\n  `${urls.cdn}/rtv/${messageUrlRtv()}/log-messages.simple.json`;\n\n/**\n * @param {*} arg\n * @return {string}\n */\nconst messageArgToEncodedComponent = (arg) =>\n  encodeURIComponent(String(elementStringOrPassThru(arg)));\n\n/**\n * @param {!Window=} opt_win\n * @return {number}\n */\nexport const logHashParam = (opt_win) =>\n  parseInt(getHashParams(opt_win)['log'], 10);\n\n/**\n * Logging class. Use of sentinel string instead of a boolean to check user/dev\n * errors because errors could be rethrown by some native code as a new error,\n * and only a message would survive. Also, some browser don\u2019t support a 5th\n * error object argument in window.onerror. List of supporting browser can be\n * found here:\n * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * opt_suffix will be appended to error message to identify the type of the\n   * error message. We can't rely on the error object to pass along the type\n   * because some browsers do not have this param in its window.onerror API.\n   * See:\n   * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n   *\n   * @param {!Window} win\n   * @param {function(number, boolean):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix = '') {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = getMode().test && win.__AMP_TEST_IFRAME ? win.parent : win;\n\n    /** @private @const {function(number, boolean):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.defaultLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix;\n\n    /** @private {?JsonObject} */\n    this.messages_ = null;\n\n    this.fetchExternalMessagesOnce_ = once(() => {\n      win\n        .fetch(externalMessagesSimpleTableUrl())\n        .then((response) => response.json(), noop)\n        .then((opt_messages) => {\n          if (opt_messages) {\n            this.messages_ = /** @type {!JsonObject} */ (opt_messages);\n          }\n        });\n    });\n\n    // This bound assertion function is capable of handling the format used when\n    // error/assertion messages are extracted. This logic hasn't yet been\n    // migrated to an AMP-independent form for use in core. This binding allows\n    // Log assertion helpers to maintain message-extraction capabilities until\n    // that logic can be moved to core.\n    this.boundAssertFn_ = /** @type {!assertions.AssertionFunctionDef} */ (\n      this.assert.bind(this)\n    );\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevel_() {\n    const {win} = this;\n    // No console - can't enable logging.\n    if (\n      !win.console?.log ||\n      // Logging has been explicitly disabled.\n      logHashParam(win) == 0\n    ) {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev) {\n      return LogLevel.INFO;\n    }\n\n    return this.defaultLevelWithFunc_();\n  }\n\n  /**\n   * @param {!Window=} opt_win provided for testing\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevelWithFunc_(opt_win) {\n    // Delegate to the specific resolver.\n    return this.levelFunc_(logHashParam(opt_win), getMode().development);\n  }\n\n  /**\n   * @param {string} tag\n   * @param {!LogLevel} level\n   * @param {!Array} messages\n   * @return {boolean} true if a the message was logged\n   */\n  msg_(tag, level, messages) {\n    if (level > (levelOverride_ ?? this.level_)) {\n      return false;\n    }\n\n    const cs = this.win.console;\n    const fn =\n      {\n        [LogLevel.ERROR]: cs.error,\n        [LogLevel.INFO]: cs.info,\n        [LogLevel.WARN]: cs.warn,\n      }[level] ?? cs.log;\n\n    const args = this.maybeExpandMessageArgs_(messages);\n    // Prefix console message with \"[tag]\".\n    const prefix = `[${tag}]`;\n    if (isString(args[0])) {\n      // Prepend string to avoid breaking string substitutions e.g. %s.\n      args[0] = prefix + ' ' + args[0];\n    } else {\n      args.unshift(prefix);\n    }\n    fn.apply(cs, args);\n\n    return true;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} args\n   */\n  fine(tag, ...args) {\n    this.msg_(tag, LogLevel.FINE, args);\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} args\n   */\n  info(tag, ...args) {\n    this.msg_(tag, LogLevel.INFO, args);\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} args\n   */\n  warn(tag, ...args) {\n    this.msg_(tag, LogLevel.WARN, args);\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} tag\n   * @param {...*} args\n   */\n  error(tag, ...args) {\n    if (!this.msg_(tag, LogLevel.ERROR, args)) {\n      const error = this.createError.apply(this, args);\n      error.name = tag || error.name;\n      self.__AMP_REPORT_ERROR?.(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} tag\n   * @param {...*} args\n   */\n  expectedError(tag, ...args) {\n    if (!this.msg_(tag, LogLevel.ERROR, args)) {\n      self.__AMP_REPORT_ERROR?.(this.createExpectedError.apply(this, args));\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    return this.setErrorSuffix_(createError.apply(null, arguments));\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    return this.setErrorSuffix_(createExpectedError.apply(null, arguments));\n  }\n\n  /**\n   * @param {!Error} error\n   * @return {!Error}\n   * @private\n   */\n  setErrorSuffix_(error) {\n    error = duplicateErrorIfNecessary(error);\n\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = stripUserError(error.message);\n    }\n\n    return error;\n  }\n\n  /**\n   * @param {!Array} args\n   * @return {!Array}\n   * @private\n   */\n  maybeExpandMessageArgs_(args) {\n    return isArray(args[0])\n      ? this.expandMessageArgs_(/** @type {!Array} */ (args[0]))\n      : args;\n  }\n\n  /**\n   * Either redirects a pair of (errorId, ...args) to a URL where the full\n   * message is displayed, or displays it from a fetched table.\n   *\n   * This method is used by the output of the `transform-log-methods` babel\n   * plugin. It should not be used directly. Use the (*error|assert*|info|warn)\n   * methods instead.\n   *\n   * @param {!Array} parts\n   * @return {!Array}\n   * @private\n   */\n  expandMessageArgs_(parts) {\n    // First value should exist.\n    const id = parts.shift();\n    // Best effort fetch of message template table.\n    // Since this is async, the first few logs might be indirected to a URL even\n    // if in development mode. Message table is ~small so this should be a short\n    // gap.\n    if (getMode(this.win).development) {\n      this.fetchExternalMessagesOnce_();\n    }\n\n    return this.messages_?.[id]\n      ? [this.messages_[id]].concat(parts)\n      : [`More info at ${externalMessageUrl(id, parts)}`];\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {!Array|string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @throws {!Error} When `value` is falsey.\n   * @template T\n   * @closurePrimitive {asserts.truthy}\n   */\n  assert(shouldBeTrueish, opt_message, var_args) {\n    if (isArray(opt_message)) {\n      return this.assert.apply(\n        this,\n        [shouldBeTrueish].concat(\n          this.expandMessageArgs_(/** @type {!Array} */ (opt_message))\n        )\n      );\n    }\n\n    return assertions.assert.apply(\n      null,\n      [this.suffix_].concat(Array.prototype.slice.call(arguments))\n    );\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertElement(shouldBeElement, opt_message) {\n    return assertions.assertElement(\n      this.boundAssertFn_,\n      shouldBeElement,\n      opt_message\n    );\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertString(shouldBeString, opt_message) {\n    return assertions.assertString(\n      this.boundAssertFn_,\n      shouldBeString,\n      opt_message\n    );\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    return assertions.assertNumber(\n      this.boundAssertFn_,\n      shouldBeNumber,\n      opt_message\n    );\n  }\n\n  /**\n   * Throws an error if the first argument is not an array.\n   * The array can be empty.\n   *\n   * @param {*} shouldBeArray\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {!Array} The array value\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertArray(shouldBeArray, opt_message) {\n    return assertions.assertArray(\n      this.boundAssertFn_,\n      shouldBeArray,\n      opt_message\n    );\n  }\n\n  /**\n   * Throws an error if the first argument isn't a boolean.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeBoolean\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {boolean} The boolean value.\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertBoolean(shouldBeBoolean, opt_message) {\n    return assertions.assertBoolean(\n      this.boundAssertFn_,\n      shouldBeBoolean,\n      opt_message\n    );\n  }\n}\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log, userForEmbed: ?Log}}\n */\nself.__AMP_LOG = self.__AMP_LOG || {\n  user: null,\n  dev: null,\n  userForEmbed: null,\n};\n\nconst logs = self.__AMP_LOG;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?typeof Log}\n */\nlet logConstructor = null;\n\n/**\n * Initializes log constructor.\n */\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier than\n  // the binary that does call `initLogConstructor` (amp.js), the extension will\n  // throw an error as that extension will never be able to initialize the log\n  // instances and we also don't want it to call `initLogConstructor` either\n  // (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are ready\n  // for use (stored globally) after the main binary calls `initLogConstructor`.\n  dev();\n  user();\n}\n\n/**\n * Resets log constructor for testing.\n */\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n/**\n * Calls the log constructor with a given level function and suffix.\n * @param {function(number, boolean):!LogLevel} levelFunc\n * @param {string=} opt_suffix\n * @return {!Log}\n */\nfunction callLogConstructor(levelFunc, opt_suffix) {\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return new logConstructor(self, levelFunc, opt_suffix);\n}\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *  3. AMP.setLogLevel(D) is called, where D >= 1.\n *\n * @param {!Element=} opt_element\n * @return {!Log}\n */\nexport function user(opt_element) {\n  // logs.user must exist first to perform the logs.user.win check below\n  if (!logs.user) {\n    logs.user = getUserLogger(USER_ERROR_SENTINEL);\n  }\n\n  if (isFromEmbed(logs.user.win, opt_element)) {\n    return (\n      logs.userForEmbed ||\n      (logs.userForEmbed = getUserLogger(USER_ERROR_EMBED_SENTINEL))\n    );\n  }\n  return logs.user;\n}\n\n/**\n * Getter for user logger\n * @param {string=} suffix\n * @return {!Log}\n */\nfunction getUserLogger(suffix) {\n  return callLogConstructor(\n    (logNum, development) =>\n      development || logNum >= 1 ? LogLevel.FINE : LogLevel.WARN,\n    suffix\n  );\n}\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped\n * in the PROD binary. However, `devLog().assert` result is preserved in either\n * case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *  3. AMP.setLogLevel(D) is called, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  return (\n    logs.dev ||\n    (logs.dev = callLogConstructor((logNum) =>\n      logNum >= 3 ? LogLevel.FINE : logNum >= 2 ? LogLevel.INFO : LogLevel.OFF\n    ))\n  );\n}\n\n/**\n * @param {!Window} win\n * @param {!Element=} opt_element\n * @return {boolean} isEmbed\n */\nfunction isFromEmbed(win, opt_element) {\n  return opt_element && opt_element.ownerDocument.defaultView != win;\n}\n\n/**\n * Throws an error if the first argument isn't trueish.\n *\n * Supports argument substitution into the message via %s placeholders.\n *\n * Throws an error object that has two extra properties:\n * - associatedElement: This is the first element provided in the var args.\n *   It can be used for improved display of error messages.\n * - messageArray: The elements of the substituted message as non-stringified\n *   elements in an array. When e.g. passed to console.error this yields\n *   native displays of things like HTML elements.\n *\n * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n *     not evaluate to true.\n * @param {!Array|string=} opt_message The assertion message\n * @param {*=} opt_1 Optional argument (Var arg as individual params for better\n * @param {*=} opt_2 Optional argument inlining)\n * @param {*=} opt_3 Optional argument\n * @param {*=} opt_4 Optional argument\n * @param {*=} opt_5 Optional argument\n * @param {*=} opt_6 Optional argument\n * @param {*=} opt_7 Optional argument\n * @param {*=} opt_8 Optional argument\n * @param {*=} opt_9 Optional argument\n * @return {T} The value of shouldBeTrueish.\n * @throws {!Error} When `shouldBeTrueish` is falsey.\n * @template T\n * @closurePrimitive {asserts.truthy}\n */\nexport function devAssert(\n  shouldBeTrueish,\n  opt_message,\n  opt_1,\n  opt_2,\n  opt_3,\n  opt_4,\n  opt_5,\n  opt_6,\n  opt_7,\n  opt_8,\n  opt_9\n) {\n  if (mode.isMinified()) {\n    return shouldBeTrueish;\n  }\n  if (self.__AMP_ASSERTION_CHECK) {\n    // This will never execute regardless, but will be included on unminified\n    // builds. It will be DCE'd away from minified builds, and so can be used to\n    // validate that Babel is properly removing dev assertions in minified\n    // builds.\n    console /*OK*/\n      .log('__devAssert_sentinel__');\n  }\n\n  return dev()./*Orig call*/ assert(\n    shouldBeTrueish,\n    opt_message,\n    opt_1,\n    opt_2,\n    opt_3,\n    opt_4,\n    opt_5,\n    opt_6,\n    opt_7,\n    opt_8,\n    opt_9\n  );\n}\n\n/**\n * Throws an error if the first argument isn't trueish.\n *\n * Supports argument substitution into the message via %s placeholders.\n *\n * Throws an error object that has two extra properties:\n * - associatedElement: This is the first element provided in the var args.\n *   It can be used for improved display of error messages.\n * - messageArray: The elements of the substituted message as non-stringified\n *   elements in an array. When e.g. passed to console.error this yields\n *   native displays of things like HTML elements.\n *\n * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n *     not evaluate to true.\n * @param {!Array|string=} opt_message The assertion message\n * @param {*=} opt_1 Optional argument (Var arg as individual params for better\n * @param {*=} opt_2 Optional argument inlining)\n * @param {*=} opt_3 Optional argument\n * @param {*=} opt_4 Optional argument\n * @param {*=} opt_5 Optional argument\n * @param {*=} opt_6 Optional argument\n * @param {*=} opt_7 Optional argument\n * @param {*=} opt_8 Optional argument\n * @param {*=} opt_9 Optional argument\n * @return {T} The value of shouldBeTrueish.\n * @throws {!Error} When `shouldBeTrueish` is falsey.\n * @template T\n * @closurePrimitive {asserts.truthy}\n */\nexport function userAssert(\n  shouldBeTrueish,\n  opt_message,\n  opt_1,\n  opt_2,\n  opt_3,\n  opt_4,\n  opt_5,\n  opt_6,\n  opt_7,\n  opt_8,\n  opt_9\n) {\n  return user()./*Orig call*/ assert(\n    shouldBeTrueish,\n    opt_message,\n    opt_1,\n    opt_2,\n    opt_3,\n    opt_4,\n    opt_5,\n    opt_6,\n    opt_7,\n    opt_8,\n    opt_9\n  );\n}\n", "/**\n * @fileoverview Registration and getter functions for AMP services.\n *\n * Invariant: Service getters never return null for registered services.\n */\n\nimport {Deferred} from '#core/data-structures/promise';\nimport {getWin} from '#core/window';\n\nimport {dev, devAssert} from '#utils/log';\n\n/**\n * Holds info about a service.\n * - obj: Actual service implementation when available.\n * - promise: Promise for the obj.\n * - resolve: Function to resolve the promise with the object.\n * - context: Argument for ctor, either a window or an ampdoc.\n * - ctor: Function that constructs and returns the service.\n * @typedef {{\n *   obj: (?Object),\n *   promise: (?Promise),\n *   resolve: (?function(!Object)),\n *   reject: (?function((*))),\n *   context: (?Window|?./service/ampdoc-impl.AmpDoc),\n *   ctor: (function(new:Object, !Window)|\n *          function(new:Object, !./service/ampdoc-impl.AmpDoc)),\n * }}\n */\nlet ServiceHolderDef;\n\n/**\n * This interface provides a `dispose` method that will be called by\n * runtime when a service needs to be disposed of.\n * @interface\n */\nexport class Disposable {\n  /**\n   * Instructs the service to release any resources it might be holding. Can\n   * be called only once in the lifecycle of a service.\n   */\n  dispose() {}\n}\n\n/**\n * Installs a service override on amp-doc level.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} id\n * @param {!Object} service The service.\n */\nexport function installServiceInEmbedDoc(ampdoc, id, service) {\n  registerServiceInternal(\n    getAmpdocServiceHolder(ampdoc),\n    ampdoc,\n    id,\n    function () {\n      return service;\n    },\n    /* override */ true\n  );\n}\n\n/**\n * Installs a service override in the scope of an embedded window.\n * @param {!Window} embedWin\n * @param {string} id\n * @param {function(new:Object, !Window)} constructor\n */\nexport function registerServiceBuilderInEmbedWin(embedWin, id, constructor) {\n  registerServiceInternal(\n    embedWin,\n    embedWin,\n    id,\n    constructor,\n    /* override */ true\n  );\n}\n\n/**\n * Registers a service given a class to be used as implementation.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {function(new:Object, !Window)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilder(win, id, constructor, opt_instantiate) {\n  win = getTopWindow(win);\n  registerServiceInternal(win, win, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(win, id);\n  }\n}\n\n/**\n * Returns a service and registers it given a class to be used as\n * implementation.\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id of the service.\n * @param {function(new:Object, !./service/ampdoc-impl.AmpDoc)} constructor\n * @param {boolean=} opt_instantiate Whether to immediately create the service\n */\nexport function registerServiceBuilderForDoc(\n  nodeOrDoc,\n  id,\n  constructor,\n  opt_instantiate\n) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  registerServiceInternal(holder, ampdoc, id, constructor);\n  if (opt_instantiate) {\n    getServiceInternal(holder, id);\n  }\n}\n\n/**\n * Reject a service promise.\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @param {string} id\n * @param {*} error\n */\nexport function rejectServicePromiseForDoc(nodeOrDoc, id, error) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  rejectServicePromiseInternal(holder, id, error);\n}\n\n/**\n * Returns a service for the given id and window (a per-window singleton). Users\n * should typically wrap this as a special purpose function (e.g.\n * `Services.vsyncFor(win)`) for type safety and because the factory should not\n * be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @template T\n * @return {T}\n */\nexport function getService(win, id) {\n  win = getTopWindow(win);\n  return getServiceInternal(win, id);\n}\n\n/**\n * Returns a service for the given id and window (a per-window singleton). But\n * it looks in the immediate window scope, not the top-level window.\n * @param {!Window} win\n * @param {string} id of the service.\n * @template T\n * @return {T}\n */\nexport function getServiceInEmbedWin(win, id) {\n  return getServiceInternal(win, id);\n}\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. `Services.vsyncFor(win)`) for type safety and because the\n * factory should not be passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nexport function getServicePromise(win, id) {\n  return getServicePromiseInternal(win, id);\n}\n\n/**\n * Returns a service or null with the given id.\n * @param {!Window} win\n * @param {string} id\n * @return {?Object} The service.\n */\nexport function getExistingServiceOrNull(win, id) {\n  win = getTopWindow(win);\n  if (isServiceRegistered(win, id)) {\n    return getServiceInternal(win, id);\n  } else {\n    return null;\n  }\n}\n\n/**\n * Like getServicePromise but returns null if the service was never registered.\n * @param {!Window} win\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNull(win, id) {\n  return getServicePromiseOrNullInternal(win, id);\n}\n\n/**\n * Returns a service for the given id and ampdoc (a per-ampdoc singleton).\n * Expects service `id` to be registered.\n * @param {!Element|!ShadowRoot|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {T}\n * @template T\n */\nexport function getServiceForDoc(elementOrAmpDoc, id) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  return getServiceInternal(holder, id);\n}\n\n/**\n * Returns a service for the given id and ampdoc (a per-ampdoc singleton).\n * If service `id` is not registered, returns null.\n * @param {!Element|!ShadowRoot|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {?Object}\n */\nexport function getServiceForDocOrNull(elementOrAmpDoc, id) {\n  const ampdoc = getAmpdoc(elementOrAmpDoc);\n  const holder = getAmpdocServiceHolder(ampdoc);\n  if (isServiceRegistered(holder, id)) {\n    return getServiceInternal(holder, id);\n  } else {\n    return null;\n  }\n}\n\n/**\n * Returns a promise for a service for the given id and ampdoc. Also expects\n * a service that has the actual implementation. The promise resolves when\n * the implementation loaded.\n * @param {!Element|!ShadowRoot|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {!Promise<!Object>}\n */\nexport function getServicePromiseForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseInternal(getAmpdocServiceHolder(elementOrAmpDoc), id);\n}\n\n/**\n * Like getServicePromiseForDoc but returns null if the service was never\n * registered for this ampdoc.\n * @param {!Element|!ShadowRoot|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n * @param {string} id\n * @return {?Promise<!Object>}\n */\nexport function getServicePromiseOrNullForDoc(elementOrAmpDoc, id) {\n  return getServicePromiseOrNullInternal(\n    getAmpdocServiceHolder(elementOrAmpDoc),\n    id\n  );\n}\n\n/**\n * Set the parent and top windows on a child window (friendly iframe).\n * @param {!Window} win\n * @param {!Window} parentWin\n */\nexport function setParentWindow(win, parentWin) {\n  win.__AMP_PARENT = parentWin;\n  win.__AMP_TOP = getTopWindow(parentWin);\n}\n\n/**\n * Returns the parent window for a child window (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getParentWindow(win) {\n  return win.__AMP_PARENT || win;\n}\n\n/**\n * Returns the top window where AMP Runtime is installed for a child window\n * (friendly iframe).\n * @param {!Window} win\n * @return {!Window}\n */\nexport function getTopWindow(win) {\n  return win.__AMP_TOP || (win.__AMP_TOP = win);\n}\n\n/**\n * Returns the parent \"friendly\" iframe if the node belongs to a child window.\n * @param {!Node} node\n * @param {!Window=} opt_topWin\n * @return {?HTMLIFrameElement}\n */\nexport function getParentWindowFrameElement(node, opt_topWin) {\n  const childWin = (node.ownerDocument || node).defaultView;\n  const topWin = opt_topWin || getTopWindow(childWin);\n  if (childWin && childWin != topWin && getTopWindow(childWin) == topWin) {\n    try {\n      return /** @type {?HTMLIFrameElement} */ (childWin.frameElement);\n    } catch (e) {\n      // Ignore the error.\n    }\n  }\n  return null;\n}\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc}\n */\nexport function getAmpdoc(nodeOrDoc) {\n  if (nodeOrDoc.nodeType) {\n    const win = getWin(nodeOrDoc);\n    return getAmpdocService(win).getAmpDoc(/** @type {!Node} */ (nodeOrDoc));\n  }\n  return /** @type {!./service/ampdoc-impl.AmpDoc} */ (nodeOrDoc);\n}\n\n/**\n * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrDoc\n * @return {!./service/ampdoc-impl.AmpDoc|!Window}\n */\nfunction getAmpdocServiceHolder(nodeOrDoc) {\n  const ampdoc = getAmpdoc(nodeOrDoc);\n  return ampdoc.isSingleDoc() ? ampdoc.win : ampdoc;\n}\n\n/**\n * This is essentially a duplicate of `ampdoc.js`, but necessary to avoid\n * circular dependencies.\n * @param {!Window} win\n * @return {!./service/ampdoc-impl.AmpDocService}\n */\nfunction getAmpdocService(win) {\n  return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n    getService(win, 'ampdoc')\n  );\n}\n\n/**\n * Get service `id` from `holder`. Assumes the service\n * has already been registered.\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {Object}\n */\nfunction getServiceInternal(holder, id) {\n  devAssert(\n    isServiceRegistered(holder, id),\n    `Expected service ${id} to be registered`\n  );\n  const services = getServices(holder);\n  const s = services[id];\n  if (!s.obj) {\n    devAssert(s.ctor, `Service ${id} registered without ctor nor impl.`);\n    devAssert(s.context, `Service ${id} registered without context.`);\n    s.obj = new s.ctor(s.context);\n    devAssert(s.obj, `Service ${id} constructed to null.`);\n    s.context = null;\n    // The service may have been requested already, in which case we have a\n    // pending promise we need to fulfill.\n    if (s.resolve) {\n      s.resolve(s.obj);\n    }\n  }\n  return s.obj;\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {!Window|!./service/ampdoc-impl.AmpDoc} context Win or AmpDoc.\n * @param {string} id of the service.\n * @param {?function(new:Object, !Window)|?function(new:Object, !./service/ampdoc-impl.AmpDoc)} ctor Constructor function to new the service. Called with context.\n * @param {boolean=} opt_override\n * @param {boolean=} opt_sharedInstance\n */\nfunction registerServiceInternal(\n  holder,\n  context,\n  id,\n  ctor,\n  opt_override,\n  opt_sharedInstance\n) {\n  const services = getServices(holder);\n  let s = services[id];\n\n  if (!s) {\n    s = services[id] = {\n      obj: null,\n      promise: null,\n      resolve: null,\n      reject: null,\n      context: null,\n      ctor: null,\n      sharedInstance: opt_sharedInstance || false,\n    };\n  }\n\n  if (!opt_override && s.ctor) {\n    // Service already registered.\n    return;\n  }\n\n  s.ctor = ctor;\n  s.context = context;\n  s.sharedInstance = opt_sharedInstance || false;\n\n  // The service may have been requested already, in which case there is a\n  // pending promise that needs to fulfilled.\n  if (s.resolve) {\n    // getServiceInternal will resolve the promise.\n    getServiceInternal(holder, id);\n  }\n}\n\n/**\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {!Promise<!Object>}\n */\nfunction getServicePromiseInternal(holder, id) {\n  const cached = getServicePromiseOrNullInternal(holder, id);\n  if (cached) {\n    return cached;\n  }\n  // Service is not registered.\n\n  // TODO(@cramforce): Add a check that if the element is eventually registered\n  // that the service is actually provided and this promise resolves.\n  const services = getServices(holder);\n  services[id] = emptyServiceHolderWithPromise();\n  return /** @type {!Promise<!Object>} */ (services[id].promise);\n}\n\n/**\n * @param {!Object} holder\n * @param {string} id of the service.\n * @param {*} error\n */\nfunction rejectServicePromiseInternal(holder, id, error) {\n  const services = getServices(holder);\n  const s = services[id];\n  if (s) {\n    if (s.reject) {\n      s.reject(error);\n    }\n    return;\n  }\n\n  services[id] = emptyServiceHolderWithPromise();\n  services[id].reject(error);\n}\n\n/**\n * Returns a promise for service `id` if the service has been registered\n * on `holder`.\n * @param {!Object} holder\n * @param {string} id of the service.\n * @return {?Promise<!Object>}\n */\nfunction getServicePromiseOrNullInternal(holder, id) {\n  const services = getServices(holder);\n  const s = services[id];\n  if (s) {\n    if (s.promise) {\n      return s.promise;\n    } else {\n      // Instantiate service if not already instantiated.\n      getServiceInternal(holder, id);\n      return (s.promise = Promise.resolve(/** @type {!Object} */ (s.obj)));\n    }\n  }\n  return null;\n}\n\n/**\n * Returns the object that holds the services registered in a holder.\n * @param {!Object} holder\n * @return {!Object<string,!ServiceHolderDef>}\n */\nfunction getServices(holder) {\n  let services = holder.__AMP_SERVICES;\n  if (!services) {\n    services = holder.__AMP_SERVICES = {};\n  }\n  return services;\n}\n\n/**\n * Whether the specified service implements `Disposable` interface.\n * @param {!Object} service\n * @return {boolean}\n */\nexport function isDisposable(service) {\n  return typeof service.dispose == 'function';\n}\n\n/**\n * Asserts that the specified service implements `Disposable` interface and\n * typecasts the instance to `Disposable`.\n * @param {!Object} service\n * @return {!Disposable}\n */\nexport function assertDisposable(service) {\n  devAssert(isDisposable(service), 'required to implement Disposable');\n  return /** @type {!Disposable} */ (service);\n}\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * ampdoc scope.\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n */\nexport function disposeServicesForDoc(ampdoc) {\n  disposeServicesInternal(ampdoc);\n}\n\n/**\n * Disposes all disposable (implements `Disposable` interface) services in\n * embed scope.\n * @param {!Window} embedWin\n */\nexport function disposeServicesForEmbed(embedWin) {\n  disposeServicesInternal(embedWin);\n}\n\n/**\n * @param {!Object} holder Object holding the service instances.\n */\nfunction disposeServicesInternal(holder) {\n  const services = getServices(holder);\n  for (const id in services) {\n    if (!Object.prototype.hasOwnProperty.call(services, id)) {\n      continue;\n    }\n    const serviceHolder = services[id];\n    if (serviceHolder.sharedInstance) {\n      continue;\n    }\n    if (serviceHolder.obj) {\n      disposeServiceInternal(id, serviceHolder.obj);\n    } else if (serviceHolder.promise) {\n      serviceHolder.promise.then((instance) =>\n        disposeServiceInternal(id, instance)\n      );\n    }\n  }\n}\n\n/**\n * @param {string} id\n * @param {!Object} service\n */\nfunction disposeServiceInternal(id, service) {\n  if (!isDisposable(service)) {\n    return;\n  }\n  try {\n    assertDisposable(service).dispose();\n  } catch (e) {\n    // Ensure that a failure to dispose a service does not disrupt other\n    // services.\n    dev().error('SERVICE', 'failed to dispose service', id, e);\n  }\n}\n\n/**\n * This adopts the service **instance** from the parent.\n *\n * This function is dangerous! Sharing an instance means data can leak to and\n * from a child ampdoc.\n *\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} id\n */\nexport function adoptServiceForEmbedDoc(ampdoc, id) {\n  const service = getServiceInternal(\n    getAmpdocServiceHolder(devAssert(ampdoc.getParent())),\n    id\n  );\n  registerServiceInternal(\n    getAmpdocServiceHolder(ampdoc),\n    ampdoc,\n    id,\n    function () {\n      return service;\n    },\n    /* override */ false,\n    /* sharedInstance */ true\n  );\n}\n\n/**\n * This adopts the service **factory** from the parent.\n *\n * This function is safer than sharing the service instance, since each ampdoc\n * will create its own instance of the factory (and each instance will have its\n * own instance data). Note that static data is still shared, so it's not 100%\n * foolproof.\n *\n * @param {!./service/ampdoc-impl.AmpDoc} ampdoc\n * @param {string} id\n */\nexport function adoptServiceFactoryForEmbedDoc(ampdoc, id) {\n  const parentHolder = getAmpdocServiceHolder(devAssert(ampdoc.getParent()));\n  devAssert(\n    isServiceRegistered(parentHolder, id),\n    `Expected service ${id} to be registered`\n  );\n  const service = getServices(parentHolder)[id];\n  registerServiceInternal(\n    getAmpdocServiceHolder(ampdoc),\n    ampdoc,\n    id,\n    devAssert(service.ctor)\n  );\n}\n\n/**\n * Resets a single service, so it gets recreated on next getService invocation.\n * @param {!Object} holder\n * @param {string} id of the service.\n */\nexport function resetServiceForTesting(holder, id) {\n  if (holder.__AMP_SERVICES) {\n    holder.__AMP_SERVICES[id] = null;\n  }\n}\n\n/**\n * @param {!Object} holder Object holding the service instance.\n * @param {string} id of the service.\n * @return {boolean}\n */\nfunction isServiceRegistered(holder, id) {\n  const service = holder.__AMP_SERVICES && holder.__AMP_SERVICES[id];\n  // All registered services must have a constructor.\n  return !!(service && service.ctor);\n}\n\n/** @return {!ServiceHolderDef} */\nfunction emptyServiceHolderWithPromise() {\n  const deferred = new Deferred();\n  const {promise, reject, resolve} = deferred;\n  promise.catch(() => {}); // avoid uncaught exception when service gets rejected\n  return {\n    obj: null,\n    promise,\n    resolve,\n    reject,\n    context: null,\n    ctor: null,\n  };\n}\n", "import * as dom from '#core/dom';\n\nimport {extensionScriptInNode} from '#service/extension-script';\n\nimport {userAssert} from '#utils/log';\n\nimport {\n  getAmpdoc,\n  getService,\n  getServiceForDocOrNull,\n  getServicePromise,\n  getServicePromiseForDoc,\n  getServicePromiseOrNull,\n  getServicePromiseOrNullForDoc,\n} from './service-helpers';\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {string} version The extension version.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailable(\n  win,\n  id,\n  extension,\n  version,\n  opt_element\n) {\n  const s = getServicePromiseOrNull(win, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n  return getElementServicePromiseOrNull(\n    win,\n    id,\n    extension,\n    version,\n    opt_element\n  );\n}\n\n/**\n * Returns a promise for a service for the given id and window. Also expects an\n * element that has the actual implementation. The promise resolves when the\n * implementation loaded. Users should typically wrap this as a special purpose\n * function (e.g. Services.viewportForDoc(...)) for type safety and because the\n * factory should not be passed around.\n * @param {!Element|!ShadowRoot} element\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an element,\n *     not the extension.\n * @return {!Promise<*>}\n */\nexport function getElementServiceForDoc(element, id, extension, opt_element) {\n  return getElementServiceIfAvailableForDoc(\n    element,\n    id,\n    extension,\n    opt_element\n  ).then((service) => assertService(service, id, extension));\n}\n\n/**\n * Same as getElementService but produces null if the given element is not\n * actually available on the current page.\n * @param {!Element|!ShadowRoot} element\n * @param {string} id of the service.\n * @param {string} extension Name of the custom extension that provides the\n *     implementation of this service.\n * @param {boolean=} opt_element Whether this service is provided by an\n *     element, not the extension.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDoc(\n  element,\n  id,\n  extension,\n  opt_element\n) {\n  const s = getServicePromiseOrNullForDoc(element, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (s);\n  }\n  const ampdoc = getAmpdoc(element);\n  return ampdoc\n    .whenExtensionsKnown()\n    .then(() => {\n      const version = ampdoc.getExtensionVersion(extension);\n      if (!version) {\n        return null;\n      }\n      const extensions = getService(ampdoc.win, 'extensions');\n      return extensions.waitForExtension(extension, version);\n    })\n    .then((ext) => {\n      if (!ext) {\n        return null;\n      }\n      // If this service is provided by an element, then we can't depend on\n      // the service (they may not use the element).\n      if (opt_element) {\n        return getServicePromiseOrNullForDoc(element, id);\n      }\n      return getServicePromiseForDoc(element, id);\n    });\n}\n\n/**\n * Returns a promise for service for the given id in the embed scope of\n * a given element, if it exists. Falls back to ampdoc scope if the element\n * is not embedded.\n *\n * @param {!Element|!ShadowRoot} element\n * @param {string} id of the service.\n * @param {string} extension Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<?Object>}\n */\nexport function getElementServiceIfAvailableForDocInEmbedScope(\n  element,\n  id,\n  extension\n) {\n  const s = getServiceForDocOrNull(element, id);\n  if (s) {\n    return /** @type {!Promise<?Object>} */ (Promise.resolve(s));\n  }\n  return getElementServiceIfAvailableForDoc(element, id, extension);\n}\n\n/**\n * Throws user error if `service` is null.\n * @param {Object} service\n * @param {string} id\n * @param {string} extension\n * @return {!Object}\n * @private\n * @closurePrimitive {asserts.matchesReturn}\n */\nfunction assertService(service, id, extension) {\n  return /** @type {!Object} */ (\n    userAssert(\n      service,\n      'Service %s was requested to be provided through %s, ' +\n        'but %s is not loaded in the current page. To fix this ' +\n        'problem load the JavaScript file for %s in this page.',\n      id,\n      extension,\n      extension,\n      extension\n    )\n  );\n}\n\n/**\n * Returns the promise for service with `id` on the given window if available.\n * Otherwise, resolves with null (service was not registered).\n * @param {!Window} win\n * @param {string} id\n * @param {string} extension\n * @param {string} version\n * @param {boolean=} opt_element\n * @return {!Promise<Object>}\n * @private\n */\nfunction getElementServicePromiseOrNull(\n  win,\n  id,\n  extension,\n  version,\n  opt_element\n) {\n  return dom\n    .waitForBodyOpenPromise(win.document)\n    .then(() => {\n      // If there is an extension script wait for it to load before trying\n      // to get the service. Prevents a race condition when everything but\n      // the extensions is in cache. If there is no script then it's either\n      // not present, or the service was defined by a test. In those cases\n      // we don't wait around for an extension that does not exist.\n      const extensions = getService(win, 'extensions');\n\n      // TODO(jpettitt) investigate registerExtension to short circuit\n      // the dom call in extensionScriptsInNode()\n      if (!extensionScriptInNode(extensions.win, extension, version)) {\n        return null;\n      }\n      return extensions.waitForExtension(extension, version);\n    })\n    .then((ext) => {\n      if (!ext) {\n        return null;\n      }\n      // If this service is provided by an element, then we can't depend on\n      // the service (they may not use the element).\n      if (opt_element) {\n        return getServicePromiseOrNull(win, id);\n      }\n      return getServicePromise(win, id);\n    });\n}\n", "import {\n  getElementServiceForDoc,\n  getElementServiceIfAvailable,\n  getElementServiceIfAvailableForDoc,\n  getElementServiceIfAvailableForDocInEmbedScope,\n} from '../element-service';\nimport {\n  getAmpdoc,\n  getExistingServiceOrNull,\n  getService,\n  getServiceForDoc,\n  getServiceForDocOrNull,\n  getServiceInEmbedWin,\n  getServicePromiseForDoc,\n} from '../service-helpers';\n\n/** @typedef {!../extensions/amp-subscriptions/0.1/amp-subscriptions.SubscriptionService} */\nexport let SubscriptionService;\n\nexport class Services {\n  /**\n   * Hint: Add extensions folder path to compile.js with\n   * warnings cannot find modules.\n   */\n\n  /**\n   * Returns a promise for the Access service.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDoc(element) {\n    return /** @type {!Promise<!../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceForDoc(element, 'access', 'amp-access')\n    );\n  }\n\n  /**\n   * Returns a promise for the Access service or a promise for null if the\n   * service is not available on the current page.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>}\n   */\n  static accessServiceForDocOrNull(element) {\n    return /** @type {!Promise<?../extensions/amp-access/0.1/amp-access.AccessService>} */ (\n      getElementServiceIfAvailableForDoc(element, 'access', 'amp-access')\n    );\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<!SubscriptionService>}\n   */\n  static subscriptionsServiceForDoc(element) {\n    return /** @type {!Promise<!SubscriptionService>} */ (\n      getElementServiceForDoc(element, 'subscriptions', 'amp-subscriptions')\n    );\n  }\n\n  /**\n   * Returns a promise for the Subscriptions service.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<?SubscriptionService>}\n   */\n  static subscriptionsServiceForDocOrNull(element) {\n    return /** @type {!Promise<?SubscriptionService>} */ (\n      getElementServiceIfAvailableForDoc(\n        element,\n        'subscriptions',\n        'amp-subscriptions'\n      )\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!./service/action-impl.ActionService}\n   */\n  static actionServiceForDoc(element) {\n    return /** @type {!./service/action-impl.ActionService} */ (\n      getServiceForDocOrNull(element, 'action')\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!./service/standard-actions-impl.StandardActions}\n   */\n  static standardActionsForDoc(element) {\n    return /** @type {!./service/standard-actions-impl.StandardActions} */ (\n      getServiceForDocOrNull(element, 'standard-actions')\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<!../extensions/amp-analytics/0.1/activity-impl.Activity>}\n   */\n  static activityForDoc(element) {\n    return /** @type {!Promise<!../extensions/amp-analytics/0.1/activity-impl.Activity>} */ (\n      getElementServiceForDoc(element, 'activity', 'amp-analytics')\n    );\n  }\n\n  /**\n   * Returns the global instance of the `AmpDocService` service that can be\n   * used to resolve an ampdoc for any node: either in the single-doc or\n   * shadow-doc environment.\n   * @param {!Window} window\n   * @return {!./service/ampdoc-impl.AmpDocService}\n   */\n  static ampdocServiceFor(window) {\n    return /** @type {!./service/ampdoc-impl.AmpDocService} */ (\n      getService(window, 'ampdoc')\n    );\n  }\n\n  /**\n   * Returns the AmpDoc for the specified context node.\n   * @param {!Node|!./service/ampdoc-impl.AmpDoc} nodeOrAmpDoc\n   * @return {!./service/ampdoc-impl.AmpDoc}\n   */\n  static ampdoc(nodeOrAmpDoc) {\n    return getAmpdoc(nodeOrAmpDoc);\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @param {boolean=} loadAnalytics\n   * @return {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDoc(element, loadAnalytics = false) {\n    if (loadAnalytics) {\n      // Get Extensions service and force load analytics extension.\n      const ampdoc = getAmpdoc(element);\n      Services.extensionsFor(ampdoc.win)./*OK*/ installExtensionForDoc(\n        ampdoc,\n        'amp-analytics'\n      );\n    }\n    return /** @type {!Promise<!../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceForDoc(\n        element,\n        'amp-analytics-instrumentation',\n        'amp-analytics'\n      )\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>}\n   */\n  static analyticsForDocOrNull(element) {\n    return /** @type {!Promise<?../extensions/amp-analytics/0.1/instrumentation.InstrumentationService>} */ (\n      getElementServiceIfAvailableForDoc(\n        element,\n        'amp-analytics-instrumentation',\n        'amp-analytics'\n      )\n    );\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/batched-xhr-impl.BatchedXhr}\n   */\n  static batchedXhrFor(window) {\n    return /** @type {!./service/batched-xhr-impl.BatchedXhr} */ (\n      getService(window, 'batched-xhr')\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>}\n   */\n  static bindForDocOrNull(element) {\n    return /** @type {!Promise<?../extensions/amp-bind/0.1/bind-impl.Bind>} */ (\n      getElementServiceIfAvailableForDocInEmbedScope(\n        element,\n        'bind',\n        'amp-bind'\n      )\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<?../extensions/amp-script/0.1/amp-script.AmpScriptService>}\n   */\n  static scriptForDocOrNull(element) {\n    return /** @type {!Promise<?../extensions/amp-script/0.1/amp-script.AmpScriptService>} */ (\n      getElementServiceIfAvailableForDocInEmbedScope(\n        element,\n        'amp-script',\n        'amp-script'\n      )\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/cid-impl.CidDef>}\n   */\n  static cidForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/cid-impl.CidDef>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'cid')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/navigation.Navigation}\n   */\n  static navigationForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/navigation.Navigation} */ (\n      getServiceForDoc(elementOrAmpDoc, 'navigation')\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<!../extensions/amp-loader/0.1/amp-loader.LoaderService>}\n   */\n  static loaderServiceForDoc(element) {\n    return /** @type {!Promise<!../extensions/amp-loader/0.1/amp-loader.LoaderService>} */ (\n      getElementServiceForDoc(element, 'loader', 'amp-loader')\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<!../extensions/amp-standalone/0.1/amp-standalone.StandaloneService>}\n   */\n  static standaloneServiceForDoc(element) {\n    return /** @type {!Promise<!../extensions/amp-standalone/0.1/amp-standalone.StandaloneService>} */ (\n      getElementServiceForDoc(element, 'standalone', 'amp-standalone')\n    );\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/crypto-impl.Crypto}\n   */\n  static cryptoFor(window) {\n    return /** @type {!./service/crypto-impl.Crypto} */ (\n      getService(window, 'crypto')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/document-info-impl.DocumentInfoDef} Info about the doc\n   */\n  static documentInfoForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/document-info-impl.DocInfo} */ (\n      getServiceForDoc(elementOrAmpDoc, 'documentInfo')\n    ).get();\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/extensions-impl.Extensions}\n   */\n  static extensionsFor(window) {\n    return /** @type {!./service/extensions-impl.Extensions} */ (\n      getService(window, 'extensions')\n    );\n  }\n\n  /**\n   * Returns a service to register callbacks we wish to execute when an\n   * amp-form is submitted.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<../extensions/amp-form/0.1/form-submit-service.FormSubmitService>}\n   */\n  static formSubmitForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<../extensions/amp-form/0.1/form-submit-service.FormSubmitService>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'form-submit-service')\n    );\n  }\n\n  /**\n   * Returns service to listen for `hidden` attribute mutations.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!./service/hidden-observer-impl.HiddenObserver}\n   */\n  static hiddenObserverForDoc(element) {\n    return /** @type {!./service/hidden-observer-impl.HiddenObserver} */ (\n      getServiceForDocOrNull(element, 'hidden-observer')\n    );\n  }\n\n  /**\n   * Returns service implemented in service/history-impl.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/history-impl.History}\n   */\n  static historyForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/history-impl.History} */ (\n      getServiceForDoc(elementOrAmpDoc, 'history')\n    );\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {!./input.Input}\n   */\n  static inputFor(win) {\n    return getService(win, 'input');\n  }\n\n  /**s\n   * Returns a promise for the Inputmask service.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<?../extensions/amp-inputmask/0.1/amp-inputmask.AmpInputmaskService>}\n   */\n  static inputmaskServiceForDocOrNull(element) {\n    return /** @type {!Promise<?../extensions/amp-inputmask/0.1/amp-inputmask.AmpInputmaskService>} */ (\n      getElementServiceIfAvailableForDoc(element, 'inputmask', 'amp-inputmask')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {?./service/loading-indicator.LoadingIndicatorImpl}\n   */\n  static loadingIndicatorOrNull(elementOrAmpDoc) {\n    return /** @type {?./service/loading-indicator.LoadingIndicatorImpl} */ (\n      getServiceForDocOrNull(elementOrAmpDoc, 'loadingIndicator')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!../extensions/amp-next-page/1.0/service.NextPageService}\n   */\n  static nextPageServiceForDoc(elementOrAmpDoc) {\n    return /** @type {!../extensions/amp-next-page/1.0/service.NextPageService} */ (\n      getServiceForDoc(elementOrAmpDoc, 'next-page')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/mutator-interface.MutatorInterface}\n   */\n  static mutatorForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/mutator-interface.MutatorInterface} */ (\n      getServiceForDoc(elementOrAmpDoc, 'mutator')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/owners-interface.OwnersInterface}\n   */\n  static ownersForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/owners-interface.OwnersInterface} */ (\n      getServiceForDoc(elementOrAmpDoc, 'owners')\n    );\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceFor(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getService(window, 'performance')\n    );\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/performance-impl.Performance}\n   */\n  static performanceForOrNull(window) {\n    return /** @type {!./service/performance-impl.Performance}*/ (\n      getExistingServiceOrNull(window, 'performance')\n    );\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/platform-impl.Platform}\n   */\n  static platformFor(window) {\n    return /** @type {!./service/platform-impl.Platform} */ (\n      getService(window, 'platform')\n    );\n  }\n\n  /**\n   * Not installed by default; must be installed in extension code before use.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!./service/position-observer/position-observer-impl.PositionObserver}\n   * @throws If the service is not installed.\n   */\n  static positionObserverForDoc(element) {\n    return /** @type {!./service/position-observer/position-observer-impl.PositionObserver} */ (\n      getServiceForDoc(element, 'position-observer')\n    );\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./preconnect.PreconnectService}\n   */\n  static preconnectFor(window) {\n    return getService(window, 'preconnect');\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/resources-interface.ResourcesInterface}\n   */\n  static resourcesForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/resources-interface.ResourcesInterface} */ (\n      getServiceForDoc(elementOrAmpDoc, 'resources')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/resources-interface.ResourcesInterface>}\n   */\n  static resourcesPromiseForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/resources-interface.ResourcesInterface>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'resources')\n    );\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/variable-service.AmpStoryVariableService>}\n   */\n  static storyVariableServiceForOrNull(win) {\n    return (\n      /** @type {!Promise<?../extensions/amp-story/1.0/variable-service.AmpStoryVariableService>} */\n      (getElementServiceIfAvailable(win, 'story-variable', 'amp-story', '1.0'))\n    );\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/variable-service.AmpStoryVariableService}\n   */\n  static storyVariableService(win) {\n    return (\n      /** @type {?../extensions/amp-story/1.0/variable-service.AmpStoryVariableService} */\n      (getExistingServiceOrNull(win, 'story-variable'))\n    );\n  }\n\n  /**\n   * Version of the story store service depends on which version of amp-story\n   * the publisher is loading. They all have the same implementation.\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService>}\n   */\n  static storyStoreServiceForOrNull(win) {\n    return (\n      /** @type {!Promise<?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService>} */\n      (getElementServiceIfAvailable(win, 'story-store', 'amp-story', '1.0'))\n    );\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService}\n   */\n  static storyStoreService(win) {\n    return (\n      /** @type {?../extensions/amp-story/1.0/amp-story-store-service.AmpStoryStoreService} */\n      (getExistingServiceOrNull(win, 'story-store'))\n    );\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-media-query-service.AmpStoryMediaQueryService}\n   */\n  static storyMediaQueryService(win) {\n    return (\n      /** @type {?../extensions/amp-story/1.0/amp-story-media-query-service.AmpStoryMediaQueryService} */\n      (getExistingServiceOrNull(win, 'story-media-query'))\n    );\n  }\n\n  /**\n   * Get promise with story request service\n   * @param {!Window} win\n   * @return {?Promise<?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService>}\n   */\n  static storyRequestServiceForOrNull(win) {\n    return (\n      /** @type {!Promise<?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService>} */\n      (getElementServiceIfAvailable(win, 'story-request', 'amp-story', '1.0'))\n    );\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService}\n   */\n  static storyRequestService(win) {\n    return (\n      /** @type {?../extensions/amp-story/1.0/amp-story-request-service.AmpStoryRequestService} */\n      (getExistingServiceOrNull(win, 'story-request'))\n    );\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/media-performance-metrics-service.MediaPerformanceMetricsService}\n   */\n  static mediaPerformanceMetricsService(win) {\n    return (\n      /** @type {?../extensions/amp-story/1.0/media-performance-metrics-service.MediaPerformanceMetricsService} */\n      (getExistingServiceOrNull(win, 'media-performance-metrics'))\n    );\n  }\n\n  /**\n   * @param {!Element} el\n   * @return {!Promise<./service/localization.LocalizationService>}\n   */\n  static localizationServiceForOrNull(el) {\n    return /** @type {!Promise<?./service/localization.LocalizationService>} */ (\n      getServicePromiseForDoc(el, 'localization')\n    );\n  }\n\n  /**\n   * @param {!Element} element\n   * @return {?./service/localization.LocalizationService}\n   */\n  static localizationForDoc(element) {\n    return /** @type {?./service/localization.LocalizationService} */ (\n      getServiceForDocOrNull(element, 'localization')\n    );\n  }\n\n  /**\n   * TODO(#14357): Remove this when amp-story:0.1 is deprecated.\n   * @param {!Window} win\n   * @return {!Promise<?../extensions/amp-story/1.0/story-analytics.StoryAnalyticsService>}\n   */\n  static storyAnalyticsServiceForOrNull(win) {\n    return (\n      /** @type {!Promise<?../extensions/amp-story/1.0/story-analytics.StoryAnalyticsService>} */\n      (\n        getElementServiceIfAvailable(\n          win,\n          'story-analytics',\n          'amp-story',\n          '1.0',\n          true\n        )\n      )\n    );\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {?../extensions/amp-story/1.0/story-analytics.StoryAnalyticsService}\n   */\n  static storyAnalyticsService(win) {\n    return (\n      /** @type {?../extensions/amp-story/1.0/story-analytics.StoryAnalyticsService} */\n      (getExistingServiceOrNull(win, 'story-analytics'))\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>}\n   */\n  static webAnimationServiceFor(element) {\n    return (\n      /** @type {!Promise<!../extensions/amp-animation/0.1/web-animation-service.WebAnimationService>} */\n      (getElementServiceForDoc(element, 'web-animation', 'amp-animation'))\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/real-time-config/real-time-config-impl.RealTimeConfigManager>}\n   */\n  static realTimeConfigForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/real-time-config/real-time-config-impl.RealTimeConfigManager>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'real-time-config')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/storage-impl.Storage>}\n   */\n  static storageForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/storage-impl.Storage>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'storage')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/storage-impl.Storage>}\n   * TODO(dmanek): Add tests for this method.\n   */\n  static storageForTopLevelDoc(elementOrAmpDoc) {\n    const thisAmpdoc = Services.ampdoc(elementOrAmpDoc);\n    const ampdocService = Services.ampdocServiceFor(thisAmpdoc.win);\n    const topAmpdoc = ampdocService.isSingleDoc()\n      ? ampdocService.getSingleDoc()\n      : null;\n    // We need to verify that ampdocs are on the same origin, therefore\n    // we compare the windows of both.\n    const ampdoc =\n      topAmpdoc && topAmpdoc.win == thisAmpdoc.win ? topAmpdoc : thisAmpdoc;\n    return /** @type {!Promise<!./service/storage-impl.Storage>} */ (\n      getServicePromiseForDoc(ampdoc, 'storage')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/template-impl.Templates}\n   */\n  static templatesForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/template-impl.Templates} */ (\n      getServiceForDoc(elementOrAmpDoc, 'templates')\n    );\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/timer-impl.Timer}\n   */\n  static timerFor(window) {\n    // TODO(alabiaga): This will always return the top window's Timer service.\n    return /** @type {!./service/timer-impl.Timer} */ (\n      getServiceInEmbedWin(window, 'timer')\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!./service/url-replacements-impl.UrlReplacements}\n   */\n  static urlReplacementsForDoc(element) {\n    return /** @type {!./service/url-replacements-impl.UrlReplacements} */ (\n      getServiceForDocOrNull(element, 'url-replace')\n    );\n  }\n\n  /**\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>}\n   */\n  static userNotificationManagerForDoc(element) {\n    return (\n      /** @type {!Promise<!../extensions/amp-user-notification/0.1/amp-user-notification.UserNotificationManager>} */\n      (\n        getElementServiceForDoc(\n          element,\n          'userNotificationManager',\n          'amp-user-notification'\n        )\n      )\n    );\n  }\n\n  /**\n   * Returns a promise for the consentPolicy Service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>}\n   */\n  static consentPolicyServiceForDocOrNull(element) {\n    return (\n      /** @type {!Promise<?../extensions/amp-consent/0.1/consent-policy-manager.ConsentPolicyManager>} */\n      (\n        getElementServiceIfAvailableForDoc(\n          element,\n          'consentPolicyManager',\n          'amp-consent'\n        )\n      )\n    );\n  }\n\n  /**\n   * Returns a promise for the geo service or a promise for null if\n   * the service is not available on the current page.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>}\n   */\n  static geoForDocOrNull(element) {\n    return /** @type {!Promise<?../extensions/amp-geo/0.1/amp-geo.GeoDef>} */ (\n      getElementServiceIfAvailableForDoc(element, 'geo', 'amp-geo', true)\n    );\n  }\n\n  /**\n   * Unlike most service getters, passing `Node` is necessary for some FIE-scope\n   * services since sometimes we only have the FIE Document for context.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!./service/url-impl.Url}\n   */\n  static urlForDoc(element) {\n    return /** @type {!./service/url-impl.Url} */ (\n      getServiceForDocOrNull(element, 'url')\n    );\n  }\n\n  /**\n   * Returns a promise for the experiment variants or a promise for null if it\n   * is not available on the current page.\n   * @param {!Element|!ShadowRoot} element\n   * @return {!Promise<?../extensions/amp-experiment/0.1/variant.Variants>}\n   */\n  static variantsForDocOrNull(element) {\n    return /** @type {!Promise<?../extensions/amp-experiment/0.1/variant.Variants>} */ (\n      getElementServiceIfAvailableForDoc(\n        element,\n        'variant',\n        'amp-experiment',\n        true\n      )\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/video-manager-impl.VideoManager}\n   */\n  static videoManagerForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/video-manager-impl.VideoManager} */ (\n      getServiceForDoc(elementOrAmpDoc, 'video-manager')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/viewer-interface.ViewerInterface}\n   */\n  static viewerForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/viewer-interface.ViewerInterface} */ (\n      getServiceForDoc(elementOrAmpDoc, 'viewer')\n    );\n  }\n\n  /**\n   * Returns promise for the viewer. This is an unusual case and necessary only\n   * for services that need reference to the viewer before it has been\n   * initialized. Most of the code, however, just should use `viewerForDoc`.\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<!./service/viewer-interface.ViewerInterface>}\n   */\n  static viewerPromiseForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<!./service/viewer-interface.ViewerInterface>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'viewer')\n    );\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/vsync-impl.Vsync}\n   */\n  static vsyncFor(window) {\n    return /** @type {!./service/vsync-impl.Vsync} */ (\n      getService(window, 'vsync')\n    );\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!./service/viewport/viewport-interface.ViewportInterface}\n   */\n  static viewportForDoc(elementOrAmpDoc) {\n    return /** @type {!./service/viewport/viewport-interface.ViewportInterface} */ (\n      getServiceForDoc(elementOrAmpDoc, 'viewport')\n    );\n  }\n\n  /**\n   * @param {!Window} window\n   * @return {!./service/xhr-impl.Xhr}\n   */\n  static xhrFor(window) {\n    return /** @type {!./service/xhr-impl.Xhr} */ (getService(window, 'xhr'));\n  }\n\n  /**\n   * @param {!Element|!./service/ampdoc-impl.AmpDoc} elementOrAmpDoc\n   * @return {!Promise<../amp-cache-url/amp-cache-url.AmpCacheUrlService>}\n   */\n  static cacheUrlServicePromiseForDoc(elementOrAmpDoc) {\n    return /** @type {!Promise<?../amp-cache-url/amp-cache-url.AmpCacheUrlService>} */ (\n      getServicePromiseForDoc(elementOrAmpDoc, 'cache-url')\n    );\n  }\n}\n", "/**\n * Whether addEventListener supports options or only takes capture as a boolean\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet optsSupported;\n\n/**\n * Whether addEventListener supports options or only takes passive as a boolean\n * @type {boolean|undefined}\n */\nlet passiveSupported;\n\n/**\n * Options supported by addEventListener\n * @typedef AddEventListenerOptsDef\n * @property {undefined|boolean} [capture]\n * @property {undefined|boolean} [once]\n * @property {undefined|boolean} [passive]\n * @property {undefined|!AbortSignal} [signal]\n * }}\n */\nlet AddEventListenerOptsDef;\n\n/**\n * Listens for the specified event on the element.\n *\n * Do not use this directly. This method is implemented as a shared\n * dependency. Use `listen()` in either `event-helper` or\n * `#core/3p-frame-messaging`, depending on your use case.\n *\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {!AddEventListenerOptsDef=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function internalListenImplementation(\n  element,\n  eventType,\n  listener,\n  opt_evtListenerOpts\n) {\n  let localElement = element;\n  let localListener = listener;\n  /** @type {?function(!Event)} */\n  let wrapped = (event) => {\n    try {\n      return localListener(event);\n    } catch (e) {\n      // __AMP_REPORT_ERROR is installed globally per window in the entry point.\n      self.__AMP_REPORT_ERROR?.(e);\n      throw e;\n    }\n  };\n  const optsSupported = detectEvtListenerOptsSupport();\n  const capture = !!opt_evtListenerOpts?.capture;\n\n  localElement.addEventListener(\n    eventType,\n    wrapped,\n    optsSupported ? opt_evtListenerOpts : capture\n  );\n  return () => {\n    localElement?.removeEventListener(\n      eventType,\n      wrapped,\n      optsSupported ? opt_evtListenerOpts : capture\n    );\n    // Ensure these are GC'd\n    localListener = null;\n    localElement = null;\n    wrapped = null;\n  };\n}\n\n/**\n * Tests whether the browser supports options as an argument of addEventListener\n * or not.\n *\n * @return {boolean}\n */\nexport function detectEvtListenerOptsSupport() {\n  // Only run the test once\n  if (optsSupported !== undefined) {\n    return optsSupported;\n  }\n\n  optsSupported = false;\n  try {\n    // Test whether browser supports EventListenerOptions or not\n    const options = {\n      get capture() {\n        optsSupported = true;\n      },\n    };\n    self.addEventListener('test-options', null, options);\n    self.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return optsSupported;\n}\n\n/**\n * Resets the test for whether addEventListener supports options or not.\n */\nexport function resetEvtListenerOptsSupportForTesting() {\n  optsSupported = undefined;\n}\n\n/**\n * Return boolean. if listener option is supported, return `true`.\n * if not supported, return `false`\n * @param {!Window} win\n * @return {boolean}\n */\nexport function supportsPassiveEventListener(win) {\n  if (passiveSupported !== undefined) {\n    return passiveSupported;\n  }\n\n  passiveSupported = false;\n  try {\n    const options = {\n      get passive() {\n        // This function will be called when the browser\n        // attempts to access the passive property.\n        passiveSupported = true;\n        return false;\n      },\n    };\n\n    win.addEventListener('test-options', null, options);\n    win.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return passiveSupported;\n}\n\n/**\n * Resets the test for whether addEventListener supports passive options or not.\n */\nexport function resetPassiveSupportedForTesting() {\n  passiveSupported = undefined;\n}\n", "import {internalListenImplementation} from '#core/dom/event-helper-listen';\nimport {lastChildElement} from '#core/dom/query';\nimport * as mode from '#core/mode';\n\nimport {user} from '#utils/log';\n\n/** @const {string}  */\nconst LOAD_FAILURE_PREFIX = 'Failed to load:';\n\n/** @const {string} */\nexport const MEDIA_LOAD_FAILURE_SRC_PROPERTY = '__AMP_MEDIA_LOAD_FAILURE_SRC';\n\n/**\n * Returns a CustomEvent with a given type and detail; supports fallback for IE.\n * @param {!Window} win\n * @param {string} type\n * @param {!JsonObject|string|undefined|null} detail\n * @param {EventInit=} opt_eventInit\n * @return {!Event}\n */\nexport function createCustomEvent(win, type, detail, opt_eventInit) {\n  const eventInit = /** @type {!CustomEventInit} */ ({detail});\n  Object.assign(eventInit, opt_eventInit);\n  // win.CustomEvent is a function on Edge, Chrome, FF, Safari but\n  // is an object on IE 11.\n  if (mode.isEsm() || typeof win.CustomEvent == 'function') {\n    return new win.CustomEvent(type, eventInit);\n  } else {\n    // Deprecated fallback for IE.\n    const e = win.document.createEvent('CustomEvent');\n    e.initCustomEvent(\n      type,\n      !!eventInit.bubbles,\n      !!eventInit.cancelable,\n      detail\n    );\n    return e;\n  }\n}\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n    element,\n    eventType,\n    listener,\n    opt_evtListenerOpts\n  );\n}\n\n/**\n * Returns the data property of an event with the correct type.\n * @param {!Event|{data: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getData(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.data);\n}\n\n/**\n * Returns the detail property of an event with the correct type.\n * @param {!Event|{detail: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getDetail(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.detail);\n}\n\n/**\n * Listens for the specified event on the element and removes the listener\n * as soon as event has been received.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listenOnce(element, eventType, listener, opt_evtListenerOpts) {\n  let localListener = listener;\n  const unlisten = internalListenImplementation(\n    element,\n    eventType,\n    (event) => {\n      try {\n        localListener(event);\n      } finally {\n        // Ensure listener is GC'd\n        localListener = null;\n        unlisten();\n      }\n    },\n    opt_evtListenerOpts\n  );\n  return unlisten;\n}\n\n/**\n * Returns  a promise that will resolve as soon as the specified event has\n * fired on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {Object=} opt_evtListenerOpts\n * @param {function(!UnlistenDef)=} opt_cancel An optional function that, when\n *     provided, will be called with the unlistener. This gives the caller\n *     access to the unlistener, so it may be called manually when necessary.\n * @return {!Promise<!Event>}\n */\nexport function listenOncePromise(\n  element,\n  eventType,\n  opt_evtListenerOpts,\n  opt_cancel\n) {\n  let unlisten;\n  const eventPromise = new Promise((resolve) => {\n    unlisten = listenOnce(element, eventType, resolve, opt_evtListenerOpts);\n  });\n  eventPromise.then(unlisten, unlisten);\n  if (opt_cancel) {\n    opt_cancel(unlisten);\n  }\n  return eventPromise;\n}\n\n/**\n * Whether the specified element/window has been loaded already.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nexport function isLoaded(eleOrWindow) {\n  return !!(\n    eleOrWindow.complete ||\n    eleOrWindow.readyState == 'complete' ||\n    (isHTMLMediaElement(eleOrWindow) && eleOrWindow.readyState > 0) ||\n    // If the passed in thing is a Window, infer loaded state from\n    //\n    (eleOrWindow.document && eleOrWindow.document.readyState == 'complete')\n  );\n}\n\n/**\n * Returns a promise that will resolve or fail based on the eleOrWindow's 'load'\n * and 'error' events. Optionally this method takes a timeout, which will reject\n * the promise if the resource has not loaded by then.\n * @param {T} eleOrWindow Supports both Elements and as a special case Windows.\n * @return {!Promise<T>}\n * @template T\n */\nexport function loadPromise(eleOrWindow) {\n  let unlistenLoad;\n  let unlistenError;\n  if (isLoaded(eleOrWindow)) {\n    return Promise.resolve(eleOrWindow);\n  }\n  const isMediaElement = isHTMLMediaElement(eleOrWindow);\n  if (\n    isMediaElement &&\n    eleOrWindow[MEDIA_LOAD_FAILURE_SRC_PROPERTY] === eleOrWindow.currentSrc\n  ) {\n    return Promise.reject(eleOrWindow);\n  }\n  const loadingPromise = new Promise((resolve, reject) => {\n    // Listen once since IE 5/6/7 fire the onload event continuously for\n    // animated GIFs.\n    if (isMediaElement) {\n      // The following event can be triggered by the media or one of its\n      // sources. Using capture is required as the media events do not bubble.\n      unlistenLoad = listenOnce(eleOrWindow, 'loadedmetadata', resolve, {\n        capture: true,\n      });\n    } else {\n      unlistenLoad = listenOnce(eleOrWindow, 'load', resolve);\n    }\n    // Don't unlisten on error for Windows.\n    if (!eleOrWindow.tagName) {\n      return;\n    }\n    let errorTarget = eleOrWindow;\n    // If the media element has no `src`, it will try to load the sources in\n    // document order. If the last source errors, then the media element\n    // loading errored.\n    if (isMediaElement && !eleOrWindow.hasAttribute('src')) {\n      errorTarget = lastChildElement(\n        eleOrWindow,\n        (child) => child.tagName === 'SOURCE'\n      );\n      if (!errorTarget) {\n        return reject(new Error('Media has no source.'));\n      }\n    }\n    unlistenError = listenOnce(errorTarget, 'error', reject);\n  });\n\n  return loadingPromise.then(\n    () => {\n      if (unlistenError) {\n        unlistenError();\n      }\n      return eleOrWindow;\n    },\n    () => {\n      if (unlistenLoad) {\n        unlistenLoad();\n      }\n      failedToLoad(eleOrWindow);\n    }\n  );\n}\n\n/**\n * Emit error on load failure.\n * @param {!Element|!Window} eleOrWindow Supports both Elements and as a special\n *     case Windows.\n */\nfunction failedToLoad(eleOrWindow) {\n  // Mark the element as errored since some elements - like HTMLMediaElement\n  // using HTMLSourceElement - do not provide any synchronous way to verify if\n  // they already errored, even though the error event was already dispatched.\n  if (isHTMLMediaElement(eleOrWindow)) {\n    eleOrWindow[MEDIA_LOAD_FAILURE_SRC_PROPERTY] =\n      eleOrWindow.currentSrc || true;\n  }\n\n  // Report failed loads as user errors so that they automatically go\n  // into the \"document error\" bucket.\n  let target = eleOrWindow;\n  if (target && target.src) {\n    target = target.src;\n  }\n  throw user().createError(LOAD_FAILURE_PREFIX, target);\n}\n\n/**\n * Returns true if the parameter is a HTMLMediaElement.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nfunction isHTMLMediaElement(eleOrWindow) {\n  return eleOrWindow.tagName === 'AUDIO' || eleOrWindow.tagName === 'VIDEO';\n}\n\n/**\n * Returns true if this error message is was created for a load error.\n * @param {string} message An error message\n * @return {boolean}\n */\nexport function isLoadErrorMessage(message) {\n  return message.indexOf(LOAD_FAILURE_PREFIX) != -1;\n}\n", "import {Deferred} from '#core/data-structures/promise';\n\nimport {Services} from '#service';\n\n/** @type {!WeakMap<!../../../src/service/ampdoc-impl.AmpDoc, !Promise>} */\nconst polyfillPromiseMap = new WeakMap();\n\n/**\n * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n * @return {Promise<void>}\n */\nexport function installWebAnimationsIfNecessary(ampdoc) {\n  if (polyfillPromiseMap.has(ampdoc)) {\n    return polyfillPromiseMap.get(ampdoc);\n  }\n\n  const {promise, resolve} = new Deferred();\n  polyfillPromiseMap.set(ampdoc, promise);\n\n  const {win} = ampdoc;\n  const platform = Services.platformFor(win);\n  if (platform.isSafari() && platform.getMajorVersion() < 14) {\n    /*\n      Force Web Animations polyfill on Safari versions before 14.\n      Native Web Animations on WebKit did not respect easing for individual\n      keyframes and break overall timing. See https://go.amp.dev/issue/27762 and\n      https://bugs.webkit.org/show_bug.cgi?id=210526\n      */\n    // Using string access syntax to bypass typecheck.\n    win.Element.prototype['animate'] = null;\n  }\n\n  if (win.Element.prototype['animate']) {\n    // Native Support exists, there is no reason to load the polyfill.\n    resolve();\n    return promise;\n  }\n\n  resolve(\n    Services.extensionsFor(win).installExtensionForDoc(\n      ampdoc,\n      'amp-animation-polyfill'\n    )\n  );\n\n  return promise;\n}\n", "// WARNING\n// WARNING\n// WARNING\n// WARNING\n// File must be synced with amp.extens.js\n\n/**\n * A struct for parameters for `Element.animate` call.\n * See https://developer.mozilla.org/en-US/docs/Web/API/Element/animate\n *\n * @typedef {{\n *   target: !Element,\n *   keyframes: !WebKeyframesDef,\n *   vars: ?Object<string, *>,\n *   timing: !WebAnimationTimingDef,\n * }}\n */\nexport let InternalWebAnimationRequestDef;\n\n/**\n * @typedef {\n *   !WebMultiAnimationDef|\n *   !WebSwitchAnimationDef|\n *   !WebCompAnimationDef|\n *   !WebKeyframeAnimationDef\n * }\n */\nexport let WebAnimationDef;\n\n/**\n * @mixes WebAnimationSelectorDef\n * @mixes WebAnimationTimingDef\n * @mixes WebAnimationVarsDef\n * @mixes WebAnimationConditionalDef\n * @typedef {{\n *   animations: !Array<!WebAnimationDef>,\n * }}\n */\nexport let WebMultiAnimationDef;\n\n/**\n * @mixes WebAnimationSelectorDef\n * @mixes WebAnimationTimingDef\n * @mixes WebAnimationVarsDef\n * @mixes WebAnimationConditionalDef\n * @typedef {{\n *   switch: !Array<!WebAnimationDef>,\n * }}\n */\nexport let WebSwitchAnimationDef;\n\n/**\n * @mixes WebAnimationSelectorDef\n * @mixes WebAnimationTimingDef\n * @mixes WebAnimationVarsDef\n * @mixes WebAnimationConditionalDef\n * @typedef {{\n *   animation: string,\n * }}\n */\nexport let WebCompAnimationDef;\n\n/**\n * @mixes WebAnimationSelectorDef\n * @mixes WebAnimationTimingDef\n * @mixes WebAnimationVarsDef\n * @mixes WebAnimationConditionalDef\n * @typedef {{\n *   keyframes: (string|!WebKeyframesDef),\n * }}\n */\nexport let WebKeyframeAnimationDef;\n\n/**\n * @typedef {!Object<string, *>|!Array<!Object<string, *>>}\n */\nexport let WebKeyframesDef;\n\n/**\n * See https://developer.mozilla.org/en-US/docs/Web/API/AnimationEffectTimingProperties\n *\n * @mixin\n * @typedef {{\n *   duration: (time|undefined),\n *   delay: (time|undefined),\n *   endDelay: (time|undefined),\n *   iterations: (number|string|undefined),\n *   iterationStart: (number|undefined),\n *   easing: (string|undefined),\n *   direction: (!WebAnimationTimingDirection|undefined),\n *   fill: (!WebAnimationTimingFill|undefined),\n * }}\n */\nexport let WebAnimationTimingDef;\n\n/**\n * Indicates an extension to a type that allows specifying vars. Vars are\n * specified as properties with the name in the format of `--varName`.\n *\n * @mixin\n * @typedef {Object}\n */\nexport let WebAnimationVarsDef;\n\n/**\n * Defines media parameters for an animation.\n *\n * @mixin\n * @typedef {{\n *   media: (string|undefined),\n *   supports: (string|undefined),\n * }}\n */\nexport let WebAnimationConditionalDef;\n\n/**\n * @typedef {{\n *   target: (!Element|undefined),\n *   selector: (string|undefined),\n *   subtargets: (!Array<!WebAnimationSubtargetDef>|undefined),\n * }}\n */\nexport let WebAnimationSelectorDef;\n\n/**\n * @mixes WebAnimationTimingDef\n * @mixes WebAnimationVarsDef\n * @typedef {{\n *   matcher: (function(!Element, number):boolean|undefined),\n *   index: (number|undefined),\n *   selector: (string|undefined),\n * }}\n */\nexport let WebAnimationSubtargetDef;\n\n/**\n * @typedef {{\n *   scope: (!Element|undefined),\n *   scaleByScope: (boolean|undefined),\n * }}\n *\n * - scope delimits selectors.\n * - scaleByScope determines that CSS resolution should treat the scope\n *   element as a virtual viewport, so that:\n *   1. vw/vh units are relative to the scope's size\n *   2. element's x() and y() coords are relative to the scope's top-left corner\n *   3. element's size and position (width()/height()/x()/y()) are inversely\n *      relative to the scope's transformed scale, e.g. if the scope is scaled\n *      to 90%, the element's dimensions will be returned as if it was unscaled\n *      to 100%.\n */\nexport let WebAnimationBuilderOptionsDef;\n\n/**\n * See https://developer.mozilla.org/en-US/docs/Web/API/Animation/playState\n * @enum {string}\n */\nexport const WebAnimationPlayState = {\n  IDLE: 'idle',\n  PENDING: 'pending',\n  RUNNING: 'running',\n  PAUSED: 'paused',\n  FINISHED: 'finished',\n};\n\n/**\n * See https://developer.mozilla.org/en-US/docs/Web/API/AnimationEffectTimingProperties/direction\n * @enum {string}\n */\nexport const WebAnimationTimingDirection = {\n  NORMAL: 'normal',\n  REVERSE: 'reverse',\n  ALTERNATE: 'alternate',\n  ALTERNATE_REVERSE: 'alternate-reverse',\n};\n\n/**\n * See https://developer.mozilla.org/en-US/docs/Web/API/AnimationEffectTimingProperties/fill\n * @enum {string}\n */\nexport const WebAnimationTimingFill = {\n  NONE: 'none',\n  FORWARDS: 'forwards',\n  BACKWARDS: 'backwards',\n  BOTH: 'both',\n  AUTO: 'auto',\n};\n\n/** @const {!Object<string, boolean>} */\nconst ALLOWLISTED_PROPS = {\n  'opacity': true,\n  'transform': true,\n  'transform-origin': true,\n  'visibility': true,\n  'offset-distance': true,\n  'offsetDistance': true,\n  'clip-path': true,\n  'clipPath': true,\n};\n\n/**\n * @param {string} prop\n * @return {boolean}\n */\nexport function isAllowlistedProp(prop) {\n  return ALLOWLISTED_PROPS[prop] || false;\n}\n", "/**\n * TODO(rcebulko): Migrate the actual ViewportInterface into core or an extern.\n * @typedef {{\n *   getHeight: function(this:ViewportInterfaceDef):number,\n *   getWidth: function(this:ViewportInterfaceDef):number,\n * }}\n */\nlet ViewportInterfaceDef;\n\n/**\n * The structure that combines position and size for an element. The exact\n * interpretation of position and size depends on the use case.\n *\n * @typedef {{\n *   top: number,\n *   bottom: number,\n *   left: number,\n *   right: number,\n *   width: number,\n *   height: number,\n *   x: number,\n *   y: number\n * }}\n */\nexport let LayoutRectDef;\n\n/**\n * The structure that contains the size for an element. The exact\n * interpretation of the size depends on the use case.\n *\n * @typedef {{\n *   width: number,\n *   height: number,\n * }}\n */\nexport let LayoutSizeDef;\n\n/**\n * The structure that represents the margins of an Element.\n *\n * @typedef {{\n *   top: number,\n *   right: number,\n *   bottom: number,\n *   left: number\n * }}\n */\nexport let LayoutMarginsDef;\n\n/**\n * The structure that represents a requested change to the margins of an\n * Element. Any new values specified will replace existing ones (rather than\n * being additive).\n *\n * @typedef {{\n *   top: (number|undefined),\n *   right: (number|undefined),\n *   bottom: (number|undefined),\n *   left: (number|undefined)\n * }}\n */\nexport let LayoutMarginsChangeDef;\n\n/**\n * RelativePositions\n *\n * Describes the relative position of an element to another (whether the\n * first is inside the second, on top of the second or on the bottom\n * @enum {string}\n */\nexport const RelativePositions = {\n  INSIDE: 'inside',\n  TOP: 'top',\n  BOTTOM: 'bottom',\n};\n\n/**\n * Creates a layout rect based on the left, top, width and height parameters\n * in that order.\n * @param {number} left\n * @param {number} top\n * @param {number} width\n * @param {number} height\n * @return {!LayoutRectDef}\n */\nexport function layoutRectLtwh(left, top, width, height) {\n  return {\n    left,\n    top,\n    width,\n    height,\n    bottom: top + height,\n    right: left + width,\n    x: left,\n    y: top,\n  };\n}\n\n/**\n * Creates a layout rect based on the DOMRect, e.g. obtained from calling\n * getBoundingClientRect.\n * @param {!ClientRect} rect\n * @return {!LayoutRectDef}\n */\nexport function layoutRectFromDomRect(rect) {\n  return layoutRectLtwh(\n    Number(rect.left),\n    Number(rect.top),\n    Number(rect.width),\n    Number(rect.height)\n  );\n}\n\n/**\n * Returns true if the specified two rects overlap by a single pixel.\n * @param {!LayoutRectDef|!ClientRect} r1\n * @param {!LayoutRectDef|!ClientRect} r2\n * @return {boolean}\n */\nexport function rectsOverlap(r1, r2) {\n  return (\n    r1.top <= r2.bottom &&\n    r2.top <= r1.bottom &&\n    r1.left <= r2.right &&\n    r2.left <= r1.right\n  );\n}\n\n/**\n * Returns the intersection between a, b or null if there is none.\n * @param {...?LayoutRectDef|undefined} var_args\n * @return {?LayoutRectDef}\n */\nexport function rectIntersection(var_args) {\n  let x0 = -Infinity;\n  let x1 = Infinity;\n  let y0 = -Infinity;\n  let y1 = Infinity;\n  for (let i = 0; i < arguments.length; i++) {\n    const current = arguments[i];\n    if (!current) {\n      continue;\n    }\n    x0 = Math.max(x0, current.left);\n    x1 = Math.min(x1, current.left + current.width);\n    y0 = Math.max(y0, current.top);\n    y1 = Math.min(y1, current.top + current.height);\n    if (x1 < x0 || y1 < y0) {\n      return null;\n    }\n  }\n  if (x1 == Infinity) {\n    return null;\n  }\n  return layoutRectLtwh(x0, y0, x1 - x0, y1 - y0);\n}\n\n/**\n * Returns the position of r2 relative to r1\n * @param {!LayoutRectDef} r1\n * @param {!LayoutRectDef} r2\n * @return {!RelativePositions}\n */\nexport function layoutRectsRelativePos(r1, r2) {\n  if (r1.top < r2.top) {\n    return RelativePositions.TOP;\n  } else if (r1.bottom > r2.bottom) {\n    return RelativePositions.BOTTOM;\n  } else {\n    return RelativePositions.INSIDE;\n  }\n}\n\n/**\n * Determines if any portion of a layoutBox would be onscreen in the given\n * viewport, when scrolled to the specified position.\n * @param {!LayoutRectDef} layoutBox\n * @param {!ViewportInterfaceDef} viewport\n * @param {number} scrollPos\n * @return {!RelativePositions}\n */\nexport function layoutPositionRelativeToScrolledViewport(\n  layoutBox,\n  viewport,\n  scrollPos\n) {\n  const scrollLayoutBox = layoutRectFromDomRect(\n    /** @type {!ClientRect} */ ({\n      top: scrollPos,\n      bottom: scrollPos + viewport.getHeight(),\n      left: 0,\n      right: viewport.getWidth(),\n    })\n  );\n  if (rectsOverlap(layoutBox, scrollLayoutBox)) {\n    return RelativePositions.INSIDE;\n  } else {\n    return layoutRectsRelativePos(layoutBox, scrollLayoutBox);\n  }\n}\n\n/**\n * Expand the layout rect using multiples of width and height.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dw Expansion in width, specified as a multiple of width.\n * @param {number} dh Expansion in height, specified as a multiple of height.\n * @return {!LayoutRectDef}\n */\nexport function expandLayoutRect(rect, dw, dh) {\n  return layoutRectLtwh(\n    rect.left - rect.width * dw,\n    rect.top - rect.height * dh,\n    rect.width * (1 + dw * 2),\n    rect.height * (1 + dh * 2)\n  );\n}\n\n/**\n * Moves the layout rect using dx and dy.\n * @param {!LayoutRectDef} rect Original rect.\n * @param {number} dx Move horizontally with this value.\n * @param {number} dy Move vertically with this value.\n * @return {!LayoutRectDef}\n */\nexport function moveLayoutRect(rect, dx, dy) {\n  if ((dx == 0 && dy == 0) || (rect.width == 0 && rect.height == 0)) {\n    return rect;\n  }\n  return layoutRectLtwh(rect.left + dx, rect.top + dy, rect.width, rect.height);\n}\n\n/**\n * @param {!LayoutMarginsDef} margins\n * @param {!LayoutMarginsChangeDef} change\n * @return {boolean}\n */\nexport function areMarginsChanged(margins, change) {\n  return (\n    (change.top !== undefined && change.top != margins.top) ||\n    (change.right !== undefined && change.right != margins.right) ||\n    (change.bottom !== undefined && change.bottom != margins.bottom) ||\n    (change.left !== undefined && change.left != margins.left)\n  );\n}\n\n/**\n * @param {!LayoutRectDef} from\n * @param {!LayoutRectDef} to\n * @return {boolean}\n */\nexport function layoutRectSizeEquals(from, to) {\n  return from.width == to.width && from.height === to.height;\n}\n\n/**\n * @param {?LayoutRectDef} r1\n * @param {?LayoutRectDef} r2\n * @return {boolean}\n */\nexport function layoutRectEquals(r1, r2) {\n  if (!r1 || !r2) {\n    return false;\n  }\n  return (\n    r1.left == r2.left &&\n    r1.top == r2.top &&\n    r1.width == r2.width &&\n    r1.height == r2.height\n  );\n}\n\n/**\n * @param {LayoutMarginsChangeDef|undefined} marginsChange\n * @return {LayoutMarginsChangeDef|undefined}\n */\nexport function cloneLayoutMarginsChangeDef(marginsChange) {\n  if (!marginsChange) {\n    return marginsChange;\n  }\n  return {\n    top: marginsChange.top,\n    bottom: marginsChange.bottom,\n    left: marginsChange.left,\n    right: marginsChange.right,\n  };\n}\n\n/**\n * @param {!LayoutRectDef|!ClientRect|!DOMRect} rect\n * @return {!LayoutSizeDef}\n */\nexport function layoutSizeFromRect(rect) {\n  const {height, width} = rect;\n  return {width, height};\n}\n", "/**\n * @fileoverview Experiments system allows a developer to opt-in to test\n * features that are not yet fully tested.\n *\n * Experiments page: https://cdn.ampproject.org/experiments.html *\n */\n\nimport {isArray} from '#core/types';\nimport {hasOwn, map} from '#core/types/object';\nimport {parseJson} from '#core/types/object/json';\nimport {parseQueryString} from '#core/types/string/url';\n\nimport {dev, user} from '#utils/log';\n\nimport {ExperimentInfoDef} from './experiments.type';\n\nimport {getMode} from '../mode';\nimport {getTopWindow} from '../service-helpers';\n\n/** @const {string} */\nconst TAG = 'EXPERIMENTS';\n\n/** @const {string} */\nconst LOCAL_STORAGE_KEY = 'amp-experiment-toggles';\n\n/** @const {string} */\nconst TOGGLES_WINDOW_PROPERTY = '__AMP__EXPERIMENT_TOGGLES';\n\n/**\n * Whether we are in canary.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isCanary(win) {\n  return !!win.AMP_CONFIG?.canary;\n}\n\n/**\n * Returns binary type, e.g., canary, production, control, or rc.\n * @param {!Window} win\n * @return {string}\n */\nexport function getBinaryType(win) {\n  return win.AMP_CONFIG?.type || 'unknown';\n}\n\n/**\n * Whether the specified experiment is on or off.\n * @param {!Window} win\n * @param {string} experimentId\n * @return {boolean}\n */\nexport function isExperimentOn(win, experimentId) {\n  const toggles = experimentToggles(win);\n  return !!toggles[experimentId];\n}\n\n/**\n * Toggles the experiment on or off. Returns the actual value of the experiment\n * after toggling is done.\n * @param {!Window} win\n * @param {string} experimentId\n * @param {boolean=} opt_on\n * @param {boolean=} opt_transientExperiment  Whether to toggle the\n *     experiment state \"transiently\" (i.e., for this page load only) or\n *     durably (by saving the experiment IDs after toggling).\n *     Default: false (save durably).\n * @return {boolean} New state for experimentId.\n */\nexport function toggleExperiment(\n  win,\n  experimentId,\n  opt_on,\n  opt_transientExperiment\n) {\n  const currentlyOn = isExperimentOn(win, /*OK*/ experimentId);\n  const on = opt_on ?? !currentlyOn;\n  if (on != currentlyOn) {\n    const toggles = experimentToggles(win);\n    toggles[experimentId] = on;\n\n    if (!opt_transientExperiment) {\n      const storedToggles = getExperimentToggles(win);\n      storedToggles[experimentId] = on;\n      saveExperimentToggles(win, storedToggles);\n      // Avoid affecting tests that spy/stub warn().\n      if (!getMode().test) {\n        user().warn(\n          TAG,\n          '\"%s\" experiment %s for the domain \"%s\". See: https://amp.dev/documentation/guides-and-tutorials/learn/experimental',\n          experimentId,\n          on ? 'enabled' : 'disabled',\n          win.location.hostname\n        );\n      }\n    }\n  }\n  return on;\n}\n\n/**\n * Calculate whether the experiment is on or off based off of its default value,\n * stored overriden value, or the global config frequency given.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nexport function experimentToggles(win) {\n  if (win[TOGGLES_WINDOW_PROPERTY]) {\n    return win[TOGGLES_WINDOW_PROPERTY];\n  }\n  win[TOGGLES_WINDOW_PROPERTY] = map();\n  const toggles = win[TOGGLES_WINDOW_PROPERTY];\n\n  // Read default and injected configs of this build.\n  const buildExperimentConfigs = {\n    ...(win.AMP_CONFIG ?? {}),\n    ...(win.AMP_EXP ?? parseJson(win.__AMP_EXP?.textContent || '{}')),\n  };\n  for (const experimentId in buildExperimentConfigs) {\n    const frequency = buildExperimentConfigs[experimentId];\n    if (typeof frequency === 'number' && frequency >= 0 && frequency <= 1) {\n      toggles[experimentId] = Math.random() < frequency;\n    }\n  }\n  // Read document level override from meta tag.\n  const allowedDocOptIn = win.AMP_CONFIG?.['allow-doc-opt-in'];\n  if (isArray(allowedDocOptIn) && allowedDocOptIn.length) {\n    const meta = win.document.head.querySelector(\n      'meta[name=\"amp-experiments-opt-in\"]'\n    );\n    if (meta) {\n      const optedInExperiments = meta.getAttribute('content').split(',');\n      for (const experiment of optedInExperiments) {\n        if (dev().assertArray(allowedDocOptIn).includes(experiment)) {\n          toggles[experiment] = true;\n        }\n      }\n    }\n  }\n\n  Object.assign(toggles, getExperimentToggles(win));\n\n  const allowedUrlOptIn = win.AMP_CONFIG?.['allow-url-opt-in'];\n  if (isArray(allowedUrlOptIn) && allowedUrlOptIn.length) {\n    const hash = win.location['originalHash'] || win.location.hash;\n    const params = parseQueryString(hash);\n    for (const experiment of allowedUrlOptIn) {\n      const param = params[`e-${experiment}`];\n      if (param == '1') {\n        toggles[experiment] = true;\n      }\n      if (param == '0') {\n        toggles[experiment] = false;\n      }\n    }\n  }\n  return toggles;\n}\n\n/**\n * Returns the cached experiments toggles, or null if they have not been\n * computed yet.\n * @param {!Window} win\n * @return {?Object<string, boolean>}\n */\nexport function experimentTogglesOrNull(win) {\n  return win[TOGGLES_WINDOW_PROPERTY] || null;\n}\n\n/**\n * Returns a set of experiment IDs currently on.\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n */\nfunction getExperimentToggles(win) {\n  let experimentsString = '';\n  try {\n    if ('localStorage' in win) {\n      experimentsString = win.localStorage.getItem(LOCAL_STORAGE_KEY);\n    }\n  } catch {\n    dev().warn(TAG, 'Failed to retrieve experiments from localStorage.');\n  }\n  const tokens = experimentsString?.split(/\\s*,\\s*/g) || [];\n\n  const toggles = map();\n  for (const token of tokens) {\n    if (!token) {\n      continue;\n    }\n    if (token[0] == '-') {\n      toggles[token.substr(1)] = false;\n    } else {\n      toggles[token] = true;\n    }\n  }\n  return toggles;\n}\n\n/**\n * Saves a set of experiment IDs currently on.\n * @param {!Window} win\n * @param {!Object<string, boolean>} toggles\n */\nfunction saveExperimentToggles(win, toggles) {\n  const experimentIds = [];\n  for (const experiment in toggles) {\n    experimentIds.push((toggles[experiment] === false ? '-' : '') + experiment);\n  }\n  try {\n    win.localStorage?.setItem(LOCAL_STORAGE_KEY, experimentIds.join(','));\n  } catch (e) {\n    user().error(TAG, 'Failed to save experiments to localStorage.');\n  }\n}\n\n/**\n * See getExperimentToggles().\n * @param {!Window} win\n * @return {!Object<string, boolean>}\n * @visibleForTesting\n */\nexport function getExperimentTogglesForTesting(win) {\n  return getExperimentToggles(win);\n}\n\n/**\n * Resets the experimentsToggle cache for testing purposes.\n * @param {!Window} win\n * @visibleForTesting\n */\nexport function resetExperimentTogglesForTesting(win) {\n  saveExperimentToggles(win, {});\n  win[TOGGLES_WINDOW_PROPERTY] = null;\n}\n\n/**\n * In some browser implementations of Math.random(), sequential calls of\n * Math.random() are correlated and can cause a bias.  In particular,\n * if the previous random() call was < 0.001 (as it will be if we select\n * into an experiment), the next value could be less than 0.5 more than\n * 50.7% of the time.  This provides an implementation that roots down into\n * the crypto API, when available, to produce less biased samples.\n *\n * @return {number} Pseudo-random floating-point value on the range [0, 1).\n */\nfunction slowButAccuratePrng() {\n  // TODO(tdrl): Implement.\n  return Math.random();\n}\n\n/**\n * Container for alternate random number generator implementations.  This\n * allows us to set an \"accurate\" PRNG for branch selection, but to mock it\n * out easily in tests.\n *\n * @visibleForTesting\n * @const {!{accuratePrng: function():number}}\n */\nexport const RANDOM_NUMBER_GENERATORS = {\n  accuratePrng: slowButAccuratePrng,\n};\n\n/**\n * Selects, uniformly at random, a single item from the array.\n * @param {!Array<string>} arr Object to select from.\n * @return {?string} Single item from arr or null if arr was empty.\n */\nfunction selectRandomItem(arr) {\n  const rn = RANDOM_NUMBER_GENERATORS.accuratePrng();\n  return dev().assertString(arr[Math.floor(rn * arr.length)]) || null;\n}\n\n/**\n * Selects which page-level experiment branches are enabled. If a given\n * experiment name is already set (including to the null / no branches selected\n * state), this won't alter its state.\n *\n * Check whether a given experiment is set using isExperimentOn(win,\n * experimentName) and, if it is on, look for which branch is selected in\n * win.__AMP_EXPERIMENT_BRANCHES[experimentName].\n *\n * @param {!Window} win Window context on which to save experiment\n *     selection state.\n * @param {!Array<!ExperimentInfoDef>} experiments  Set of experiments to\n *     configure for this page load.\n * @return {!Object<string, string>} Map of experiment names to selected\n *     branches.\n */\nexport function randomlySelectUnsetExperiments(win, experiments) {\n  win.__AMP_EXPERIMENT_BRANCHES = win.__AMP_EXPERIMENT_BRANCHES || {};\n  const selectedExperiments = {};\n  for (const experiment of experiments) {\n    const experimentName = experiment.experimentId;\n    if (hasOwn(win.__AMP_EXPERIMENT_BRANCHES, experimentName)) {\n      selectedExperiments[experimentName] =\n        win.__AMP_EXPERIMENT_BRANCHES[experimentName];\n      continue;\n    }\n\n    if (!experiment.isTrafficEligible?.(win)) {\n      win.__AMP_EXPERIMENT_BRANCHES[experimentName] = null;\n      continue;\n    }\n\n    // If we're in the experiment, but we haven't already forced a specific\n    // experiment branch (e.g., via a test setup), then randomize the branch\n    // choice.\n    if (\n      !win.__AMP_EXPERIMENT_BRANCHES[experimentName] &&\n      isExperimentOn(win, /*OK*/ experimentName)\n    ) {\n      win.__AMP_EXPERIMENT_BRANCHES[experimentName] = selectRandomItem(\n        experiment.branches\n      );\n      selectedExperiments[experimentName] =\n        win.__AMP_EXPERIMENT_BRANCHES[experimentName];\n    }\n  }\n  return selectedExperiments;\n}\n\n/**\n * Returns the experiment branch enabled for the given experiment ID.\n * For example, 'control' or 'experiment'.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @return {?string} Active experiment branch ID for experimentName (possibly\n *     null if experimentName has been tested but no branch was enabled).\n */\nexport function getExperimentBranch(win, experimentName) {\n  return win.__AMP_EXPERIMENT_BRANCHES\n    ? win.__AMP_EXPERIMENT_BRANCHES[experimentName]\n    : null;\n}\n\n/**\n * Returns an object containing all active experiment branches on the\n * top Window.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @return {!Object} contains all experiment branches and their ids.\n */\nexport function getActiveExperimentBranches(win) {\n  const topWin = getTopWindow(win);\n  if (!topWin.__AMP_EXPERIMENT_BRANCHES) {\n    topWin.__AMP_EXPERIMENT_BRANCHES = {};\n  }\n  return {...topWin.__AMP_EXPERIMENT_BRANCHES};\n}\n\n/**\n * Force enable (or disable) a specific branch of a given experiment name.\n * Disables the experiment name altogether if branchId is falseish.\n *\n * @param {!Window} win Window context to check for experiment state.\n * @param {string} experimentName Name of the experiment to check.\n * @param {?string} branchId ID of branch to force or null to disable\n *     altogether.\n * @visibleForTesting\n */\nexport function forceExperimentBranch(win, experimentName, branchId) {\n  win.__AMP_EXPERIMENT_BRANCHES = win.__AMP_EXPERIMENT_BRANCHES || {};\n  toggleExperiment(win, experimentName, !!branchId, true);\n  win.__AMP_EXPERIMENT_BRANCHES[experimentName] = branchId;\n}\n", "const FINAL_URL_RE = /^(data|https)\\:/i;\nconst DEG_TO_RAD = (2 * Math.PI) / 360;\nconst GRAD_TO_RAD = Math.PI / 200;\nconst VAR_CSS_RE =\n  /\\b(calc|min|max|clamp|var|url|rand|index|width|height|num|length|x|y)\\(/i;\nconst NORM_CSS_RE = /\\d(%|em|rem|vw|vh|vmin|vmax|s|deg|grad)/i;\nconst INFINITY_RE = /^(infinity|infinite)$/i;\nconst BOX_DIMENSIONS = ['h', 'w', 'h', 'w'];\nconst TUPLE_DIMENSIONS = ['w', 'h'];\n\n/**\n * Returns `true` if the CSS expression contains variable components. The CSS\n * parsing and evaluation is heavy, but used relatively rarely. This method\n * can be used to avoid heavy parse/evaluate tasks.\n * @param {string} css\n * @param {boolean} normalize\n * @return {boolean}\n */\nexport function isVarCss(css, normalize) {\n  return VAR_CSS_RE.test(css) || (normalize && NORM_CSS_RE.test(css));\n}\n\n/**\n * An interface that assists in CSS evaluation.\n * @interface\n */\nexport class CssContext {\n  /**\n   * Returns a resolved URL. The result must be an allowed URL for execution,\n   * with HTTPS restrictions.\n   * @param {string} unusedUrl\n   * @return {string}\n   */\n  resolveUrl(unusedUrl) {}\n\n  /**\n   * Returns the value of a CSS variable or `null` if not available.\n   * @param {string} unusedVarName\n   * @return {?CssNode}\n   */\n  getVar(unusedVarName) {}\n\n  /**\n   * Returns the current target's index in the context of other selected\n   * targets.\n   * @return {number}\n   */\n  getCurrentIndex() {}\n\n  /**\n   * Returns the number of selected targets.\n   * @return {number}\n   */\n  getTargetLength() {}\n\n  /**\n   * Returns the current font size.\n   * @return {number}\n   */\n  getCurrentFontSize() {}\n\n  /**\n   * Returns the root font size.\n   * @return {number}\n   */\n  getRootFontSize() {}\n\n  /**\n   * Returns the viewport size.\n   * @return {!{width: number, height: number}}\n   */\n  getViewportSize() {}\n\n  /**\n   * Returns the current element's rectangle.\n   * @return {!../../../../src/layout-rect.LayoutRectDef}\n   */\n  getCurrentElementRect() {}\n\n  /**\n   * Returns the specified element's rectangle.\n   * @param {string} unusedSelector\n   * @param {?string} unusedSelectionMethod\n   * @return {!../../../../src/layout-rect.LayoutRectDef}\n   */\n  getElementRect(unusedSelector, unusedSelectionMethod) {}\n\n  /**\n   * Returns the dimension: \"w\" for width or \"h\" for height.\n   * @return {?string}\n   */\n  getDimension() {}\n\n  /**\n   * Pushes the dimension: \"w\" for width or \"h\" for height.\n   * @param {?string} unusedDim\n   * @param {function():T} unusedCallback\n   * @return {T}\n   * @template T\n   */\n  withDimension(unusedDim, unusedCallback) {}\n}\n\n/**\n * A base class for all CSS node components defined in the\n * `css-expr-impl.jison`.\n * @abstract\n */\nexport class CssNode {\n  /**\n   * Creates an instance of CssNode.\n   */\n  constructor() {}\n\n  /**\n   * Returns a string CSS representation.\n   * @return {string}\n   * @abstract\n   */\n  css() {}\n\n  /**\n   * Resolves the value of all variable components. Only performs any work if\n   * variable components exist. As an optimization, this node is returned\n   * for a non-variable nodes (`isConst() == true`). Otherwise, `calc()` method\n   * is used to calculate the new value.\n   * @param {!CssContext} context\n   * @param {boolean} normalize\n   * @return {?CssNode}\n   * @final\n   */\n  resolve(context, normalize) {\n    if (this.isConst(normalize)) {\n      return this;\n    }\n    return this.calc(context, normalize);\n  }\n\n  /**\n   * Whether the CSS node is a constant or includes variable components.\n   * @param {boolean} unusedNormalize\n   * @return {boolean}\n   * @protected\n   */\n  isConst(unusedNormalize) {\n    return true;\n  }\n\n  /**\n   * Calculates the value of all variable components.\n   * @param {!CssContext} unusedContext\n   * @param {boolean} unusedNormalize\n   * @return {?CssNode}\n   * @protected\n   */\n  calc(unusedContext, unusedNormalize) {\n    return this;\n  }\n}\n\n/**\n * A CSS expression that's simply passed through from the original expression.\n * Used for `url()`, colors, etc.\n */\nexport class CssPassthroughNode extends CssNode {\n  /** @param {string} css */\n  constructor(css) {\n    super();\n    /** @const @private {string} */\n    this.css_ = css;\n  }\n\n  /** @override */\n  css() {\n    return this.css_;\n  }\n}\n\n/**\n * A concatenation of CSS expressions: `translateX(...) rotate(...)`,\n * `1s normal`, etc.\n */\nexport class CssConcatNode extends CssNode {\n  /**\n   * @param {(!Array<!CssNode>|!CssNode)=} opt_array\n   * @param {?Array<string>=} opt_dimensions\n   */\n  constructor(opt_array, opt_dimensions) {\n    super();\n\n    /** @private {!Array<!CssNode>} */\n    this.array_ =\n      opt_array instanceof CssConcatNode\n        ? opt_array.array_\n        : Array.isArray(opt_array)\n        ? opt_array\n        : opt_array\n        ? [opt_array]\n        : [];\n    /** @const @private {?Array<string>} */\n    this.dimensions_ = opt_dimensions || null;\n  }\n\n  /**\n   * Concatenates two sets of expressions.\n   * @param {!CssNode} nodeOrSet\n   * @param {!CssNode} otherNodeOrSet\n   * @return {!CssConcatNode}\n   */\n  static concat(nodeOrSet, otherNodeOrSet) {\n    let set;\n    if (nodeOrSet instanceof CssConcatNode) {\n      set = nodeOrSet;\n    } else {\n      set = new CssConcatNode([nodeOrSet]);\n    }\n    if (otherNodeOrSet instanceof CssConcatNode) {\n      set.array_ = set.array_.concat(otherNodeOrSet.array_);\n    } else {\n      set.array_.push(otherNodeOrSet);\n    }\n    return set;\n  }\n\n  /** @override */\n  css() {\n    return this.array_.map((node) => node.css()).join(' ');\n  }\n\n  /** @override */\n  isConst(normalize) {\n    return this.array_.reduce(\n      (acc, node) => acc && node.isConst(normalize),\n      true\n    );\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    const resolvedArray = resolveArray(\n      context,\n      normalize,\n      this.array_,\n      this.dimensions_\n    );\n    return resolvedArray ? new CssConcatNode(resolvedArray) : null;\n  }\n}\n\n/**\n * Verifies that URL is an HTTPS URL.\n */\nexport class CssUrlNode extends CssNode {\n  /** @param {string} url */\n  constructor(url) {\n    super();\n    /** @const @private {string} */\n    this.url_ = url;\n  }\n\n  /** @override */\n  css() {\n    if (!this.url_) {\n      return '';\n    }\n    return `url(\"${this.url_}\")`;\n  }\n\n  /** @override */\n  isConst() {\n    return !this.url_ || FINAL_URL_RE.test(this.url_);\n  }\n\n  /** @override */\n  calc(context) {\n    const url = context.resolveUrl(this.url_);\n    // Return a passthrough CSS to avoid recursive `url()` evaluation.\n    return new CssPassthroughNode(`url(\"${url}\")`);\n  }\n}\n\n/**\n * @abstract\n */\nexport class CssNumericNode extends CssNode {\n  /**\n   * @param {string} type\n   * @param {number} num\n   * @param {string} units\n   */\n  constructor(type, num, units) {\n    super();\n    /** @const @private {string} */\n    this.type_ = type;\n    /** @const @private {number} */\n    this.num_ = num;\n    /** @const @private {string} */\n    this.units_ = units.toLowerCase();\n  }\n\n  /** @override */\n  css() {\n    return `${this.num_}${this.units_}`;\n  }\n\n  /**\n   * @param {number} unusedNum\n   * @return {!CssNumericNode}\n   * @abstract\n   */\n  createSameUnits(unusedNum) {}\n\n  /** @override */\n  isConst(normalize) {\n    return normalize ? this.isNorm() : true;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isNorm() {\n    return true;\n  }\n\n  /**\n   * @param {!CssContext} unusedContext\n   * @return {!CssNumericNode}\n   */\n  norm(unusedContext) {\n    return this;\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    return normalize ? this.norm(context) : this;\n  }\n\n  /**\n   * @param {number} unusedPercent\n   * @param {!CssContext} unusedContext\n   * @return {!CssNumericNode}\n   */\n  calcPercent(unusedPercent, unusedContext) {\n    throw new Error('cannot calculate percent for ' + this.type_);\n  }\n}\n\n/**\n * A CSS number: `100`, `1e2`, `1e-2`, `0.5`, etc.\n */\nexport class CssNumberNode extends CssNumericNode {\n  /** @param {number} num */\n  constructor(num) {\n    super('NUM', num, '');\n  }\n\n  /** @override */\n  createSameUnits(num) {\n    return new CssNumberNode(num);\n  }\n\n  /**\n   * Returns a numerical value of the node if possible. `Infinity` is one of\n   * possible return values.\n   * @param {!CssNode} node\n   * @return {number|undefined}\n   */\n  static num(node) {\n    if (node instanceof CssNumberNode) {\n      return node.num_;\n    }\n    const css = node.css();\n    if (INFINITY_RE.test(css)) {\n      return Infinity;\n    }\n    return undefined;\n  }\n}\n\n/**\n * A CSS percent value: `100%`, `0.5%`, etc.\n */\nexport class CssPercentNode extends CssNumericNode {\n  /** @param {number} num */\n  constructor(num) {\n    super('PRC', num, '%');\n  }\n\n  /** @override */\n  createSameUnits(num) {\n    return new CssPercentNode(num);\n  }\n\n  /** @override */\n  isNorm() {\n    return false;\n  }\n\n  /** @override */\n  norm(context) {\n    if (context.getDimension()) {\n      return new CssLengthNode(0, 'px').calcPercent(this.num_, context);\n    }\n    return this;\n  }\n}\n\n/**\n * A CSS length value: `100px`, `80vw`, etc.\n */\nexport class CssLengthNode extends CssNumericNode {\n  /**\n   * @param {number} num\n   * @param {string} units\n   */\n  constructor(num, units) {\n    super('LEN', num, units);\n  }\n\n  /** @override */\n  createSameUnits(num) {\n    return new CssLengthNode(num, this.units_);\n  }\n\n  /** @override */\n  isNorm() {\n    return this.units_ == 'px';\n  }\n\n  /** @override */\n  norm(context) {\n    if (this.isNorm()) {\n      return this;\n    }\n\n    // Font-based: em/rem.\n    if (this.units_ == 'em' || this.units_ == 'rem') {\n      const fontSize =\n        this.units_ == 'em'\n          ? context.getCurrentFontSize()\n          : context.getRootFontSize();\n      return new CssLengthNode(this.num_ * fontSize, 'px');\n    }\n\n    // Viewport based: vw, vh, vmin, vmax.\n    if (\n      this.units_ == 'vw' ||\n      this.units_ == 'vh' ||\n      this.units_ == 'vmin' ||\n      this.units_ == 'vmax'\n    ) {\n      const vp = context.getViewportSize();\n      const vw = (vp.width * this.num_) / 100;\n      const vh = (vp.height * this.num_) / 100;\n      let num = 0;\n      if (this.units_ == 'vw') {\n        num = vw;\n      } else if (this.units_ == 'vh') {\n        num = vh;\n      } else if (this.units_ == 'vmin') {\n        num = Math.min(vw, vh);\n      } else if (this.units_ == 'vmax') {\n        num = Math.max(vw, vh);\n      }\n      return new CssLengthNode(num, 'px');\n    }\n\n    // Can't convert cm/in/etc to px at this time.\n    throw unknownUnits(this.units_);\n  }\n\n  /** @override */\n  calcPercent(percent, context) {\n    const dim = context.getDimension();\n    const size = context.getCurrentElementRect();\n    const side = getRectField(dim, size);\n    return new CssLengthNode((side * percent) / 100, 'px');\n  }\n}\n\n/**\n * A CSS angle value: `45deg`, `0.5rad`, etc.\n */\nexport class CssAngleNode extends CssNumericNode {\n  /**\n   * @param {number} num\n   * @param {string} units\n   */\n  constructor(num, units) {\n    super('ANG', num, units);\n  }\n\n  /** @override */\n  createSameUnits(num) {\n    return new CssAngleNode(num, this.units_);\n  }\n\n  /** @override */\n  isNorm() {\n    return this.units_ == 'rad';\n  }\n\n  /** @override */\n  norm() {\n    if (this.isNorm()) {\n      return this;\n    }\n    if (this.units_ == 'deg') {\n      return new CssAngleNode(this.num_ * DEG_TO_RAD, 'rad');\n    }\n    if (this.units_ == 'grad') {\n      return new CssAngleNode(this.num_ * GRAD_TO_RAD, 'rad');\n    }\n    throw unknownUnits(this.units_);\n  }\n}\n\n/**\n * A CSS time value: `1s`, `600ms`.\n */\nexport class CssTimeNode extends CssNumericNode {\n  /**\n   * @param {number} num\n   * @param {string} units\n   */\n  constructor(num, units) {\n    super('TME', num, units);\n  }\n\n  /** @override */\n  createSameUnits(num) {\n    return new CssTimeNode(num, this.units_);\n  }\n\n  /** @override */\n  isNorm() {\n    return this.units_ == 'ms';\n  }\n\n  /** @override */\n  norm() {\n    if (this.isNorm()) {\n      return this;\n    }\n    return new CssTimeNode(this.millis_(), 'ms');\n  }\n\n  /**\n   * @return {number}\n   * @private\n   */\n  millis_() {\n    if (this.units_ == 'ms') {\n      return this.num_;\n    }\n    if (this.units_ == 's') {\n      return this.num_ * 1000;\n    }\n    throw unknownUnits(this.units_);\n  }\n\n  /**\n   * @param {!CssNode} node\n   * @return {number|undefined}\n   */\n  static millis(node) {\n    if (node instanceof CssTimeNode) {\n      return node.millis_();\n    }\n    if (node instanceof CssNumberNode) {\n      return node.num_;\n    }\n    return undefined;\n  }\n}\n\n/**\n * A CSS generic function: `rgb(1, 1, 1)`, `translateX(300px)`, etc.\n */\nexport class CssFuncNode extends CssNode {\n  /**\n   * @param {string} name\n   * @param {!Array<!CssNode>} args\n   * @param {?Array<string>=} opt_dimensions\n   */\n  constructor(name, args, opt_dimensions) {\n    super();\n    /** @const @private {string} */\n    this.name_ = name.toLowerCase();\n    /** @const @private {!Array<!CssNode>} */\n    this.args_ = args;\n    /** @const @private {?Array<string>} */\n    this.dimensions_ = opt_dimensions || null;\n  }\n\n  /** @override */\n  css() {\n    const args = this.args_.map((node) => node.css()).join(',');\n    return `${this.name_}(${args})`;\n  }\n\n  /** @override */\n  isConst(normalize) {\n    return this.args_.reduce(\n      (acc, node) => acc && node.isConst(normalize),\n      true\n    );\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    const resolvedArgs = resolveArray(\n      context,\n      normalize,\n      this.args_,\n      this.dimensions_\n    );\n    return resolvedArgs ? new CssFuncNode(this.name_, resolvedArgs) : null;\n  }\n}\n\n/**\n * A space separated box declaration (https://developer.mozilla.org/en-US/docs/Web/CSS/margin).\n *\n * Typical forms are:\n * - `<top> <right> <bottom> <left>` (e.g. `10% 20em 30px var(--x)`)\n * - `<top> <horizontal> <bottom>` (e.g. `10% 20em 30vw`)\n * - `<vertical> <horizontal>` (e.g. `10% 20em`)\n * - `<all>` (e.g. `10%`)\n *\n * @param {!CssNode} value\n * @param {?Array<string>=} opt_dimensions\n * @return {!CssNode}\n */\nexport function createBoxNode(value, opt_dimensions) {\n  const dims = opt_dimensions || BOX_DIMENSIONS;\n\n  const args = value instanceof CssConcatNode ? value.array_ : [value];\n  if (args.length < 1 || args.length > 4) {\n    throw new Error('box must have between 1 and 4 components');\n  }\n\n  if (dims.length > 0) {\n    // We have to always turn all forms into the full form at least two\n    // `<vertical> <horizontal>`, because we cannot otherwise apply\n    // the correct dimensions to a single argument.\n    return new CssConcatNode(\n      args.length == 1 ? [args[0], args[0]] : args,\n      dims\n    );\n  }\n  return new CssConcatNode(args);\n}\n\n/**\n * A CSS `border-radius()` expression: `box` or `box1 / box2`.\n *\n * See https://developer.mozilla.org/en-US/docs/Web/CSS/border-radius\n *\n * @param {!CssNode} box1\n * @param {!CssNode=} opt_box2\n * @return {!CssNode}\n */\nexport function createBorderRadiusNode(box1, opt_box2) {\n  const box1Node = createBoxNode(box1, []);\n  if (opt_box2) {\n    return new CssConcatNode([\n      box1Node,\n      new CssPassthroughNode('/'),\n      createBoxNode(opt_box2, []),\n    ]);\n  }\n  return box1Node;\n}\n\n/**\n * A CSS `position` expression.\n *\n * See See https://developer.mozilla.org/en-US/docs/Web/CSS/position_value\n *\n * Variants:\n * - `10%` - X percentage.\n * - `10% 10%` - X and Y percentages.\n * - `left 10%` - X keyword and Y percentage.\n * - `left 10% top 20%` - X keyword and Y percentage.\n *\n * @param {!CssNode} value\n * @return {!CssNode}\n */\nexport function createPositionNode(value) {\n  const args = value instanceof CssConcatNode ? value.array_ : [value];\n  if (args.length != 1 && args.length != 2 && args.length != 4) {\n    throw new Error('position is either 1, 2, or 4 components');\n  }\n\n  let dims = null;\n  if (args.length == 1) {\n    dims = ['w'];\n  } else if (args.length == 2) {\n    dims = ['w', 'h'];\n  } else {\n    // [ left | center | right ] || [ top | center | bottom ]\n    dims = ['', '', '', ''];\n    for (let i = 0; i < args.length; i += 2) {\n      const kw = args[i].css().toLowerCase();\n      const dim =\n        kw == 'left' || kw == 'right'\n          ? 'w'\n          : kw == 'top' || kw == 'bottom'\n          ? 'h'\n          : '';\n      dims[i] = dims[i + 1] = dim;\n    }\n  }\n  return new CssConcatNode(args, dims);\n}\n\n/**\n * A CSS `inset()` expression:\n * `inset( <length-percentage>{1,4} [ round <'border-radius'> ]? )`.\n *\n * See https://developer.mozilla.org/en-US/docs/Web/CSS/clip-path#inset().\n *\n * @param {!CssNode} box\n * @param {!CssNode=} opt_round\n * @return {!CssNode}\n */\nexport function createInsetNode(box, opt_round) {\n  const boxNode = createBoxNode(box);\n  if (opt_round) {\n    return new CssFuncNode('inset', [\n      new CssConcatNode([boxNode, new CssPassthroughNode('round'), opt_round]),\n    ]);\n  }\n  return new CssFuncNode('inset', [boxNode]);\n}\n\n/**\n * A CSS `circle()` expression:\n * `<circle()> = circle( [ <shape-radius> ]? [ at <position> ]? )`.\n *\n * See https://developer.mozilla.org/en-US/docs/Web/CSS/clip-path#circle()\n *\n * @param {?CssNode} radius\n * @param {!CssNode=} opt_position\n * @return {!CssNode}\n */\nexport function createCircleNode(radius, opt_position) {\n  return createEllipseNode(radius, opt_position, 'circle');\n}\n\n/**\n * A CSS `ellipse()` expression:\n * `<ellipse()> = ellipse( [ <shape-radius>{2} ]? [ at <position> ]? )`.\n *\n * See https://developer.mozilla.org/en-US/docs/Web/CSS/clip-path#ellipse()\n *\n * @param {?CssNode} radii\n * @param {!CssNode=} opt_position\n * @param {string=} opt_name\n * @return {!CssNode}\n */\nexport function createEllipseNode(radii, opt_position, opt_name) {\n  const name = opt_name || 'ellipse';\n  const position = opt_position ? createPositionNode(opt_position) : null;\n  if (!radii && !position) {\n    return new CssFuncNode(name, []);\n  }\n  if (radii && position) {\n    return new CssFuncNode(name, [\n      new CssConcatNode([radii, new CssPassthroughNode('at'), position]),\n    ]);\n  }\n  if (position) {\n    return new CssFuncNode(name, [\n      new CssConcatNode([new CssPassthroughNode('at'), position]),\n    ]);\n  }\n  return new CssFuncNode(name, [radii]);\n}\n\n/**\n * A CSS `polygon()` expression:\n * `<polygon()> = polygon( [ <length-percentage> <length-percentage> ]# )`.\n *\n * See https://developer.mozilla.org/en-US/docs/Web/CSS/clip-path#polygon()\n *\n * @param {!Array<!CssNode>} tuples\n * @return {!CssNode}\n */\nexport function createPolygonNode(tuples) {\n  const tuplesWithDims = tuples.map(\n    (tuple) => new CssConcatNode(tuple, TUPLE_DIMENSIONS)\n  );\n  return new CssFuncNode('polygon', tuplesWithDims);\n}\n\n/**\n * A CSS translate family of functions:\n * - `translate(x, y)`\n * - `translateX(x)`\n * - `translateY(y)`\n * - `translateZ(z)`\n * - `translate3d(x, y, z)`\n */\nexport class CssTranslateNode extends CssFuncNode {\n  /**\n   * @param {string} suffix\n   * @param {!Array<!CssNode>} args\n   */\n  constructor(suffix, args) {\n    super(\n      `translate${suffix.toUpperCase()}`,\n      args,\n      suffix == ''\n        ? ['w', 'h']\n        : suffix == 'x'\n        ? ['w']\n        : suffix == 'y'\n        ? ['h']\n        : suffix == 'z'\n        ? ['z']\n        : suffix == '3d'\n        ? ['w', 'h', 'z']\n        : null\n    );\n    /** @const @protected {string} */\n    this.suffix_ = suffix;\n  }\n}\n\n/**\n * AMP-specific `width()` and `height()` functions.\n */\nexport class CssRectNode extends CssNode {\n  /**\n   * @param {string} field x, y, width or height\n   * @param {?string=} opt_selector\n   * @param {?string=} opt_selectionMethod Either `undefined` or \"closest\".\n   */\n  constructor(field, opt_selector, opt_selectionMethod) {\n    super();\n    /** @const @private */\n    this.field_ = field;\n    /** @const @private */\n    this.selector_ = opt_selector || null;\n    /** @const @private */\n    this.selectionMethod_ = opt_selectionMethod || null;\n  }\n\n  /** @override */\n  css() {\n    throw noCss();\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context) {\n    const rect = this.selector_\n      ? context.getElementRect(this.selector_, this.selectionMethod_)\n      : context.getCurrentElementRect();\n    return new CssLengthNode(getRectField(this.field_, rect), 'px');\n  }\n}\n\n/**\n * AMP-specific `num()` function. Format is `num(value)`. Returns a numeric\n * representation of the value. E.g. `11px` -> 11, `12em` -> 12, `10s` -> 10.\n */\nexport class CssNumConvertNode extends CssNode {\n  /**\n   * @param {!CssNode} value\n   */\n  constructor(value) {\n    super();\n    /** @const @private */\n    this.value_ = value;\n  }\n\n  /** @override */\n  css() {\n    throw noCss();\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    const value = this.value_.resolve(context, normalize);\n    if (value == null) {\n      return null;\n    }\n    let num;\n    if (value instanceof CssNumericNode) {\n      num = value.num_;\n    } else {\n      num = parseFloat(value.css());\n    }\n    if (num == null || isNaN(num)) {\n      return null;\n    }\n    return new CssNumberNode(num);\n  }\n}\n\n/**\n * AMP-specific `rand()` function. Has two forms:\n * - `rand()` - returns a random number value between 0 and 1.\n * - `rand(left, right)` - returns a random value between `left` and\n *   `right`. The `left` and `right` are any number-based values in this\n *   case, such as a length (`10px`), a time (`1s`), an angle (`1rad`), etc.\n *   The returned value is the same type - a length, time angle, etc. Thus,\n *   `rand(1s, 5s)` may return a value of `rand(2.1s)`.\n */\nexport class CssRandNode extends CssNode {\n  /**\n   * @param {?CssNode=} left\n   * @param {?CssNode=} right\n   */\n  constructor(left = null, right = null) {\n    super();\n    /** @const @private */\n    this.left_ = left;\n    /** @const @private */\n    this.right_ = right;\n  }\n\n  /** @override */\n  css() {\n    throw noCss();\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    // No arguments: return a random node between 0 and 1.\n    if (this.left_ == null || this.right_ == null) {\n      return new CssNumberNode(Math.random());\n    }\n\n    // Arguments: do a min/max random math.\n    let left = this.left_.resolve(context, normalize);\n    let right = this.right_.resolve(context, normalize);\n    if (left == null || right == null) {\n      return null;\n    }\n    if (\n      !(left instanceof CssNumericNode) ||\n      !(right instanceof CssNumericNode)\n    ) {\n      throw new Error('left and right must be both numerical');\n    }\n    if (left.type_ != right.type_) {\n      throw new Error('left and right must be the same type');\n    }\n\n    // Units are the same, the math is simple: numerals are summed. Otherwise,\n    // the units neeed to be normalized first.\n    if (left.units_ != right.units_) {\n      left = left.norm(context);\n      right = right.norm(context);\n    }\n    const min = Math.min(left.num_, right.num_);\n    const max = Math.max(left.num_, right.num_);\n    const rand = Math.random();\n    // Formula: rand(A, B) = A * (1 - R) + B * R\n    const num = min * (1 - rand) + max * rand;\n    return left.createSameUnits(num);\n  }\n}\n\n/**\n * AMP-specific `index()` function. Returns 0-based index of the current\n * target in a list of all selected targets.\n */\nexport class CssIndexNode extends CssNode {\n  /**\n   * Creates an instance of CssIndexNode.\n   */\n  constructor() {\n    super();\n  }\n\n  /** @override */\n  css() {\n    throw noCss();\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context) {\n    return new CssNumberNode(context.getCurrentIndex());\n  }\n}\n\n/**\n * AMP-specific `length()` function. Returns number of targets selected.\n */\nexport class CssLengthFuncNode extends CssNode {\n  /**\n   * Creates an instance of CssLengthFuncNode.\n   */\n  constructor() {\n    super();\n  }\n\n  /** @override */\n  css() {\n    throw noCss();\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context) {\n    return new CssNumberNode(context.getTargetLength());\n  }\n}\n\n/**\n * A CSS `var()` expression: `var(--name)`, `var(--name, 100px)`, etc.\n * See https://www.w3.org/TR/css-variables/.\n */\nexport class CssVarNode extends CssNode {\n  /**\n   * @param {string} varName\n   * @param {!CssNode=} opt_def\n   */\n  constructor(varName, opt_def) {\n    super();\n    /** @const @private {string} */\n    this.varName_ = varName;\n    /** @const @private {?CssNode} */\n    this.def_ = opt_def || null;\n  }\n\n  /** @override */\n  css() {\n    return `var(${this.varName_}${this.def_ ? ',' + this.def_.css() : ''})`;\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    const varNode = context.getVar(this.varName_);\n    if (varNode) {\n      return varNode.resolve(context, normalize);\n    }\n    if (this.def_) {\n      return this.def_.resolve(context, normalize);\n    }\n    return null;\n  }\n}\n\n/**\n * A CSS `calc()` expression: `calc(100px)`, `calc(80vw - 30em)`, etc.\n * See https://drafts.csswg.org/css-values-3/#calc-notation.\n */\nexport class CssCalcNode extends CssNode {\n  /** @param {!CssNode} expr */\n  constructor(expr) {\n    super();\n    /** @const @private {!CssNode} */\n    this.expr_ = expr;\n  }\n\n  /** @override */\n  css() {\n    return `calc(${this.expr_.css()})`;\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    return this.expr_.resolve(context, normalize);\n  }\n}\n\n/**\n * A CSS `calc()` sum expression: `100px + 20em`, `80vw - 30em`, etc.\n */\nexport class CssCalcSumNode extends CssNode {\n  /**\n   * @param {!CssNode} left\n   * @param {!CssNode} right\n   * @param {string} op Either \"+\" or \"-\".\n   */\n  constructor(left, right, op) {\n    super();\n    /** @const @private {!CssNode} */\n    this.left_ = left;\n    /** @const @private {!CssNode} */\n    this.right_ = right;\n    /** @const @private {string} */\n    this.op_ = op;\n  }\n\n  /** @override */\n  css() {\n    return `${this.left_.css()} ${this.op_} ${this.right_.css()}`;\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    /*\n     * From spec:\n     * At + or -, check that both sides have the same type, or that one side is\n     * a <number> and the other is an <integer>. If both sides are the same\n     * type, resolve to that type. If one side is a <number> and the other is\n     * an <integer>, resolve to <number>.\n     */\n    let left = this.left_.resolve(context, normalize);\n    let right = this.right_.resolve(context, normalize);\n    if (left == null || right == null) {\n      return null;\n    }\n    if (\n      !(left instanceof CssNumericNode) ||\n      !(right instanceof CssNumericNode)\n    ) {\n      throw new Error('left and right must be both numerical');\n    }\n    if (left.type_ != right.type_) {\n      // Percent values are special: they need to be resolved in the context\n      // of the other dimension.\n      if (left instanceof CssPercentNode) {\n        left = right.calcPercent(left.num_, context);\n      } else if (right instanceof CssPercentNode) {\n        right = left.calcPercent(right.num_, context);\n      } else {\n        throw new Error('left and right must be the same type');\n      }\n    }\n\n    // Units are the same, the math is simple: numerals are summed. Otherwise,\n    // the units neeed to be normalized first.\n    if (left.units_ != right.units_) {\n      left = left.norm(context);\n      right = right.norm(context);\n    }\n    const sign = this.op_ == '+' ? 1 : -1;\n    return left.createSameUnits(left.num_ + sign * right.num_);\n  }\n}\n\n/**\n * A CSS `calc()` product expression: `100px * 2`, `80vw / 2`, etc.\n */\nexport class CssCalcProductNode extends CssNode {\n  /**\n   * @param {!CssNode} left\n   * @param {!CssNode} right\n   * @param {string} op Either \"*\" or \"/\".\n   */\n  constructor(left, right, op) {\n    super();\n    /** @const @private {!CssNode} */\n    this.left_ = left;\n    /** @const @private {!CssNode} */\n    this.right_ = right;\n    /** @const @private {string} */\n    this.op_ = op;\n  }\n\n  /** @override */\n  css() {\n    return `${this.left_.css()} ${this.op_} ${this.right_.css()}`;\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    const left = this.left_.resolve(context, normalize);\n    const right = this.right_.resolve(context, normalize);\n    if (left == null || right == null) {\n      return null;\n    }\n    if (\n      !(left instanceof CssNumericNode) ||\n      !(right instanceof CssNumericNode)\n    ) {\n      throw new Error('left and right must be both numerical');\n    }\n\n    /*\n     * From spec:\n     * At *, check that at least one side is <number>. If both sides are\n     * <integer>, resolve to <integer>. Otherwise, resolve to the type of the\n     * other side.\n     * At /, check that the right side is <number>. If the left side is\n     * <integer>, resolve to <number>. Otherwise, resolve to the type of the\n     * left side.\n     */\n    let base;\n    let multi;\n    if (this.op_ == '*') {\n      if (left instanceof CssNumberNode) {\n        multi = left.num_;\n        base = right;\n      } else {\n        if (!(right instanceof CssNumberNode)) {\n          throw new Error('one of sides in multiplication must be a number');\n        }\n        multi = right.num_;\n        base = left;\n      }\n    } else {\n      if (!(right instanceof CssNumberNode)) {\n        throw new Error('denominator must be a number');\n      }\n      base = left;\n      multi = 1 / right.num_;\n    }\n\n    const num = base.num_ * multi;\n    if (!isFinite(num)) {\n      return null;\n    }\n    return base.createSameUnits(num);\n  }\n}\n\n/**\n * CSS `min()` and `max()`.\n * See https://developer.mozilla.org/en-US/docs/Web/CSS/min\n * See https://developer.mozilla.org/en-US/docs/Web/CSS/max\n */\nexport class CssMinMaxNode extends CssFuncNode {\n  /**\n   * @param {string} name\n   * @param {!Array<!CssNode>} args\n   */\n  constructor(name, args) {\n    super(name, args);\n  }\n\n  /** @override */\n  isConst() {\n    return false;\n  }\n\n  /** @override */\n  calc(context, normalize) {\n    let resolvedArgs = resolveArray(context, normalize, this.args_, null);\n    if (!resolvedArgs) {\n      return null;\n    }\n\n    let firstNonPercent = null;\n    let hasPercent = false;\n    let hasDifferentUnits = false;\n    resolvedArgs.forEach((arg) => {\n      if (!(arg instanceof CssNumericNode)) {\n        throw new Error('arguments must be numerical');\n      }\n      if (arg instanceof CssPercentNode) {\n        hasPercent = true;\n      } else if (firstNonPercent) {\n        if (arg.type_ != firstNonPercent.type_) {\n          throw new Error('arguments must be the same type');\n        }\n        if (arg.units_ != firstNonPercent.units_) {\n          hasDifferentUnits = true;\n        }\n      } else {\n        firstNonPercent = arg;\n      }\n    });\n    if (firstNonPercent && hasPercent) {\n      hasDifferentUnits = true;\n    }\n\n    if (firstNonPercent) {\n      // Recalculate percent values and normalize units.\n      if (hasDifferentUnits) {\n        firstNonPercent = firstNonPercent.norm(context);\n      }\n      resolvedArgs = resolvedArgs.map((arg) => {\n        if (arg == firstNonPercent) {\n          return arg;\n        }\n\n        // Percent values.\n        if (arg instanceof CssPercentNode) {\n          return firstNonPercent.calcPercent(arg.num_, context);\n        }\n\n        // Units are the same, the math is simple: numerals are summed.\n        // Otherwise, the units neeed to be normalized first.\n        if (hasDifferentUnits) {\n          return /** @type {!CssNumericNode} */ (arg).norm(context);\n        }\n        return arg;\n      });\n    }\n\n    // Calculate.\n    const nums = resolvedArgs.map((arg) => arg.num_);\n    let value;\n    if (this.name_ == 'min') {\n      // min(...)\n      value = Math.min.apply(null, nums);\n    } else if (this.name_ == 'max') {\n      // max(...)\n      value = Math.max.apply(null, nums);\n    } else {\n      // clamp(min, preferred, max)\n      const min = nums[0];\n      const preferred = nums[1];\n      const max = nums[2];\n      value = Math.max(min, Math.min(max, preferred));\n    }\n    return resolvedArgs[0].createSameUnits(value);\n  }\n}\n\n/**\n * @param {string} units\n * @return {!Error}\n */\nfunction unknownUnits(units) {\n  return new Error('unknown units: ' + units);\n}\n\n/**\n * @return {!Error}\n */\nfunction noCss() {\n  return new Error('no css');\n}\n\n/**\n * @param {?string} field\n * @param {!../../../../src/layout-rect.LayoutRectDef} rect\n * @return {number}\n */\nfunction getRectField(field, rect) {\n  if (field == 'w') {\n    return rect.width;\n  }\n  if (field == 'h') {\n    return rect.height;\n  }\n  return rect[field] ?? 0;\n}\n\n/**\n * @param {!CssContext} context\n * @param {boolean} normalize\n * @param {!Array<!CssNode>} array\n * @param {?Array<string>} dimensions\n * @return {?Array<!CssNode>}\n */\nfunction resolveArray(context, normalize, array, dimensions) {\n  const resolvedArray = [];\n  for (let i = 0; i < array.length; i++) {\n    const node = array[i];\n    let resolved;\n    if (dimensions && i < dimensions.length) {\n      resolved = context.withDimension(dimensions[i], () =>\n        node.resolve(context, normalize)\n      );\n    } else {\n      resolved = node.resolve(context, normalize);\n    }\n    if (resolved) {\n      resolvedArray.push(resolved);\n    } else {\n      // One argument is null - the function's result is null.\n      return null;\n    }\n  }\n  return resolvedArray;\n}\n", "\n\n\n/** @fileoverview @suppress {checkTypes, suspiciousCode, uselessCode} */\n\nimport * as ast from '../../extensions/amp-animation/0.1/parsers/css-expr-ast';\n\n/* parser generated by jison 0.4.18 */\n/*\n  Returns a Parser object of the following structure:\n\n  Parser: {\n    yy: {}\n  }\n\n  Parser.prototype: {\n    yy: {},\n    trace: function(),\n    symbols_: {associative list: name ==> number},\n    terminals_: {associative list: number ==> name},\n    productions_: [...],\n    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),\n    table: [...],\n    defaultActions: {...},\n    parseError: function(str, hash),\n    parse: function(input),\n\n    lexer: {\n        EOF: 1,\n        parseError: function(str, hash),\n        setInput: function(input),\n        input: function(),\n        unput: function(str),\n        more: function(),\n        less: function(n),\n        pastInput: function(),\n        upcomingInput: function(),\n        showPosition: function(),\n        test_match: function(regex_match_array, rule_index),\n        next: function(),\n        lex: function(),\n        begin: function(condition),\n        popState: function(),\n        _currentRules: function(),\n        topState: function(),\n        pushState: function(condition),\n\n        options: {\n            ranges: boolean           (optional: true ==> token location info will include a .range[] member)\n            flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)\n            backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)\n        },\n\n        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),\n        rules: [...],\n        conditions: {associative list: name ==> set},\n    }\n  }\n\n\n  token location info (@$, _$, etc.): {\n    first_line: n,\n    last_line: n,\n    first_column: n,\n    last_column: n,\n    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)\n  }\n\n\n  the parseError function receives a 'hash' object with these members for lexer and parser errors: {\n    text:        (matched text)\n    token:       (the produced terminal token, if any)\n    line:        (yylineno)\n  }\n  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {\n    loc:         (yylloc)\n    expected:    (string describing the set of expected tokens)\n    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)\n  }\n*/\nvar parser = (function(){\nvar o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,7],$V1=[1,8],$V2=[1,9],$V3=[1,14],$V4=[1,15],$V5=[1,32],$V6=[1,33],$V7=[1,34],$V8=[1,35],$V9=[1,36],$Va=[1,37],$Vb=[1,38],$Vc=[1,39],$Vd=[1,40],$Ve=[1,41],$Vf=[1,42],$Vg=[1,43],$Vh=[1,44],$Vi=[1,45],$Vj=[1,46],$Vk=[1,47],$Vl=[1,48],$Vm=[1,49],$Vn=[1,73],$Vo=[1,50],$Vp=[1,53],$Vq=[1,54],$Vr=[1,55],$Vs=[1,56],$Vt=[1,57],$Vu=[1,66],$Vv=[1,67],$Vw=[1,68],$Vx=[1,69],$Vy=[1,58],$Vz=[1,59],$VA=[1,60],$VB=[1,61],$VC=[1,62],$VD=[1,63],$VE=[1,64],$VF=[1,65],$VG=[1,51],$VH=[1,52],$VI=[1,70],$VJ=[1,71],$VK=[1,72],$VL=[5,9,10,11,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,52,53,57,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,76,77,78,79,80,82,85,86,87],$VM=[5,9,10,11,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,52,53,55,57,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,76,77,78,79,80,82,85,86,87,89,90,91],$VN=[1,80],$VO=[1,124],$VP=[1,123],$VQ=[1,125],$VR=[1,126],$VS=[53,55,57,89,90,91],$VT=[1,129],$VU=[53,55],$VV=[1,156],$VW=[53,55,90,91];\nvar parser = {trace: function trace () { },\nyy: {},\nsymbols_: {\"error\":2,\"result\":3,\"value\":4,\"EOF\":5,\"literal_or_function\":6,\"literal\":7,\"function\":8,\"STRING\":9,\"NUMBER\":10,\"PERCENTAGE\":11,\"length\":12,\"angle\":13,\"time\":14,\"url\":15,\"HEXCOLOR\":16,\"IDENT\":17,\"LENGTH_PX\":18,\"LENGTH_EM\":19,\"LENGTH_REM\":20,\"LENGTH_VH\":21,\"LENGTH_VW\":22,\"LENGTH_VMIN\":23,\"LENGTH_VMAX\":24,\"LENGTH_CM\":25,\"LENGTH_MM\":26,\"LENGTH_Q\":27,\"LENGTH_IN\":28,\"LENGTH_PC\":29,\"LENGTH_PT\":30,\"ANGLE_DEG\":31,\"ANGLE_RAD\":32,\"ANGLE_GRAD\":33,\"TIME_MS\":34,\"TIME_S\":35,\"var_function\":36,\"calc_function\":37,\"translate_function\":38,\"rect_function\":39,\"num_function\":40,\"rand_function\":41,\"index_function\":42,\"length_function\":43,\"inset_function\":44,\"circle_function\":45,\"ellipse_function\":46,\"polygon_function\":47,\"min_function\":48,\"max_function\":49,\"clamp_function\":50,\"any_function\":51,\"FUNCTION_START\":52,\")\":53,\"args\":54,\",\":55,\"border_radius\":56,\"/\":57,\"tuples\":58,\"URL_START\":59,\"TRANSLATE_START\":60,\"TRANSLATE_X_START\":61,\"TRANSLATE_Y_START\":62,\"TRANSLATE_Z_START\":63,\"TRANSLATE_3D_START\":64,\"INSET_START\":65,\"ROUND\":66,\"CIRCLE_START\":67,\"AT\":68,\"ELLIPSE_START\":69,\"POLYGON_START\":70,\"WIDTH_START\":71,\"HEIGHT_START\":72,\"X_START\":73,\"Y_START\":74,\"CLOSEST_START\":75,\"NUM_START\":76,\"RAND_START\":77,\"INDEX_START\":78,\"LENGTH_START\":79,\"VAR_START\":80,\"VAR_NAME\":81,\"CALC_START\":82,\"calc_expr\":83,\"calc_expr_list\":84,\"MIN_START\":85,\"MAX_START\":86,\"CLAMP_START\":87,\"(\":88,\"*\":89,\"+\":90,\"-\":91,\"$accept\":0,\"$end\":1},\nterminals_: {2:\"error\",5:\"EOF\",9:\"STRING\",10:\"NUMBER\",11:\"PERCENTAGE\",16:\"HEXCOLOR\",17:\"IDENT\",18:\"LENGTH_PX\",19:\"LENGTH_EM\",20:\"LENGTH_REM\",21:\"LENGTH_VH\",22:\"LENGTH_VW\",23:\"LENGTH_VMIN\",24:\"LENGTH_VMAX\",25:\"LENGTH_CM\",26:\"LENGTH_MM\",27:\"LENGTH_Q\",28:\"LENGTH_IN\",29:\"LENGTH_PC\",30:\"LENGTH_PT\",31:\"ANGLE_DEG\",32:\"ANGLE_RAD\",33:\"ANGLE_GRAD\",34:\"TIME_MS\",35:\"TIME_S\",52:\"FUNCTION_START\",53:\")\",55:\",\",57:\"/\",59:\"URL_START\",60:\"TRANSLATE_START\",61:\"TRANSLATE_X_START\",62:\"TRANSLATE_Y_START\",63:\"TRANSLATE_Z_START\",64:\"TRANSLATE_3D_START\",65:\"INSET_START\",66:\"ROUND\",67:\"CIRCLE_START\",68:\"AT\",69:\"ELLIPSE_START\",70:\"POLYGON_START\",71:\"WIDTH_START\",72:\"HEIGHT_START\",73:\"X_START\",74:\"Y_START\",75:\"CLOSEST_START\",76:\"NUM_START\",77:\"RAND_START\",78:\"INDEX_START\",79:\"LENGTH_START\",80:\"VAR_START\",81:\"VAR_NAME\",82:\"CALC_START\",85:\"MIN_START\",86:\"MAX_START\",87:\"CLAMP_START\",88:\"(\",89:\"*\",90:\"+\",91:\"-\"},\nproductions_: [0,[3,2],[3,1],[4,1],[4,2],[6,1],[6,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[12,1],[12,1],[12,1],[12,1],[12,1],[12,1],[12,1],[12,1],[12,1],[12,1],[12,1],[12,1],[13,1],[13,1],[13,1],[14,1],[14,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[8,1],[51,2],[51,3],[54,1],[54,3],[56,1],[56,3],[58,2],[58,4],[15,3],[38,3],[38,3],[38,3],[38,3],[38,3],[44,5],[44,3],[45,2],[45,4],[45,5],[45,3],[46,2],[46,4],[46,5],[46,3],[47,3],[39,2],[39,2],[39,2],[39,2],[39,3],[39,3],[39,3],[39,3],[39,5],[39,5],[39,5],[39,5],[40,3],[41,2],[41,5],[42,2],[43,2],[36,3],[36,5],[37,3],[84,1],[84,3],[48,3],[49,3],[50,3],[83,1],[83,3],[83,3],[83,3],[83,3],[83,3]],\nperformAction: function anonymous(yytext, yyleng, yylineno, yy, yystate /* action[1] */, $$ /* vstack */, _$ /* lstack */) {\n/* this == yyval */\n\nvar $0 = $$.length - 1;\nswitch (yystate) {\ncase 1:\nreturn $$[$0-1];\nbreak;\ncase 2:\nreturn null;\nbreak;\ncase 3: case 5: case 6: case 10: case 11: case 12: case 13: case 34: case 35: case 36: case 37: case 38: case 39: case 40: case 41: case 42: case 43: case 44: case 45: case 46: case 47: case 48: case 49: case 100:\nthis.$ = $$[$0];\nbreak;\ncase 4:\nthis.$ = ast.CssConcatNode.concat($$[$0-1], $$[$0]);\nbreak;\ncase 7: case 14: case 15:\nthis.$ = new ast.CssPassthroughNode($$[$0]);\nbreak;\ncase 8:\nthis.$ = new ast.CssNumberNode(parseFloat($$[$0]));\nbreak;\ncase 9:\nthis.$ = new ast.CssPercentNode(parseFloat($$[$0]));\nbreak;\ncase 16:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'px');\nbreak;\ncase 17:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'em');\nbreak;\ncase 18:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'rem');\nbreak;\ncase 19:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'vh');\nbreak;\ncase 20:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'vw');\nbreak;\ncase 21:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'vmin');\nbreak;\ncase 22:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'vmax');\nbreak;\ncase 23:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'cm');\nbreak;\ncase 24:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'mm');\nbreak;\ncase 25:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'q');\nbreak;\ncase 26:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'in');\nbreak;\ncase 27:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'pc');\nbreak;\ncase 28:\nthis.$ = new ast.CssLengthNode(parseFloat($$[$0]), 'pt');\nbreak;\ncase 29:\nthis.$ = new ast.CssAngleNode(parseFloat($$[$0]), 'deg');\nbreak;\ncase 30:\nthis.$ = new ast.CssAngleNode(parseFloat($$[$0]), 'rad');\nbreak;\ncase 31:\nthis.$ = new ast.CssAngleNode(parseFloat($$[$0]), 'grad');\nbreak;\ncase 32:\nthis.$ = new ast.CssTimeNode(parseFloat($$[$0]), 'ms');\nbreak;\ncase 33:\nthis.$ = new ast.CssTimeNode(parseFloat($$[$0]), 's');\nbreak;\ncase 50:\nthis.$ = new ast.CssFuncNode($$[$0-1].slice(0, -1), []);\nbreak;\ncase 51:\nthis.$ = new ast.CssFuncNode($$[$0-2].slice(0, -1), $$[$0-1]);\nbreak;\ncase 52: case 95:\nthis.$ = [$$[$0]];\nbreak;\ncase 53:\n\n        const args = $$[$0-2];\n        args.push($$[$0]);\n        this.$ = args;\n      \nbreak;\ncase 54:\nthis.$ = ast.createBorderRadiusNode($$[$0]);\nbreak;\ncase 55:\nthis.$ = ast.createBorderRadiusNode($$[$0-2], $$[$0]);\nbreak;\ncase 56:\nthis.$ = [ast.CssConcatNode.concat($$[$0-1], $$[$0])];\nbreak;\ncase 57:\n\n        const tuples = $$[$0-3];\n        tuples.push(ast.CssConcatNode.concat($$[$0-1], $$[$0]));\n        this.$ = tuples;\n      \nbreak;\ncase 58:\nthis.$ = new ast.CssUrlNode($$[$0-1].slice(1, -1));\nbreak;\ncase 59:\nthis.$ = new ast.CssTranslateNode('', $$[$0-1]);\nbreak;\ncase 60:\nthis.$ = new ast.CssTranslateNode('x', $$[$0-1]);\nbreak;\ncase 61:\nthis.$ = new ast.CssTranslateNode('y', $$[$0-1]);\nbreak;\ncase 62:\nthis.$ = new ast.CssTranslateNode('z', $$[$0-1]);\nbreak;\ncase 63:\nthis.$ = new ast.CssTranslateNode('3d', $$[$0-1]);\nbreak;\ncase 64:\nthis.$ = ast.createInsetNode($$[$0-3], $$[$0-1]);\nbreak;\ncase 65:\nthis.$ = ast.createInsetNode($$[$0-1]);\nbreak;\ncase 66:\nthis.$ = ast.createCircleNode();\nbreak;\ncase 67:\nthis.$ = ast.createCircleNode(null, $$[$0-1]);\nbreak;\ncase 68:\nthis.$ = ast.createCircleNode($$[$0-3], $$[$0-1]);\nbreak;\ncase 69:\nthis.$ = ast.createCircleNode($$[$0-1]);\nbreak;\ncase 70:\nthis.$ = ast.createEllipseNode();\nbreak;\ncase 71:\nthis.$ = ast.createEllipseNode(null, $$[$0-1]);\nbreak;\ncase 72:\nthis.$ = ast.createEllipseNode($$[$0-3], $$[$0-1]);\nbreak;\ncase 73:\nthis.$ = ast.createEllipseNode($$[$0-1]);\nbreak;\ncase 74:\nthis.$ = ast.createPolygonNode($$[$0-1]);\nbreak;\ncase 75:\nthis.$ = new ast.CssRectNode('w');\nbreak;\ncase 76:\nthis.$ = new ast.CssRectNode('h');\nbreak;\ncase 77:\nthis.$ = new ast.CssRectNode('x');\nbreak;\ncase 78:\nthis.$ = new ast.CssRectNode('y');\nbreak;\ncase 79:\nthis.$ = new ast.CssRectNode('w', $$[$0-1].slice(1, -1));\nbreak;\ncase 80:\nthis.$ = new ast.CssRectNode('h', $$[$0-1].slice(1, -1));\nbreak;\ncase 81:\nthis.$ = new ast.CssRectNode('x', $$[$0-1].slice(1, -1));\nbreak;\ncase 82:\nthis.$ = new ast.CssRectNode('y', $$[$0-1].slice(1, -1));\nbreak;\ncase 83:\nthis.$ = new ast.CssRectNode('w', $$[$0-2].slice(1, -1), 'closest');\nbreak;\ncase 84:\nthis.$ = new ast.CssRectNode('h', $$[$0-2].slice(1, -1), 'closest');\nbreak;\ncase 85:\nthis.$ = new ast.CssRectNode('x', $$[$0-2].slice(1, -1), 'closest');\nbreak;\ncase 86:\nthis.$ = new ast.CssRectNode('y', $$[$0-2].slice(1, -1), 'closest');\nbreak;\ncase 87:\nthis.$ = new ast.CssNumConvertNode($$[$0-1]);\nbreak;\ncase 88:\nthis.$ = new ast.CssRandNode();\nbreak;\ncase 89:\nthis.$ = new ast.CssRandNode($$[$0-3], $$[$0-1]);\nbreak;\ncase 90:\nthis.$ = new ast.CssIndexNode();\nbreak;\ncase 91:\nthis.$ = new ast.CssLengthFuncNode();\nbreak;\ncase 92:\nthis.$ = new ast.CssVarNode($$[$0-1]);\nbreak;\ncase 93:\nthis.$ = new ast.CssVarNode($$[$0-3], $$[$0-1]);\nbreak;\ncase 94:\nthis.$ = new ast.CssCalcNode($$[$0-1]);\nbreak;\ncase 96:\n\n        const calc_expr_list = $$[$0-2];\n        calc_expr_list.push($$[$0]);\n        this.$ = calc_expr_list;\n      \nbreak;\ncase 97:\nthis.$ = new ast.CssMinMaxNode('min', $$[$0-1]);\nbreak;\ncase 98:\nthis.$ = new ast.CssMinMaxNode('max', $$[$0-1]);\nbreak;\ncase 99:\nthis.$ = new ast.CssMinMaxNode('clamp', $$[$0-1]);\nbreak;\ncase 101:\nthis.$ = $$[$0-1];\nbreak;\ncase 102:\nthis.$ = new ast.CssCalcProductNode($$[$0-2], $$[$0], '*');\nbreak;\ncase 103:\nthis.$ = new ast.CssCalcProductNode($$[$0-2], $$[$0], '/');\nbreak;\ncase 104:\nthis.$ = new ast.CssCalcSumNode($$[$0-2], $$[$0], '+');\nbreak;\ncase 105:\nthis.$ = new ast.CssCalcSumNode($$[$0-2], $$[$0], '-');\nbreak;\n}\n},\ntable: [{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{1:[3]},{5:[1,74],6:75,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{1:[2,2]},o($VL,[2,3]),o($VM,[2,5]),o($VM,[2,6]),o($VM,[2,7]),o($VM,[2,8]),o($VM,[2,9]),o($VM,[2,10]),o($VM,[2,11]),o($VM,[2,12]),o($VM,[2,13]),o($VM,[2,14]),o($VM,[2,15]),o($VM,[2,34]),o($VM,[2,35]),o($VM,[2,36]),o($VM,[2,37]),o($VM,[2,38]),o($VM,[2,39]),o($VM,[2,40]),o($VM,[2,41]),o($VM,[2,42]),o($VM,[2,43]),o($VM,[2,44]),o($VM,[2,45]),o($VM,[2,46]),o($VM,[2,47]),o($VM,[2,48]),o($VM,[2,49]),o($VM,[2,16]),o($VM,[2,17]),o($VM,[2,18]),o($VM,[2,19]),o($VM,[2,20]),o($VM,[2,21]),o($VM,[2,22]),o($VM,[2,23]),o($VM,[2,24]),o($VM,[2,25]),o($VM,[2,26]),o($VM,[2,27]),o($VM,[2,28]),o($VM,[2,29]),o($VM,[2,30]),o($VM,[2,31]),o($VM,[2,32]),o($VM,[2,33]),{9:[1,76]},{81:[1,77]},{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:78,85:$VI,86:$VJ,87:$VK,88:$VN},{6:82,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,54:81,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:82,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,54:83,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:82,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,54:84,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:82,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,54:85,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:82,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,54:86,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{9:[1,88],53:[1,87],75:[1,89]},{9:[1,91],53:[1,90],75:[1,92]},{9:[1,94],53:[1,93],75:[1,95]},{9:[1,97],53:[1,96],75:[1,98]},{6:99,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:101,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,100],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{53:[1,102]},{53:[1,103]},{4:104,6:4,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:107,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,105],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,68:[1,106],69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{4:110,6:4,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,108],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,68:[1,109],69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:112,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,58:111,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:114,84:113,85:$VI,86:$VJ,87:$VK,88:$VN},{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:114,84:115,85:$VI,86:$VJ,87:$VK,88:$VN},{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:114,84:116,85:$VI,86:$VJ,87:$VK,88:$VN},{6:82,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,117],54:118,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{1:[2,1]},o($VL,[2,4]),{53:[1,119]},{53:[1,120],55:[1,121]},{53:[1,122],57:$VO,89:$VP,90:$VQ,91:$VR},o($VS,[2,100]),{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:127,85:$VI,86:$VJ,87:$VK,88:$VN},{53:[1,128],55:$VT},o($VU,[2,52]),{53:[1,130],55:$VT},{53:[1,131],55:$VT},{53:[1,132],55:$VT},{53:[1,133],55:$VT},o($VM,[2,75]),{53:[1,134]},{9:[1,135]},o($VM,[2,76]),{53:[1,136]},{9:[1,137]},o($VM,[2,77]),{53:[1,138]},{9:[1,139]},o($VM,[2,78]),{53:[1,140]},{9:[1,141]},{53:[1,142]},o($VM,[2,88]),{55:[1,143]},o($VM,[2,90]),o($VM,[2,91]),{6:75,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,145],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,66:[1,144],67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VM,[2,66]),{4:146,6:4,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{53:[1,148],68:[1,147]},o($VM,[2,70]),{4:149,6:4,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:75,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,151],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,68:[1,150],69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{53:[1,152],55:[1,153]},{6:154,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{53:[1,155],55:$VV},o($VU,[2,95],{57:$VO,89:$VP,90:$VQ,91:$VR}),{53:[1,157],55:$VV},{53:[1,158],55:$VV},o($VM,[2,50]),{53:[1,159],55:$VT},o($VM,[2,58]),o($VM,[2,92]),{6:160,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VM,[2,94]),{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:161,85:$VI,86:$VJ,87:$VK,88:$VN},{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:162,85:$VI,86:$VJ,87:$VK,88:$VN},{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:163,85:$VI,86:$VJ,87:$VK,88:$VN},{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:164,85:$VI,86:$VJ,87:$VK,88:$VN},{53:[1,165],57:$VO,89:$VP,90:$VQ,91:$VR},o($VM,[2,59]),{6:166,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VM,[2,60]),o($VM,[2,61]),o($VM,[2,62]),o($VM,[2,63]),o($VM,[2,79]),{53:[1,167]},o($VM,[2,80]),{53:[1,168]},o($VM,[2,81]),{53:[1,169]},o($VM,[2,82]),{53:[1,170]},o($VM,[2,87]),{6:171,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{4:173,6:4,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,56:172,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VM,[2,65]),{6:75,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,174],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{4:175,6:4,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VM,[2,69]),{6:75,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,176],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{4:177,6:4,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VM,[2,73]),o($VM,[2,74]),{6:178,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VU,[2,56]),o($VM,[2,97]),{6:79,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,83:179,85:$VI,86:$VJ,87:$VK,88:$VN},o($VM,[2,98]),o($VM,[2,99]),o($VM,[2,51]),{53:[1,180]},o($VS,[2,102]),o($VS,[2,103]),o($VW,[2,104],{57:$VO,89:$VP}),o($VW,[2,105],{57:$VO,89:$VP}),o($VS,[2,101]),o($VU,[2,53]),{53:[1,181]},{53:[1,182]},{53:[1,183]},{53:[1,184]},{53:[1,185]},{53:[1,186]},{6:75,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[2,54],57:[1,187],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VM,[2,67]),{6:75,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,188],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VM,[2,71]),{6:75,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[1,189],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},{6:190,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VU,[2,96],{57:$VO,89:$VP,90:$VQ,91:$VR}),o($VM,[2,93]),o($VM,[2,83]),o($VM,[2,84]),o($VM,[2,85]),o($VM,[2,86]),o($VM,[2,89]),o($VM,[2,64]),{4:191,6:4,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK},o($VM,[2,68]),o($VM,[2,72]),o($VU,[2,57]),{6:75,7:5,8:6,9:$V0,10:$V1,11:$V2,12:10,13:11,14:12,15:13,16:$V3,17:$V4,18:$V5,19:$V6,20:$V7,21:$V8,22:$V9,23:$Va,24:$Vb,25:$Vc,26:$Vd,27:$Ve,28:$Vf,29:$Vg,30:$Vh,31:$Vi,32:$Vj,33:$Vk,34:$Vl,35:$Vm,36:16,37:17,38:18,39:19,40:20,41:21,42:22,43:23,44:24,45:25,46:26,47:27,48:28,49:29,50:30,51:31,52:$Vn,53:[2,55],59:$Vo,60:$Vp,61:$Vq,62:$Vr,63:$Vs,64:$Vt,65:$Vu,67:$Vv,69:$Vw,70:$Vx,71:$Vy,72:$Vz,73:$VA,74:$VB,76:$VC,77:$VD,78:$VE,79:$VF,80:$VG,82:$VH,85:$VI,86:$VJ,87:$VK}],\ndefaultActions: {3:[2,2],74:[2,1]},\nparseError: function parseError (str, hash) {\n    if (hash.recoverable) {\n        this.trace(str);\n    } else {\n        var error = new Error(str);\n        error.hash = hash;\n        throw error;\n    }\n},\nparse: function parse(input) {\n    var self = this, stack = [0], tstack = [], vstack = [null], lstack = [], table = this.table, yytext = '', yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;\n    var args = lstack.slice.call(arguments, 1);\n    var lexer = Object.create(this.lexer);\n    var sharedState = { yy: {} };\n    for (var k in this.yy) {\n        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {\n            sharedState.yy[k] = this.yy[k];\n        }\n    }\n    lexer.setInput(input, sharedState.yy);\n    sharedState.yy.lexer = lexer;\n    sharedState.yy.parser = this;\n    if (typeof lexer.yylloc == 'undefined') {\n        lexer.yylloc = {};\n    }\n    var yyloc = lexer.yylloc;\n    lstack.push(yyloc);\n    var ranges = lexer.options && lexer.options.ranges;\n    if (typeof sharedState.yy.parseError === 'function') {\n        this.parseError = sharedState.yy.parseError;\n    } else {\n        this.parseError = Object.getPrototypeOf(this).parseError;\n    }\n    function popStack(n) {\n        stack.length = stack.length - 2 * n;\n        vstack.length = vstack.length - n;\n        lstack.length = lstack.length - n;\n    }\n\n        var lex = function () {\n            var token;\n            token = lexer.lex() || EOF;\n            if (typeof token !== 'number') {\n                token = self.symbols_[token] || token;\n            }\n            return token;\n        };\n    var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;\n    while (true) {\n        state = stack[stack.length - 1];\n        if (this.defaultActions[state]) {\n            action = this.defaultActions[state];\n        } else {\n            if (symbol === null || typeof symbol == 'undefined') {\n                symbol = lex();\n            }\n            action = table[state] && table[state][symbol];\n        }\n                    if (typeof action === 'undefined' || !action.length || !action[0]) {\n                var errStr = '';\n                expected = [];\n                for (p in table[state]) {\n                    if (this.terminals_[p] && p > TERROR) {\n                        expected.push('\\'' + this.terminals_[p] + '\\'');\n                    }\n                }\n                if (lexer.showPosition) {\n                    errStr = 'Parse error on line ' + (yylineno + 1) + ':\\n' + lexer.showPosition() + '\\nExpecting ' + expected.join(', ') + ', got \\'' + (this.terminals_[symbol] || symbol) + '\\'';\n                } else {\n                    errStr = 'Parse error on line ' + (yylineno + 1) + ': Unexpected ' + (symbol == EOF ? 'end of input' : '\\'' + (this.terminals_[symbol] || symbol) + '\\'');\n                }\n                this.parseError(errStr, {\n                    text: lexer.match,\n                    token: this.terminals_[symbol] || symbol,\n                    line: lexer.yylineno,\n                    loc: yyloc,\n                    expected: expected\n                });\n            }\n        if (action[0] instanceof Array && action.length > 1) {\n            throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);\n        }\n        switch (action[0]) {\n        case 1:\n            stack.push(symbol);\n            vstack.push(lexer.yytext);\n            lstack.push(lexer.yylloc);\n            stack.push(action[1]);\n            symbol = null;\n            if (!preErrorSymbol) {\n                yyleng = lexer.yyleng;\n                yytext = lexer.yytext;\n                yylineno = lexer.yylineno;\n                yyloc = lexer.yylloc;\n                if (recovering > 0) {\n                    recovering--;\n                }\n            } else {\n                symbol = preErrorSymbol;\n                preErrorSymbol = null;\n            }\n            break;\n        case 2:\n            len = this.productions_[action[1]][1];\n            yyval.$ = vstack[vstack.length - len];\n            yyval._$ = {\n                first_line: lstack[lstack.length - (len || 1)].first_line,\n                last_line: lstack[lstack.length - 1].last_line,\n                first_column: lstack[lstack.length - (len || 1)].first_column,\n                last_column: lstack[lstack.length - 1].last_column\n            };\n            if (ranges) {\n                yyval._$.range = [\n                    lstack[lstack.length - (len || 1)].range[0],\n                    lstack[lstack.length - 1].range[1]\n                ];\n            }\n            r = this.performAction.apply(yyval, [\n                yytext,\n                yyleng,\n                yylineno,\n                sharedState.yy,\n                action[1],\n                vstack,\n                lstack\n            ].concat(args));\n            if (typeof r !== 'undefined') {\n                return r;\n            }\n            if (len) {\n                stack = stack.slice(0, -1 * len * 2);\n                vstack = vstack.slice(0, -1 * len);\n                lstack = lstack.slice(0, -1 * len);\n            }\n            stack.push(this.productions_[action[1]][0]);\n            vstack.push(yyval.$);\n            lstack.push(yyval._$);\n            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];\n            stack.push(newState);\n            break;\n        case 3:\n            return true;\n        }\n    }\n    return true;\n}};\n/* generated by jison-lex 0.3.4 */\nvar lexer = (function(){\nvar lexer = ({\n\nEOF:1,\n\nparseError:function parseError(str, hash) {\n        if (this.yy.parser) {\n            this.yy.parser.parseError(str, hash);\n        } else {\n            throw new Error(str);\n        }\n    },\n\n// resets the lexer, sets new input\nsetInput:function (input, yy) {\n        this.yy = yy || this.yy || {};\n        this._input = input;\n        this._more = this._backtrack = this.done = false;\n        this.yylineno = this.yyleng = 0;\n        this.yytext = this.matched = this.match = '';\n        this.conditionStack = ['INITIAL'];\n        this.yylloc = {\n            first_line: 1,\n            first_column: 0,\n            last_line: 1,\n            last_column: 0\n        };\n        if (this.options.ranges) {\n            this.yylloc.range = [0,0];\n        }\n        this.offset = 0;\n        return this;\n    },\n\n// consumes and returns one char from the input\ninput:function () {\n        var ch = this._input[0];\n        this.yytext += ch;\n        this.yyleng++;\n        this.offset++;\n        this.match += ch;\n        this.matched += ch;\n        var lines = ch.match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno++;\n            this.yylloc.last_line++;\n        } else {\n            this.yylloc.last_column++;\n        }\n        if (this.options.ranges) {\n            this.yylloc.range[1]++;\n        }\n\n        this._input = this._input.slice(1);\n        return ch;\n    },\n\n// unshifts one char (or a string) into the input\nunput:function (ch) {\n        var len = ch.length;\n        var lines = ch.split(/(?:\\r\\n?|\\n)/g);\n\n        this._input = ch + this._input;\n        this.yytext = this.yytext.substr(0, this.yytext.length - len);\n        //this.yyleng -= len;\n        this.offset -= len;\n        var oldLines = this.match.split(/(?:\\r\\n?|\\n)/g);\n        this.match = this.match.substr(0, this.match.length - 1);\n        this.matched = this.matched.substr(0, this.matched.length - 1);\n\n        if (lines.length - 1) {\n            this.yylineno -= lines.length - 1;\n        }\n        var r = this.yylloc.range;\n\n        this.yylloc = {\n            first_line: this.yylloc.first_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.first_column,\n            last_column: lines ?\n                (lines.length === oldLines.length ? this.yylloc.first_column : 0)\n                 + oldLines[oldLines.length - lines.length].length - lines[0].length :\n              this.yylloc.first_column - len\n        };\n\n        if (this.options.ranges) {\n            this.yylloc.range = [r[0], r[0] + this.yyleng - len];\n        }\n        this.yyleng = this.yytext.length;\n        return this;\n    },\n\n// When called from action, caches matched text and appends it on next action\nmore:function () {\n        this._more = true;\n        return this;\n    },\n\n// When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.\nreject:function () {\n        if (this.options.backtrack_lexer) {\n            this._backtrack = true;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n\n        }\n        return this;\n    },\n\n// retain first n characters of the match\nless:function (n) {\n        this.unput(this.match.slice(n));\n    },\n\n// displays already matched input, i.e. for error messages\npastInput:function () {\n        var past = this.matched.substr(0, this.matched.length - this.match.length);\n        return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\\n/g, \"\");\n    },\n\n// displays upcoming input, i.e. for error messages\nupcomingInput:function () {\n        var next = this.match;\n        if (next.length < 20) {\n            next += this._input.substr(0, 20-next.length);\n        }\n        return (next.substr(0,20) + (next.length > 20 ? '...' : '')).replace(/\\n/g, \"\");\n    },\n\n// displays the character position where the lexing error occurred, i.e. for error messages\nshowPosition:function () {\n        var pre = this.pastInput();\n        var c = new Array(pre.length + 1).join(\"-\");\n        return pre + this.upcomingInput() + \"\\n\" + c + \"^\";\n    },\n\n// test the lexed token: return FALSE when not a match, otherwise return token\ntest_match:function(match, indexed_rule) {\n        var token,\n            lines,\n            backup;\n\n        if (this.options.backtrack_lexer) {\n            // save context\n            backup = {\n                yylineno: this.yylineno,\n                yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                },\n                yytext: this.yytext,\n                match: this.match,\n                matches: this.matches,\n                matched: this.matched,\n                yyleng: this.yyleng,\n                offset: this.offset,\n                _more: this._more,\n                _input: this._input,\n                yy: this.yy,\n                conditionStack: this.conditionStack.slice(0),\n                done: this.done\n            };\n            if (this.options.ranges) {\n                backup.yylloc.range = this.yylloc.range.slice(0);\n            }\n        }\n\n        lines = match[0].match(/(?:\\r\\n?|\\n).*/g);\n        if (lines) {\n            this.yylineno += lines.length;\n        }\n        this.yylloc = {\n            first_line: this.yylloc.last_line,\n            last_line: this.yylineno + 1,\n            first_column: this.yylloc.last_column,\n            last_column: lines ?\n                         lines[lines.length - 1].length - lines[lines.length - 1].match(/\\r?\\n?/)[0].length :\n                         this.yylloc.last_column + match[0].length\n        };\n        this.yytext += match[0];\n        this.match += match[0];\n        this.matches = match;\n        this.yyleng = this.yytext.length;\n        if (this.options.ranges) {\n            this.yylloc.range = [this.offset, this.offset += this.yyleng];\n        }\n        this._more = false;\n        this._backtrack = false;\n        this._input = this._input.slice(match[0].length);\n        this.matched += match[0];\n        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);\n        if (this.done && this._input) {\n            this.done = false;\n        }\n        if (token) {\n            return token;\n        } else if (this._backtrack) {\n            // recover context\n            for (var k in backup) {\n                this[k] = backup[k];\n            }\n            return false; // rule action called reject() implying the next rule should be tested instead.\n        }\n        return false;\n    },\n\n// return next match in input\nnext:function () {\n        if (this.done) {\n            return this.EOF;\n        }\n        if (!this._input) {\n            this.done = true;\n        }\n\n        var token,\n            match,\n            tempMatch,\n            index;\n        if (!this._more) {\n            this.yytext = '';\n            this.match = '';\n        }\n        var rules = this._currentRules();\n        for (var i = 0; i < rules.length; i++) {\n            tempMatch = this._input.match(this.rules[rules[i]]);\n            if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {\n                match = tempMatch;\n                index = i;\n                if (this.options.backtrack_lexer) {\n                    token = this.test_match(tempMatch, rules[i]);\n                    if (token !== false) {\n                        return token;\n                    } else if (this._backtrack) {\n                        match = false;\n                        continue; // rule action called reject() implying a rule MISmatch.\n                    } else {\n                        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n                        return false;\n                    }\n                } else if (!this.options.flex) {\n                    break;\n                }\n            }\n        }\n        if (match) {\n            token = this.test_match(match, rules[index]);\n            if (token !== false) {\n                return token;\n            }\n            // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)\n            return false;\n        }\n        if (this._input === \"\") {\n            return this.EOF;\n        } else {\n            return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\\n' + this.showPosition(), {\n                text: \"\",\n                token: null,\n                line: this.yylineno\n            });\n        }\n    },\n\n// return next match that has a token\nlex:function lex () {\n        var r = this.next();\n        if (r) {\n            return r;\n        } else {\n            return this.lex();\n        }\n    },\n\n// activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)\nbegin:function begin (condition) {\n        this.conditionStack.push(condition);\n    },\n\n// pop the previously active lexer condition state off the condition stack\npopState:function popState () {\n        var n = this.conditionStack.length - 1;\n        if (n > 0) {\n            return this.conditionStack.pop();\n        } else {\n            return this.conditionStack[0];\n        }\n    },\n\n// produce the lexer rule set which is active for the currently active lexer condition state\n_currentRules:function _currentRules () {\n        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {\n            return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;\n        } else {\n            return this.conditions[\"INITIAL\"].rules;\n        }\n    },\n\n// return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available\ntopState:function topState (n) {\n        n = this.conditionStack.length - 1 - Math.abs(n || 0);\n        if (n >= 0) {\n            return this.conditionStack[n];\n        } else {\n            return \"INITIAL\";\n        }\n    },\n\n// alias for begin(condition)\npushState:function pushState (condition) {\n        this.begin(condition);\n    },\n\n// return the number of states currently on the stack\nstateStackSize:function stateStackSize() {\n        return this.conditionStack.length;\n    },\noptions: {},\nperformAction: function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {\nvar YYSTATE=YY_START;\nswitch($avoiding_name_collisions) {\ncase 0:/* skip whitespace */\nbreak;\ncase 1:return 18\nbreak;\ncase 2:return 19\nbreak;\ncase 3:return 20\nbreak;\ncase 4:return 21\nbreak;\ncase 5:return 22\nbreak;\ncase 6:return 23\nbreak;\ncase 7:return 24\nbreak;\ncase 8:return 25\nbreak;\ncase 9:return 26\nbreak;\ncase 10:return 27\nbreak;\ncase 11:return 28\nbreak;\ncase 12:return 29\nbreak;\ncase 13:return 30\nbreak;\ncase 14:return 31\nbreak;\ncase 15:return 32\nbreak;\ncase 16:return 33\nbreak;\ncase 17:return 34\nbreak;\ncase 18:return 35\nbreak;\ncase 19:return 11\nbreak;\ncase 20:return 10\nbreak;\ncase 21:return 16;\nbreak;\ncase 22:return 68\nbreak;\ncase 23:return 66\nbreak;\ncase 24:return 59\nbreak;\ncase 25:return 82\nbreak;\ncase 26:return 85\nbreak;\ncase 27:return 86\nbreak;\ncase 28:return 87\nbreak;\ncase 29:return 80\nbreak;\ncase 30:return 60\nbreak;\ncase 31:return 61\nbreak;\ncase 32:return 62\nbreak;\ncase 33:return 63\nbreak;\ncase 34:return 64\nbreak;\ncase 35:return 77\nbreak;\ncase 36:return 78\nbreak;\ncase 37:return 79\nbreak;\ncase 38:return 71\nbreak;\ncase 39:return 72\nbreak;\ncase 40:return 75\nbreak;\ncase 41:return 76\nbreak;\ncase 42:return 65\nbreak;\ncase 43:return 67\nbreak;\ncase 44:return 69\nbreak;\ncase 45:return 70\nbreak;\ncase 46:return 73\nbreak;\ncase 47:return 74\nbreak;\ncase 48:return 52\nbreak;\ncase 49:return 17\nbreak;\ncase 50:return 81;\nbreak;\ncase 51:return 9\nbreak;\ncase 52:return 90\nbreak;\ncase 53:return 91\nbreak;\ncase 54:return 89\nbreak;\ncase 55:return 57\nbreak;\ncase 56:return 88\nbreak;\ncase 57:return 53\nbreak;\ncase 58:return 55\nbreak;\ncase 59:return 'INVALID'\nbreak;\ncase 60:return 5\nbreak;\n}\n},\nrules: [/^(?:\\s+)/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Pp])([Xx]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Ee])([Mm]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Rr])([Ee])([Mm]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Vv])([Hh]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Vv])([Ww]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Vv])([Mm])([Ii])([Nn]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Vv])([Mm])([Aa])([Xx]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Cc])([Mm]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Mm])([Mm]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Qq]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Ii])([Nn]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Pp])([Cc]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Pp])([Tt]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Dd])([Ee])([Gg]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Rr])([Aa])([Dd]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Gg])([Rr])([Aa])([Dd]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Mm])([Ss]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)([Ss]))/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)%)/,/^(?:([+-]?[0-9]+(\\.[0-9]+)?([eE][+\\-]?[0-9]+)?|[+-]?\\.[0-9]+([eE][+\\-]?[0-9]+)?)\\b)/,/^(?:#([a-fA-F0-9]+))/,/^(?:([Aa])([Tt]))/,/^(?:([Rr])([Oo])([Uu])([Nn])([Dd]))/,/^(?:([Uu])([Rr])([Ll])\\()/,/^(?:([Cc])([Aa])([Ll])([Cc])\\()/,/^(?:([Mm])([Ii])([Nn])\\()/,/^(?:([Mm])([Aa])([Xx])\\()/,/^(?:([Cc])([Ll])([Aa])([Mm])([Pp])\\()/,/^(?:([Vv])([Aa])([Rr])\\()/,/^(?:([Tt])([Rr])([Aa])([Nn])([Ss])([Ll])([Aa])([Tt])([Ee])\\()/,/^(?:([Tt])([Rr])([Aa])([Nn])([Ss])([Ll])([Aa])([Tt])([Ee])([Xx])\\()/,/^(?:([Tt])([Rr])([Aa])([Nn])([Ss])([Ll])([Aa])([Tt])([Ee])([Yy])\\()/,/^(?:([Tt])([Rr])([Aa])([Nn])([Ss])([Ll])([Aa])([Tt])([Ee])([Zz])\\()/,/^(?:([Tt])([Rr])([Aa])([Nn])([Ss])([Ll])([Aa])([Tt])([Ee])3([Dd])\\()/,/^(?:([Rr])([Aa])([Nn])([Dd])\\()/,/^(?:([Ii])([Nn])([Dd])([Ee])([Xx])\\()/,/^(?:([Ll])([Ee])([Nn])([Gg])([Tt])([Hh])\\()/,/^(?:([Ww])([Ii])([Dd])([Tt])([Hh])\\()/,/^(?:([Hh])([Ee])([Ii])([Gg])([Hh])([Tt])\\()/,/^(?:([Cc])([Ll])([Oo])([Ss])([Ee])([Ss])([Tt])\\()/,/^(?:([Nn])([Uu])([Mm])\\()/,/^(?:([Ii])([Nn])([Ss])([Ee])([Tt])\\()/,/^(?:([Cc])([Ii])([Rr])([Cc])([Ll])([Ee])\\()/,/^(?:([Ee])([Ll])([Ll])([Ii])([Pp])([Ss])([Ee])\\()/,/^(?:([Pp])([Oo])([Ll])([Yy])([Gg])([Oo])([Nn])\\()/,/^(?:([Xx])\\()/,/^(?:([Yy])\\()/,/^(?:(-?[a-zA-Z_][\\-a-zA-Z0-9_]*)\\()/,/^(?:(-?[a-zA-Z_][\\-a-zA-Z0-9_]*))/,/^(?:--(-?[a-zA-Z_][\\-a-zA-Z0-9_]*))/,/^(?:('[^\\']*'|\"[^\\\"]*\"))/,/^(?:\\+)/,/^(?:-)/,/^(?:\\*)/,/^(?:\\/)/,/^(?:\\()/,/^(?:\\))/,/^(?:,)/,/^(?:.)/,/^(?:$)/],\nconditions: {\"INITIAL\":{\"rules\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],\"inclusive\":true}}\n});\nreturn lexer;\n})();\nparser.lexer = lexer;\nfunction Parser () {\n  this.yy = {};\n}\nParser.prototype = parser;parser.Parser = Parser;\nreturn new Parser;\n})();\n\nexport const cssParser = parser;\n", "import {cssParser as parser} from '#build/parsers/css-expr-impl';\n\n/**\n * @param {string} cssString\n * @return {?./css-expr-ast.CssNode}\n */\nexport function parseCss(cssString) {\n  return parser.parse(cssString);\n}\n", "import {endsWith} from '#core/types/string';\nimport {getWin} from '#core/window';\n\n/**\n * Finds and extracts keyframes definition for Web Animations from CSS styles.\n * @param {!Document|!ShadowRoot} rootNode\n * @param {string} name\n * @return {?../web-animation-types.WebKeyframesDef}\n */\nexport function extractKeyframes(rootNode, name) {\n  const {styleSheets} = rootNode;\n  if (!styleSheets) {\n    return null;\n  }\n  const win = getWin(rootNode);\n  // Go from the last to first since the last rule wins in CSS.\n  for (let i = styleSheets.length - 1; i >= 0; i--) {\n    const keyframes = scanStyle(\n      win,\n      /** @type {!CSSStyleSheet} */ (styleSheets[i]),\n      name\n    );\n    if (keyframes) {\n      return keyframes;\n    }\n  }\n  return null;\n}\n\n/**\n * @param {!Window} win\n * @param {!CSSStyleSheet} styleSheet\n * @param {string} name\n * @return {?../web-animation-types.WebKeyframesDef}\n */\nfunction scanStyle(win, styleSheet, name) {\n  // No rules, e.g. a font.\n  if (!styleSheet.cssRules) {\n    return null;\n  }\n\n  const styleNode = styleSheet.ownerNode;\n  if (!styleNode) {\n    return null;\n  }\n  // Exlcude AMP's own styles.\n  if (\n    !styleNode.hasAttribute('amp-custom') &&\n    !styleNode.hasAttribute('amp-keyframes')\n  ) {\n    return null;\n  }\n\n  return scanRules(win, styleSheet.cssRules, name);\n}\n\n/**\n * @param {!Window} win\n * @param {!CSSRuleList} rules\n * @param {string} name\n * @return {?../web-animation-types.WebKeyframesDef}\n */\nfunction scanRules(win, rules, name) {\n  // Go backwards since in CSS the last one wins.\n  for (let i = rules.length - 1; i >= 0; i--) {\n    const rule = rules[i];\n    if (rule.type == /* CSSKeyframesRule */ 7) {\n      const keyframesRule = /** @type {!CSSKeyframesRule} */ (rule);\n      if (rule.name == name && isEnabled(win, rule)) {\n        return buildKeyframes(keyframesRule);\n      }\n    } else if (\n      rule.type == /* CSSMediaRule */ 4 ||\n      rule.type == /* CSSSupportsRule */ 12\n    ) {\n      // Go recursively inside. The media/supports match will be checked only\n      // when the corresponding @keyframes have been found.\n      const found = scanRules(win, rule.cssRules, name);\n      if (found) {\n        return found;\n      }\n    }\n  }\n  return null;\n}\n\n/**\n * @param {!Window} win\n * @param {!CSSRule} rule\n * @return {boolean}\n */\nfunction isEnabled(win, rule) {\n  // Try rule itself.\n  if (rule.media && rule.media.mediaText) {\n    const enabled = win.matchMedia(rule.media.mediaText).matches;\n    if (!enabled) {\n      return false;\n    }\n  }\n  if (rule.type == /* CSSSupportsRule */ 12) {\n    if (\n      !win.CSS ||\n      !win.CSS.supports ||\n      !win.CSS.supports(/** @type {!CSSSupportsRule} */ (rule).conditionText)\n    ) {\n      return false;\n    }\n  }\n\n  // Check the parents.\n  if (rule.parentRule) {\n    return isEnabled(win, rule.parentRule);\n  }\n  return true;\n}\n\n/**\n * @param {!CSSKeyframesRule} keyframesRule\n * @return {!../web-animation-types.WebKeyframesDef}\n */\nfunction buildKeyframes(keyframesRule) {\n  const array = [];\n  for (let i = 0; i < keyframesRule.cssRules.length; i++) {\n    const keyframeRule = /** @type {!CSSKeyframeRule} */ (\n      keyframesRule.cssRules[i]\n    );\n    const keyframe = {};\n    keyframe['offset'] =\n      keyframeRule.keyText == 'from'\n        ? 0\n        : keyframeRule.keyText == 'to'\n        ? 1\n        : parseFloat(keyframeRule.keyText) / 100;\n    const {style} = keyframeRule;\n    for (let j = 0; j < style.length; j++) {\n      const styleName = style[j];\n      let propName = styleName;\n      if (endsWith(styleName, 'animation-timing-function')) {\n        propName = 'easing';\n      }\n      keyframe[propName] = style[styleName];\n    }\n    array.push(keyframe);\n  }\n  return array;\n}\n", "import {removeItem} from '#core/types/array';\n\n/**\n * This class helps to manage observers. Observers can be added, removed or\n * fired through and instance of this class.\n * @template TYPE\n */\nexport class Observable {\n  /**\n   * Creates an instance of Observable.\n   */\n  constructor() {\n    /** @type {?Array<function(TYPE)>} */\n    this.handlers_ = null;\n  }\n\n  /**\n   * Adds the observer to this instance.\n   * @param {function(TYPE)} handler Observer's handler.\n   * @return {!UnlistenDef}\n   */\n  add(handler) {\n    if (!this.handlers_) {\n      this.handlers_ = [];\n    }\n    this.handlers_.push(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  /**\n   * Removes the observer from this instance.\n   * @param {function(TYPE)} handler Observer's instance.\n   */\n  remove(handler) {\n    if (!this.handlers_) {\n      return;\n    }\n    removeItem(this.handlers_, handler);\n  }\n\n  /**\n   * Removes all observers.\n   */\n  removeAll() {\n    if (!this.handlers_) {\n      return;\n    }\n    this.handlers_.length = 0;\n  }\n\n  /**\n   * Fires an event. All observers are called.\n   * @param {TYPE=} opt_event\n   */\n  fire(opt_event) {\n    if (!this.handlers_) {\n      return;\n    }\n    for (const handler of this.handlers_) {\n      handler(opt_event);\n    }\n  }\n\n  /**\n   * Returns number of handlers. Mostly needed for tests.\n   * @return {number}\n   */\n  getHandlerCount() {\n    return this.handlers_?.length ?? 0;\n  }\n}\n", "import {\n  WebAnimationPlayState, // eslint-disable-line no-unused-vars\n} from '../web-animation-types';\n\n/**\n */\nexport class AnimationRunner {\n  /**\n   * @param {!Array<!../web-animation-types.InternalWebAnimationRequestDef>} requests\n   */\n  constructor(requests) {\n    /** @const @protected */\n    this.requests_ = requests;\n  }\n\n  /**\n   * @return {!WebAnimationPlayState}\n   */\n  getPlayState() {}\n\n  /**\n   * @param {function(!WebAnimationPlayState)} unusedHandler\n   * @return {!UnlistenDef}\n   */\n  onPlayStateChanged(unusedHandler) {}\n\n  /**\n   * Initializes the players but does not change the state.\n   */\n  init() {}\n\n  /**\n   * Initializes the players if not already initialized,\n   * and starts playing the animations.\n   */\n  start() {}\n\n  /**\n   */\n  pause() {}\n\n  /**\n   */\n  resume() {}\n\n  /**\n   */\n  reverse() {}\n\n  /**\n   * @param {time} unusedTime\n   */\n  seekTo(unusedTime) {}\n\n  /**\n   * Seeks to a relative position within the animation timeline given a\n   * percentage (0 to 1 number).\n   * @param {number} unusedPercent between 0 and 1\n   */\n  seekToPercent(unusedPercent) {}\n\n  /**\n   * @param {bool} unusedPauseOnError\n   */\n  finish(unusedPauseOnError = false) {}\n\n  /**\n   */\n  cancel() {}\n}\n", "import {userAssert} from '#utils/log';\n\n/**\n * @param {!Array<!../web-animation-types.InternalWebAnimationRequestDef>} requests\n * @return {number} total duration in milliseconds.\n * @throws {Error} If timeline is infinite.\n */\nexport function getTotalDuration(requests) {\n  let maxTotalDuration = 0;\n  for (let i = 0; i < requests.length; i++) {\n    const {timing} = requests[i];\n\n    userAssert(\n      isFinite(timing.iterations),\n      'Animation has infinite ' +\n        'timeline, we can not seek to a relative position within an infinite ' +\n        'timeline. Use \"time\" for seekTo or remove infinite iterations'\n    );\n\n    const iteration = timing.iterations - timing.iterationStart;\n    const totalDuration =\n      timing.duration * iteration + timing.delay + timing.endDelay;\n\n    if (totalDuration > maxTotalDuration) {\n      maxTotalDuration = totalDuration;\n    }\n  }\n\n  return maxTotalDuration;\n}\n", "import {Observable} from '#core/data-structures/observable';\nimport {assertDoesNotContainDisplay, setStyles} from '#core/dom/style';\n\nimport {devAssert} from '#utils/log';\n\nimport {AnimationRunner} from './animation-runner';\nimport {getTotalDuration} from './utils';\n\nimport {\n  WebAnimationDef,\n  WebAnimationPlayState,\n  WebAnimationSelectorDef,\n  WebAnimationSubtargetDef,\n  WebAnimationTimingDef,\n  WebCompAnimationDef,\n  WebKeyframeAnimationDef,\n  WebKeyframesDef,\n  WebMultiAnimationDef,\n  WebSwitchAnimationDef,\n} from '../web-animation-types';\n\n/**\n */\nexport class NativeWebAnimationRunner extends AnimationRunner {\n  /**\n   * @param {!Array<!../web-animation-types.InternalWebAnimationRequestDef>} requests\n   */\n  constructor(requests) {\n    super(requests);\n\n    /** @protected {?Array<!Animation>} */\n    this.players_ = null;\n\n    /** @private {number} */\n    this.runningCount_ = 0;\n\n    /** @private {!WebAnimationPlayState} */\n    this.playState_ = WebAnimationPlayState.IDLE;\n\n    /** @private {!Observable} */\n    this.playStateChangedObservable_ = new Observable();\n  }\n\n  /**\n   * @override\n   * @return {!WebAnimationPlayState}\n   */\n  getPlayState() {\n    return this.playState_;\n  }\n\n  /**\n   * @override\n   * @param {function(!WebAnimationPlayState)} handler\n   * @return {!UnlistenDef}\n   */\n  onPlayStateChanged(handler) {\n    return this.playStateChangedObservable_.add(handler);\n  }\n\n  /**\n   * @override\n   * Initializes the players but does not change the state.\n   */\n  init() {\n    devAssert(!this.players_);\n    this.players_ = this.requests_.map((request) => {\n      // Apply vars.\n      if (request.vars) {\n        setStyles(request.target, assertDoesNotContainDisplay(request.vars));\n      }\n      const player = request.target.animate(\n        /** @type {!Array<Object>} */ (request.keyframes),\n        /** @type {KeyframeAnimationOptions} */ (request.timing)\n      );\n      player.pause();\n      return player;\n    });\n    this.runningCount_ = this.players_.length;\n    this.players_.forEach((player) => {\n      player.onfinish = () => {\n        this.runningCount_--;\n        if (this.runningCount_ == 0) {\n          this.setPlayState_(WebAnimationPlayState.FINISHED);\n        }\n      };\n    });\n  }\n\n  /**\n   * @override\n   * Initializes the players if not already initialized,\n   * and starts playing the animations.\n   */\n  start() {\n    if (!this.players_) {\n      this.init();\n    }\n    this.resume();\n  }\n\n  /**\n   * @override\n   */\n  pause() {\n    devAssert(this.players_);\n    this.setPlayState_(WebAnimationPlayState.PAUSED);\n    this.players_.forEach((player) => {\n      if (player.playState == WebAnimationPlayState.RUNNING) {\n        player.pause();\n      }\n    });\n  }\n\n  /**\n   * @override\n   */\n  resume() {\n    devAssert(this.players_);\n    const oldRunnerPlayState = this.playState_;\n    if (oldRunnerPlayState == WebAnimationPlayState.RUNNING) {\n      return;\n    }\n    this.setPlayState_(WebAnimationPlayState.RUNNING);\n    this.runningCount_ = 0;\n    this.players_.forEach((player) => {\n      /**\n       * TODO(gharbiw):\n       * The playState on Safari and Edge sometimes gets stuck on\n       * the PENDING state (particularly when the animation's visibility\n       * gets toggled) so we add an exception to play even if the state\n       * is PENDING. Need to investigate why this happens, fix it and\n       * remove the exception below.\n       */\n      if (\n        oldRunnerPlayState != WebAnimationPlayState.PAUSED ||\n        player.playState == WebAnimationPlayState.PAUSED ||\n        player.playState == WebAnimationPlayState.PENDING\n      ) {\n        player.play();\n        this.runningCount_++;\n      }\n    });\n  }\n\n  /**\n   * @override\n   */\n  reverse() {\n    devAssert(this.players_);\n    // TODO(nainar) there is no reverse call on WorkletAnimation\n    this.players_.forEach((player) => {\n      player.reverse();\n    });\n  }\n\n  /**\n   * @override\n   * @param {time} time\n   */\n  seekTo(time) {\n    if (!this.players_) {\n      return;\n    }\n    this.setPlayState_(WebAnimationPlayState.PAUSED);\n    this.players_.forEach((player) => {\n      player.pause();\n      player.currentTime = time;\n    });\n  }\n\n  /**\n   * @override\n   * Seeks to a relative position within the animation timeline given a\n   * percentage (0 to 1 number).\n   * @param {number} percent between 0 and 1\n   */\n  seekToPercent(percent) {\n    devAssert(percent >= 0 && percent <= 1);\n    const totalDuration = this.getTotalDuration_();\n    const time = totalDuration * percent;\n    this.seekTo(time);\n  }\n\n  /**\n   * @override\n   */\n  finish(pauseOnError = false) {\n    if (!this.players_) {\n      return;\n    }\n    const players = this.players_;\n    this.players_ = null;\n    this.setPlayState_(WebAnimationPlayState.FINISHED);\n    players.forEach((player) => {\n      if (pauseOnError) {\n        try {\n          // Will fail if animation is infinite, in that case we pause it.\n          player.finish();\n        } catch (error) {\n          player.pause();\n        }\n      } else {\n        player.finish();\n      }\n    });\n  }\n\n  /**\n   * @override\n   */\n  cancel() {\n    if (!this.players_) {\n      return;\n    }\n    this.setPlayState_(WebAnimationPlayState.IDLE);\n    this.players_.forEach((player) => {\n      player.cancel();\n    });\n  }\n\n  /**\n   * @param {!WebAnimationPlayState} playState\n   * @private\n   */\n  setPlayState_(playState) {\n    if (this.playState_ != playState) {\n      this.playState_ = playState;\n      this.playStateChangedObservable_.fire(this.playState_);\n    }\n  }\n\n  /**\n   * @return {number} total duration in milliseconds.\n   * @throws {Error} If timeline is infinite.\n   */\n  getTotalDuration_() {\n    return getTotalDuration(this.requests_);\n  }\n}\n", "import {assertDoesNotContainDisplay, px, setStyles} from '#core/dom/style';\n\nimport {Services} from '#service';\n\nimport {dev} from '#utils/log';\n\nimport {AnimationRunner} from './animation-runner';\nimport {getTotalDuration} from './utils';\n\nconst moduleName = 'amp-animation-worklet';\nlet workletModulePromise;\n\n/**\n */\nexport class ScrollTimelineWorkletRunner extends AnimationRunner {\n  /**\n   * @param {!Window} win\n   * @param {!Array<!../web-animation-types.InternalWebAnimationRequestDef>} requests\n   * @param {!JsonObject} viewportData\n   */\n  constructor(win, requests, viewportData) {\n    super(requests);\n\n    /** @const @private */\n    this.win_ = win;\n\n    /** @protected {?Array<!WorkletAnimation>} */\n    this.players_ = [];\n\n    /** @private {number} */\n    this.startScrollOffset_ = viewportData['start-scroll-offset'];\n\n    /** @private {number} */\n    this.endScrollOffset_ = viewportData['end-scroll-offset'];\n\n    /** @private {number} */\n    this.initialInViewPercent_ = viewportData['initial-inview-percent'];\n  }\n\n  /**\n   * @override\n   * Initializes the players but does not change the state.\n   * @suppress {missingProperties}\n   */\n  init() {\n    const {documentElement} = this.win_.document;\n    const viewportService = Services.viewportForDoc(documentElement);\n    const scrollSource = viewportService.getScrollingElement();\n\n    const timeRange = getTotalDuration(this.requests_);\n    const adjustedTimeRange = (1 - this.initialInViewPercent_) * timeRange;\n    const initialElementOffset = this.initialInViewPercent_ * timeRange;\n\n    this.requests_.map((request) => {\n      // Apply vars.\n      if (request.vars) {\n        setStyles(request.target, assertDoesNotContainDisplay(request.vars));\n      }\n      getOrAddWorkletModule(this.win_).then(\n        () => {\n          const scrollTimeline = new this.win_.ScrollTimeline({\n            scrollSource,\n            orientation: 'block',\n            startScrollOffset: `${px(this.startScrollOffset_)}`,\n            endScrollOffset: `${px(this.endScrollOffset_)}`,\n            timeRange: adjustedTimeRange,\n            fill: 'both',\n          });\n          const keyframeEffect = new KeyframeEffect(\n            request.target,\n            request.keyframes,\n            /** @type {AnimationEffectTimingProperties} */ (request.timing)\n          );\n          const player = new this.win_.WorkletAnimation(\n            `${moduleName}`,\n            [keyframeEffect],\n            scrollTimeline,\n            {\n              'initial-element-offset': initialElementOffset,\n            }\n          );\n          player.play();\n          this.players_.push(player);\n        },\n        (e) => {\n          dev().error('AMP-ANIMATION', e);\n        }\n      );\n    });\n  }\n\n  /**\n   * @override\n   * Initializes the players if not already initialized,\n   * and starts playing the animations.\n   */\n  start() {\n    if (!this.players_) {\n      this.init();\n    }\n  }\n\n  /**\n   * @override\n   */\n  cancel() {\n    if (!this.players_) {\n      return;\n    }\n    this.players_.forEach((player) => {\n      player.cancel();\n    });\n  }\n}\n\n/**\n * @param {!Window} win\n * @private\n * @return {*} TODO(#23582): Specify return type\n */\nfunction getOrAddWorkletModule(win) {\n  if (workletModulePromise) {\n    return workletModulePromise;\n  }\n  const blob = `registerAnimator('${moduleName}', class {\n    constructor(options = {\n      'current-element-offset': 0\n    }) {\n      console/*OK*/.info('Using animationWorklet ScrollTimeline');\n      this.initialElementOffset_ = options['initial-element-offset'];\n    }\n    animate(currentTime, effect) {\n      if (currentTime == NaN) {\n        return;\n      }\n      effect.localTime = currentTime + this.initialElementOffset_;\n    }\n  });\n  `;\n\n  workletModulePromise = win.CSS.animationWorklet.addModule(\n    URL.createObjectURL(new Blob([blob], {type: 'text/javascript'}))\n  );\n\n  return workletModulePromise;\n}\n", "import {map} from '#core/types/object';\n\n/**\n * @template T\n */\nexport class LruCache {\n  /**\n   * @param {number} capacity\n   */\n  constructor(capacity) {\n    /** @private @const {number} */\n    this.capacity_ = capacity;\n\n    /** @private {number} */\n    this.size_ = 0;\n\n    /**\n     * An incrementing counter to define the last access.\n     * @private {number}\n     */\n    this.access_ = 0;\n\n    /** @private {!Object<(number|string), {payload: T, access: number}>} */\n    this.cache_ = map();\n  }\n\n  /**\n   * Returns whether key is cached.\n   *\n   * @param {number|string} key\n   * @return {boolean}\n   */\n  has(key) {\n    return !!this.cache_[key];\n  }\n\n  /**\n   * @param {number|string} key\n   * @return {T} The cached payload.\n   */\n  get(key) {\n    const cacheable = this.cache_[key];\n    if (cacheable) {\n      cacheable.access = ++this.access_;\n      return cacheable.payload;\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {number|string} key\n   * @param {T} payload The payload to cache.\n   */\n  put(key, payload) {\n    if (!this.has(key)) {\n      this.size_++;\n    }\n    this.cache_[key] = {payload, access: this.access_};\n    this.evict_();\n  }\n\n  /**\n   * Evicts the oldest cache entry, if we've exceeded capacity.\n   */\n  evict_() {\n    if (this.size_ <= this.capacity_) {\n      return;\n    }\n\n    const cache = this.cache_;\n    let oldest = this.access_ + 1;\n    let oldestKey;\n    for (const key in cache) {\n      const {access} = cache[key];\n      if (access < oldest) {\n        oldest = access;\n        oldestKey = key;\n      }\n    }\n\n    if (oldestKey !== undefined) {\n      delete cache[oldestKey];\n      this.size_--;\n    }\n  }\n}\n", "import {LruCache} from '#core/data-structures/lru-cache';\nimport * as mode from '#core/mode';\nimport {arrayOrSingleItemToArray} from '#core/types/array';\nimport {dict, hasOwn} from '#core/types/object';\nimport {endsWith} from '#core/types/string';\nimport {parseQueryString} from '#core/types/string/url';\n\nimport {userAssert} from '#utils/log';\n\nimport {urls} from './config';\n\nconst SERVING_TYPE_PREFIX = new Set([\n  // No viewer\n  'c',\n  // In viewer\n  'v',\n  // Ad landing page\n  'a',\n  // Ad\n  'ad',\n]);\n\n/**\n * Cached a-tag to avoid memory allocation during URL parsing.\n * @type {HTMLAnchorElement}\n */\nlet cachedAnchorEl;\n\n/**\n * We cached all parsed URLs. As of now there are no use cases\n * of AMP docs that would ever parse an actual large number of URLs,\n * but we often parse the same one over and over again.\n * @type {LruCache}\n */\nlet urlCache;\n\n// eslint-disable-next-line no-script-url\nconst INVALID_PROTOCOLS = ['javascript:', 'data:', 'vbscript:'];\n\n/** @const {string} */\nexport const SOURCE_ORIGIN_PARAM = '__amp_source_origin';\n\n/**\n * Coerces a url into a location;\n * @function\n * @param {string|!Location} url\n * @return {!Location}\n */\nconst urlAsLocation = (url) =>\n  typeof url == 'string' ? parseUrlDeprecated(url) : url;\n\n/**\n * Returns the correct origin for a given window.\n * TODO(rcebulko): This really belongs under #core/window somewhere, not in url\n * @param {!Window} win\n * @return {string} origin\n */\nexport function getWinOrigin(win) {\n  return win.origin || parseUrlDeprecated(win.location.href).origin;\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * TODO(#34453): The URL constructor isn't supported in IE11, but is supported\n * everywhere else. There's a lot of code paths (and all uses of the LruCache)\n * that are built around this polyfill. Once we can drop IE11 support and just\n * use the URL constructor, we can clear out all of parseWithA, all the URL\n * cache logic (incl. additional caches in other call-sites). Most is guarded by\n * isEsm() and is only included in nomodule builds, but still.\n * @param {string} url\n * @param {boolean=} opt_nocache\n *   Cache is always ignored on ESM builds, see https://go.amp.dev/pr/31594\n * @return {!Location}\n */\nexport function parseUrlDeprecated(url, opt_nocache) {\n  if (!cachedAnchorEl) {\n    cachedAnchorEl = /** @type {!HTMLAnchorElement} */ (\n      self.document.createElement('a')\n    );\n    urlCache = mode.isEsm()\n      ? null\n      : self.__AMP_URL_CACHE || (self.__AMP_URL_CACHE = new LruCache(100));\n  }\n\n  return parseUrlWithA(\n    cachedAnchorEl,\n    url,\n    mode.isEsm() || opt_nocache ? null : urlCache\n  );\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {!HTMLAnchorElement} anchorEl\n * @param {string} url\n * @param {LruCache=} opt_cache\n *   Cache is always ignored on ESM builds, see https://go.amp.dev/pr/31594\n * @return {!Location}\n * @restricted\n */\nexport function parseUrlWithA(anchorEl, url, opt_cache) {\n  if (mode.isEsm()) {\n    // Doing this causes the <a> to auto-set its own href to the resolved path,\n    // which would be the baseUrl for the URL constructor.\n    anchorEl.href = '';\n    return /** @type {?} */ (new URL(url, anchorEl.href));\n  }\n\n  if (opt_cache && opt_cache.has(url)) {\n    return opt_cache.get(url);\n  }\n\n  anchorEl.href = url;\n\n  // IE11 doesn't provide full URL components when parsing relative URLs.\n  // Assigning to itself again does the trick #3449.\n  if (!anchorEl.protocol) {\n    anchorEl.href = anchorEl.href;\n  }\n\n  const info = /** @type {!Location} */ ({\n    href: anchorEl.href,\n    protocol: anchorEl.protocol,\n    host: anchorEl.host,\n    hostname: anchorEl.hostname,\n    port: anchorEl.port == '0' ? '' : anchorEl.port,\n    pathname: anchorEl.pathname,\n    search: anchorEl.search,\n    hash: anchorEl.hash,\n    origin: null, // Set below.\n  });\n\n  // Some IE11 specific polyfills.\n  // 1) IE11 strips out the leading '/' in the pathname.\n  if (info.pathname[0] !== '/') {\n    info.pathname = '/' + info.pathname;\n  }\n\n  // 2) For URLs with implicit ports, IE11 parses to default ports while\n  // other browsers leave the port field empty.\n  if (\n    (info.protocol == 'http:' && info.port == 80) ||\n    (info.protocol == 'https:' && info.port == 443)\n  ) {\n    info.port = '';\n    info.host = info.hostname;\n  }\n\n  // For data URI anchorEl.origin is equal to the string 'null' which is not useful.\n  // We instead return the actual origin which is the full URL.\n  let origin;\n  if (anchorEl.origin && anchorEl.origin != 'null') {\n    origin = anchorEl.origin;\n  } else if (info.protocol == 'data:' || !info.host) {\n    origin = info.href;\n  } else {\n    origin = info.protocol + '//' + info.host;\n  }\n  info.origin = origin;\n\n  // Freeze during testing to avoid accidental mutation.\n  const frozen = mode.isTest() && Object.freeze ? Object.freeze(info) : info;\n\n  if (opt_cache) {\n    opt_cache.put(url, frozen);\n  }\n\n  return frozen;\n}\n\n/**\n * Appends the string just before the fragment part (or optionally\n * to the front of the query string) of the URL.\n * @param {string} url\n * @param {string} paramString\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function appendEncodedParamStringToUrl(\n  url,\n  paramString,\n  opt_addToFront\n) {\n  if (!paramString) {\n    return url;\n  }\n  const mainAndFragment = url.split('#', 2);\n  const mainAndQuery = mainAndFragment[0].split('?', 2);\n\n  let newUrl =\n    mainAndQuery[0] +\n    (mainAndQuery[1]\n      ? opt_addToFront\n        ? `?${paramString}&${mainAndQuery[1]}`\n        : `?${mainAndQuery[1]}&${paramString}`\n      : `?${paramString}`);\n  newUrl += mainAndFragment[1] ? `#${mainAndFragment[1]}` : '';\n  return newUrl;\n}\n\n/**\n * @param {string} key\n * @param {string} value\n * @return {string}\n */\nfunction urlEncodeKeyValue(key, value) {\n  return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n}\n\n/**\n * Appends a query string field and value to a url. `key` and `value`\n * will be ran through `encodeURIComponent` before appending.\n * @param {string} url\n * @param {string} key\n * @param {string} value\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function addParamToUrl(url, key, value, opt_addToFront) {\n  return appendEncodedParamStringToUrl(\n    url,\n    urlEncodeKeyValue(key, value),\n    opt_addToFront\n  );\n}\n\n/**\n * Appends query string fields and values to a url. The `params` objects'\n * `key`s and `value`s will be transformed into query string keys/values.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addParamsToUrl(url, params) {\n  return appendEncodedParamStringToUrl(url, serializeQueryString(params));\n}\n\n/**\n * Append query string fields and values to a url, only if the key does not\n * exist in current query string.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addMissingParamsToUrl(url, params) {\n  const location = parseUrlDeprecated(url);\n  const existingParams = parseQueryString(location.search);\n  const paramsToAdd = dict({});\n  const keys = Object.keys(params);\n  for (let i = 0; i < keys.length; i++) {\n    if (!hasOwn(existingParams, keys[i])) {\n      paramsToAdd[keys[i]] = params[keys[i]];\n    }\n  }\n  return addParamsToUrl(url, paramsToAdd);\n}\n\n/**\n * Serializes the passed parameter map into a query string with both keys\n * and values encoded.\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function serializeQueryString(params) {\n  const s = [];\n  for (const k in params) {\n    let v = params[k];\n    if (v == null) {\n      continue;\n    }\n\n    v = arrayOrSingleItemToArray(v);\n    for (let i = 0; i < v.length; i++) {\n      s.push(urlEncodeKeyValue(k, v[i]));\n    }\n  }\n  return s.join('&');\n}\n\n/**\n * Returns `true` if the URL is secure: either HTTPS or localhost (for testing).\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isSecureUrlDeprecated(url) {\n  url = urlAsLocation(url);\n  return (\n    url.protocol == 'https:' ||\n    url.hostname == 'localhost' ||\n    url.hostname == '127.0.0.1' ||\n    endsWith(url.hostname, '.localhost')\n  );\n}\n\n/**\n * Asserts that a given url is HTTPS or protocol relative. It's a user-level\n * assert.\n *\n * Provides an exception for localhost.\n *\n * @param {?string|undefined} urlString\n * @param {!Element|string} elementContext Element where the url was found.\n * @param {string=} sourceName Used for error messages.\n * @return {string}\n */\nexport function assertHttpsUrl(\n  urlString,\n  elementContext,\n  sourceName = 'source'\n) {\n  userAssert(\n    urlString != null,\n    '%s %s must be available',\n    elementContext,\n    sourceName\n  );\n  userAssert(\n    isSecureUrlDeprecated(urlString) || /^\\/\\//.test(urlString),\n    '%s %s must start with ' +\n      '\"https://\" or \"//\" or be relative and served from ' +\n      'either https or from localhost. Invalid value: %s',\n    elementContext,\n    sourceName,\n    urlString\n  );\n  return urlString;\n}\n\n/**\n * Asserts that a given url is an absolute HTTP or HTTPS URL.\n * @param {string} urlString\n * @return {string}\n */\nexport function assertAbsoluteHttpOrHttpsUrl(urlString) {\n  userAssert(\n    /^https?\\:/i.test(urlString),\n    'URL must start with \"http://\" or \"https://\". Invalid value: %s',\n    urlString\n  );\n  return parseUrlDeprecated(urlString).href;\n}\n\n/**\n * Returns the URL without fragment. If URL doesn't contain fragment, the same\n * string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function removeFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return url;\n  }\n  return url.substring(0, index);\n}\n\n/**\n * Returns the fragment from the URL. If the URL doesn't contain fragment,\n * the empty string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function getFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return '';\n  }\n  return url.substring(index);\n}\n\n/**\n * Returns whether the URL has the origin of a proxy.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isProxyOrigin(url) {\n  return urls.cdnProxyRegex.test(urlAsLocation(url).origin);\n}\n\n/**\n * Returns whether the URL origin is localhost.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isLocalhostOrigin(url) {\n  return urls.localhostRegex.test(urlAsLocation(url).origin);\n}\n\n/**\n * @param {string} uri\n * @return {boolean}\n */\nexport function isAmpScriptUri(uri) {\n  return uri.startsWith('amp-script:');\n}\n\n/**\n * For proxy-origin URLs, returns the serving type. Otherwise, returns null.\n * E.g., 'https://amp-com.cdn.ampproject.org/a/s/amp.com/amp_document.html'\n * returns 'a'.\n * @param {string|!Location} url URL of an AMP document.\n * @return {?string}\n */\nexport function getProxyServingType(url) {\n  url = urlAsLocation(url);\n  if (!isProxyOrigin(url)) {\n    return null;\n  }\n  const path = url.pathname.split('/', 2);\n  return path[1];\n}\n\n/**\n * Returns whether the URL has valid protocol.\n * Deep link protocol is valid, but not javascript etc.\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isProtocolValid(url) {\n  return !(url && INVALID_PROTOCOLS.includes(urlAsLocation(url).protocol));\n}\n\n/**\n * Returns a URL without AMP JS parameters.\n * @param {string} url\n * @return {string}\n */\nexport function removeAmpJsParamsFromUrl(url) {\n  const {hash, origin, pathname, search} = parseUrlDeprecated(url);\n  const searchRemoved = removeAmpJsParamsFromSearch(search);\n  return origin + pathname + searchRemoved + hash;\n}\n\n/**\n * Returns a URL without a query string.\n * @param {string} url\n * @return {string}\n */\nexport function removeSearch(url) {\n  const index = url.indexOf('?');\n  if (index == -1) {\n    return url;\n  }\n  const fragment = getFragment(url);\n  return url.substring(0, index) + fragment;\n}\n\n/**\n * Removes parameters that start with amp js parameter pattern and returns the\n * new search string.\n * @param {string} urlSearch\n * @return {string}\n */\nfunction removeAmpJsParamsFromSearch(urlSearch) {\n  // The below regex is a combo of these original patterns. Combining these,\n  // removing the corresponding `.replace` calls, and reusing\n  // removeParamsFromSearch saves ~175B. Matches params in query string:\n  // - /[?&]amp_js[^&]*/   amp_js_*\n  // - /[?&]amp_gsa[^&]*/  amp_gsa\n  // - /[?&]amp_r[^&]*/    amp_r\n  // - /[?&]amp_kit[^&]*/  amp_kit\n  // - /[?&]usqp[^&]*/     usqp (from goog experiment)\n  return removeParamsFromSearch(urlSearch, '(amp_(js[^&=]*|gsa|r|kit)|usqp)');\n}\n\n/**\n * Removes parameters with param name and returns the new search string.\n * @param {string} urlSearch\n * @param {string} paramName\n * @return {string}\n */\nexport function removeParamsFromSearch(urlSearch, paramName) {\n  // TODO: Accept paramNames as an array.\n  if (!urlSearch || urlSearch == '?') {\n    return '';\n  }\n  const paramRegex = new RegExp(`[?&]${paramName}\\\\b[^&]*`, 'g');\n  const search = urlSearch.replace(paramRegex, '').replace(/^[?&]/, '');\n  return search ? '?' + search : '';\n}\n\n/**\n * Returns the source URL of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string}\n */\nexport function getSourceUrl(url) {\n  url = urlAsLocation(url);\n\n  // Not a proxy URL - return the URL itself.\n  if (!isProxyOrigin(url)) {\n    return url.href;\n  }\n\n  // A proxy URL.\n  // Example path that is being matched here.\n  // https://cdn.ampproject.org/c/s/www.origin.com/foo/\n  // The /s/ is optional and signals a secure origin.\n  const path = url.pathname.split('/');\n  const prefix = path[1];\n  userAssert(\n    SERVING_TYPE_PREFIX.has(prefix),\n    'Unknown path prefix in url %s',\n    url.href\n  );\n  const domainOrHttpsSignal = path[2];\n  const origin =\n    domainOrHttpsSignal == 's'\n      ? 'https://' + decodeURIComponent(path[3])\n      : 'http://' + decodeURIComponent(domainOrHttpsSignal);\n  // Sanity test that what we found looks like a domain.\n  userAssert(origin.indexOf('.') > 0, 'Expected a . in origin %s', origin);\n  path.splice(1, domainOrHttpsSignal == 's' ? 3 : 2);\n  return (\n    origin +\n    path.join('/') +\n    removeAmpJsParamsFromSearch(url.search) +\n    (url.hash || '')\n  );\n}\n\n/**\n * Returns the source origin of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string} The source origin of the URL.\n */\nexport function getSourceOrigin(url) {\n  return parseUrlDeprecated(getSourceUrl(url)).origin;\n}\n\n/**\n * Returns absolute URL resolved based on the relative URL and the base.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n */\nexport function resolveRelativeUrl(relativeUrlString, baseUrl) {\n  baseUrl = urlAsLocation(baseUrl);\n  if (mode.isEsm() || typeof URL == 'function') {\n    return new URL(relativeUrlString, baseUrl.href).toString();\n  }\n  return resolveRelativeUrlFallback_(relativeUrlString, baseUrl);\n}\n\n/**\n * Fallback for URL resolver when URL class is not available.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n * @private @visibleForTesting\n */\nexport function resolveRelativeUrlFallback_(relativeUrlString, baseUrl) {\n  baseUrl = urlAsLocation(baseUrl);\n  relativeUrlString = relativeUrlString.replace(/\\\\/g, '/');\n  const relativeUrl = parseUrlDeprecated(relativeUrlString);\n\n  // Absolute URL.\n  if (relativeUrlString.toLowerCase().startsWith(relativeUrl.protocol)) {\n    return relativeUrl.href;\n  }\n\n  // Protocol-relative URL.\n  if (relativeUrlString.startsWith('//')) {\n    return baseUrl.protocol + relativeUrlString;\n  }\n\n  // Absolute path.\n  if (relativeUrlString.startsWith('/')) {\n    return baseUrl.origin + relativeUrlString;\n  }\n\n  // Relative path.\n  return (\n    baseUrl.origin +\n    baseUrl.pathname.replace(/\\/[^/]*$/, '/') +\n    relativeUrlString\n  );\n}\n\n/**\n * Add \"__amp_source_origin\" query parameter to the URL.\n * @param {!Window} win\n * @param {string} url\n * @return {string}\n */\nexport function getCorsUrl(win, url) {\n  checkCorsUrl(url);\n  const sourceOrigin = getSourceOrigin(win.location.href);\n  return addParamToUrl(url, SOURCE_ORIGIN_PARAM, sourceOrigin);\n}\n\n/**\n * Checks if the url has __amp_source_origin and throws if it does.\n * @param {string} url\n */\nexport function checkCorsUrl(url) {\n  const parsedUrl = parseUrlDeprecated(url);\n  const query = parseQueryString(parsedUrl.search);\n  userAssert(\n    !(SOURCE_ORIGIN_PARAM in query),\n    'Source origin is not allowed in %s',\n    url\n  );\n}\n\n/**\n * Adds the path to the given url.\n *\n * @param {!Location} url\n * @param {string} path\n * @return {string}\n */\nexport function appendPathToUrl(url, path) {\n  const pathname = url.pathname.replace(/\\/?$/, '/') + path.replace(/^\\//, '');\n  return url.origin + pathname + url.search + url.hash;\n}\n", "import {deserializeMessage, isAmpMessage} from '#core/3p-frame-messaging';\nimport {addAttributesToElement} from '#core/dom';\nimport {closestAncestorElementBySelector} from '#core/dom/query';\nimport {setStyle} from '#core/dom/style';\nimport {remove} from '#core/types/array';\nimport {dict} from '#core/types/object';\nimport {tryParseJson} from '#core/types/object/json';\n\nimport {getData} from '#utils/event-helper';\nimport {dev, devAssert} from '#utils/log';\n\nimport {parseUrlDeprecated} from './url';\n\n/**\n * Sentinel used to force unlistening after a iframe is detached.\n * @type {string}\n */\nconst UNLISTEN_SENTINEL = 'unlisten';\n\n/**\n * @typedef {{\n *   frame: !Element,\n *   events: !Object<string, !Array<function(!JsonObject)>>\n * }}\n */\nlet WindowEventsDef;\n\n/**\n * Returns a mapping from a URL's origin to an array of windows and their\n * listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {boolean=} opt_create create the mapping if it does not exist\n * @return {?Object<string, !Array<!WindowEventsDef>>}\n */\nfunction getListenFors(parentWin, opt_create) {\n  let {listeningFors} = parentWin;\n\n  if (!listeningFors && opt_create) {\n    listeningFors = parentWin.listeningFors = Object.create(null);\n  }\n  return listeningFors || null;\n}\n\n/**\n * Returns an array of WindowEventsDef that have had any listenFor listeners\n * registered for this sentinel.\n * @param {?Window} parentWin the window that created the iframe\n * @param {string} sentinel the sentinel of the message\n * @param {boolean=} opt_create create the array if it does not exist\n * @return {?Array<!WindowEventsDef>}\n */\nfunction getListenForSentinel(parentWin, sentinel, opt_create) {\n  const listeningFors = getListenFors(parentWin, opt_create);\n  if (!listeningFors) {\n    return listeningFors;\n  }\n\n  let listenSentinel = listeningFors[sentinel];\n  if (!listenSentinel && opt_create) {\n    listenSentinel = listeningFors[sentinel] = [];\n  }\n  return listenSentinel || null;\n}\n\n/**\n * Returns an mapping of event names to listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {!Element} iframe the iframe element who's context will trigger the\n *     event\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @return {?Object<string, !Array<function(!JsonObject, !Window, string, !MessageEvent)>>}\n */\nfunction getOrCreateListenForEvents(parentWin, iframe, opt_is3P) {\n  const sentinel = getSentinel_(iframe, opt_is3P);\n  const listenSentinel = getListenForSentinel(parentWin, sentinel, true);\n\n  let windowEvents;\n  for (let i = 0; i < listenSentinel.length; i++) {\n    const we = listenSentinel[i];\n    if (we.frame === iframe) {\n      windowEvents = we;\n      break;\n    }\n  }\n\n  if (!windowEvents) {\n    windowEvents = {\n      frame: iframe,\n      events: Object.create(null),\n    };\n    listenSentinel.push(windowEvents);\n  }\n\n  return windowEvents.events;\n}\n\n/**\n * Returns an mapping of event names to listenFor listeners.\n * @param {?Window} parentWin the window that created the iframe\n * @param {string} sentinel the sentinel of the message\n * @param {string} origin the source window's origin\n * @param {?Window} triggerWin the window that triggered the event\n * @return {?Object<string, !Array<function(!JsonObject, !Window, string, !MessageEvent)>>}\n */\nfunction getListenForEvents(parentWin, sentinel, origin, triggerWin) {\n  const listenSentinel = getListenForSentinel(parentWin, sentinel);\n\n  if (!listenSentinel) {\n    return listenSentinel;\n  }\n\n  // Find the entry for the frame.\n  // TODO(@nekodo): Add a WeakMap<Window, WindowEventsDef> cache to\n  //     speed up this process.\n  let windowEvents;\n  for (let i = 0; i < listenSentinel.length; i++) {\n    const we = listenSentinel[i];\n    const {contentWindow} = we.frame;\n    if (!contentWindow) {\n      setTimeout(dropListenSentinel, 0, listenSentinel);\n    } else if (\n      triggerWin == contentWindow ||\n      isDescendantWindow(contentWindow, triggerWin)\n    ) {\n      // 3p code path, we may accept messages from nested frames.\n      windowEvents = we;\n      break;\n    }\n  }\n\n  return windowEvents ? windowEvents.events : null;\n}\n\n/**\n * Checks whether one window is a descendant of another by climbing\n * the parent chain.\n * @param {?Window} ancestor potential ancestor window\n * @param {?Window} descendant potential descendant window\n * @return {boolean}\n */\nfunction isDescendantWindow(ancestor, descendant) {\n  for (let win = descendant; win && win != win.parent; win = win.parent) {\n    if (win == ancestor) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Removes any listenFors registed on listenSentinel that do not have\n * a contentWindow (the frame was removed from the DOM tree).\n * @param {!Array<!WindowEventsDef>} listenSentinel\n */\nfunction dropListenSentinel(listenSentinel) {\n  const noopData = dict({'sentinel': UNLISTEN_SENTINEL});\n\n  for (let i = listenSentinel.length - 1; i >= 0; i--) {\n    const windowEvents = listenSentinel[i];\n\n    if (!windowEvents.frame.contentWindow) {\n      listenSentinel.splice(i, 1);\n\n      const {events} = windowEvents;\n      for (const name in events) {\n        // Splice here, so that each unlisten does not shift the array\n        events[name].splice(0, Infinity).forEach((event) => {\n          event(noopData);\n        });\n      }\n    }\n  }\n}\n\n/**\n * Registers the global listenFor event listener if it has yet to be.\n * @param {?Window} parentWin\n */\nfunction registerGlobalListenerIfNeeded(parentWin) {\n  if (parentWin.listeningFors) {\n    return;\n  }\n  const listenForListener = function (event) {\n    if (!getData(event)) {\n      return;\n    }\n    const data = parseIfNeeded(getData(event));\n\n    if (!data || !data['sentinel']) {\n      return;\n    }\n\n    const listenForEvents = getListenForEvents(\n      parentWin,\n      data['sentinel'],\n      event.origin,\n      event.source\n    );\n    if (!listenForEvents) {\n      return;\n    }\n\n    let listeners = listenForEvents[data['type']];\n    if (!listeners) {\n      return;\n    }\n\n    // We slice to avoid issues with adding another listener or unlistening\n    // during iteration. We could move to a Doubly Linked List with\n    // backtracking, but that's overly complicated.\n    listeners = listeners.slice();\n    for (let i = 0; i < listeners.length; i++) {\n      const listener = listeners[i];\n      listener(data, event.source, event.origin, event);\n    }\n  };\n\n  parentWin.addEventListener('message', listenForListener);\n}\n\n/**\n * Allows listening for message from the iframe. Returns an unlisten\n * function to remove the listener.\n *\n * @param {?Element} iframe\n * @param {string} typeOfMessage\n * @param {?function(!JsonObject, !Window, string, !MessageEvent)} callback Called when a\n *     message of this type arrives for this iframe.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @param {boolean=} opt_includingNestedWindows set to true if messages from\n *     nested frames should also be accepted.\n * @param {boolean=} opt_allowOpaqueOrigin set to true if messages from\n       opaque origins (origin == null) are allowed.\n * @return {!UnlistenDef}\n */\nexport function listenFor(\n  iframe,\n  typeOfMessage,\n  callback,\n  opt_is3P,\n  opt_includingNestedWindows,\n  opt_allowOpaqueOrigin\n) {\n  devAssert(iframe.src, 'only iframes with src supported');\n  devAssert(\n    !iframe.parentNode,\n    'cannot register events on an attached ' +\n      'iframe. It will cause hair-pulling bugs like #2942'\n  );\n  devAssert(callback);\n  const parentWin = iframe.ownerDocument.defaultView;\n\n  registerGlobalListenerIfNeeded(parentWin);\n\n  const listenForEvents = getOrCreateListenForEvents(\n    parentWin,\n    iframe,\n    opt_is3P\n  );\n\n  const iframeOrigin = parseUrlDeprecated(iframe.src).origin;\n  let events =\n    listenForEvents[typeOfMessage] || (listenForEvents[typeOfMessage] = []);\n\n  let unlisten;\n  let listener = function (data, source, origin, event) {\n    const sentinel = data['sentinel'];\n\n    // Exclude messages that don't satisfy amp sentinel rules.\n    if (sentinel == 'amp') {\n      // For `amp` sentinel, nested windows are not allowed\n      if (source != iframe.contentWindow) {\n        return;\n      }\n\n      // For `amp` sentinel origin must match unless opaque origin is allowed\n      const isOpaqueAndAllowed = origin == 'null' && opt_allowOpaqueOrigin;\n      if (iframeOrigin != origin && !isOpaqueAndAllowed) {\n        return;\n      }\n    }\n\n    // Exclude nested frames if necessary.\n    // Note that the source was already verified to be either the contentWindow\n    // of the iframe itself or a descendant window within it.\n    if (!opt_includingNestedWindows && source != iframe.contentWindow) {\n      return;\n    }\n\n    if (data.sentinel == UNLISTEN_SENTINEL) {\n      unlisten();\n      return;\n    }\n    callback(data, source, origin, event);\n  };\n\n  events.push(listener);\n\n  return (unlisten = function () {\n    if (listener) {\n      const index = events.indexOf(listener);\n      if (index > -1) {\n        events.splice(index, 1);\n      }\n      // Make sure references to the unlisten function do not keep\n      // alive too much.\n      listener = null;\n      events = null;\n      callback = null;\n    }\n  });\n}\n\n/**\n * Returns a promise that resolves when one of given messages has been observed\n * for the first time. And remove listener for all other messages.\n * @param {!Element} iframe\n * @param {string|!Array<string>} typeOfMessages\n * @param {boolean=} opt_is3P\n * @return {!Promise<!{data: !JsonObject, source: !Window, origin: string, event: !MessageEvent}>}\n */\nexport function listenForOncePromise(iframe, typeOfMessages, opt_is3P) {\n  const unlistenList = [];\n  if (typeof typeOfMessages == 'string') {\n    typeOfMessages = [typeOfMessages];\n  }\n  return new Promise((resolve) => {\n    for (let i = 0; i < typeOfMessages.length; i++) {\n      const message = typeOfMessages[i];\n      const unlisten = listenFor(\n        iframe,\n        message,\n        (data, source, origin, event) => {\n          for (let i = 0; i < unlistenList.length; i++) {\n            unlistenList[i]();\n          }\n          resolve({data, source, origin, event});\n        },\n        opt_is3P\n      );\n      unlistenList.push(unlisten);\n    }\n  });\n}\n\n/**\n * Posts a message to the iframe.\n * @param {!Element} iframe The iframe.\n * @param {string} type Type of the message.\n * @param {!JsonObject} object Message payload.\n * @param {string} targetOrigin origin of the target.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n */\nexport function postMessage(iframe, type, object, targetOrigin, opt_is3P) {\n  postMessageToWindows(\n    iframe,\n    [{win: iframe.contentWindow, origin: targetOrigin}],\n    type,\n    object,\n    opt_is3P\n  );\n}\n\n/**\n * Posts an identical message to multiple target windows with the same\n * sentinel.\n * The message is serialized only once.\n * @param {!Element} iframe The iframe.\n * @param {!Array<{win: !Window, origin: string}>} targets to send the message\n *     to, pairs of window and its origin.\n * @param {string} type Type of the message.\n * @param {!JsonObject} object Message payload.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n */\nexport function postMessageToWindows(iframe, targets, type, object, opt_is3P) {\n  if (!iframe.contentWindow) {\n    return;\n  }\n  object['type'] = type;\n  object['sentinel'] = getSentinel_(iframe, opt_is3P);\n  let payload = object;\n  if (opt_is3P) {\n    // Serialize ourselves because that is much faster in Chrome.\n    payload = 'amp-' + JSON.stringify(object);\n  }\n  for (let i = 0; i < targets.length; i++) {\n    const target = targets[i];\n    target.win./*OK*/ postMessage(payload, target.origin);\n  }\n}\n\n/**\n * Gets the sentinel string.\n * @param {!Element} iframe The iframe.\n * @param {boolean=} opt_is3P set to true if the iframe is 3p.\n * @return {string} Sentinel string.\n * @private\n */\nfunction getSentinel_(iframe, opt_is3P) {\n  return opt_is3P ? iframe.getAttribute('data-amp-3p-sentinel') : 'amp';\n}\n\n/**\n * JSON parses event.data if it needs to be\n * @param {*} data\n * @return {?JsonObject} object message\n * @private\n * @visibleForTesting\n */\nexport function parseIfNeeded(data) {\n  if (typeof data == 'string') {\n    if (data.charAt(0) == '{') {\n      data =\n        tryParseJson(data, (e) => {\n          dev().warn(\n            'IFRAME-HELPER',\n            'Postmessage could not be parsed. ' +\n              'Is it in a valid JSON format?',\n            e\n          );\n        }) || null;\n    } else if (isAmpMessage(data)) {\n      data = deserializeMessage(data);\n    } else {\n      data = null;\n    }\n  }\n  return /** @type {?JsonObject} */ (data);\n}\n\n/**\n * Manages a postMessage API for an iframe with a subscription message and\n * a way to broadcast messages to all subscribed windows, which\n * in turn must all be descendants of the contentWindow of the iframe.\n */\nexport class SubscriptionApi {\n  /**\n   * @param {!Element} iframe The iframe.\n   * @param {string} type Type of the subscription message.\n   * @param {boolean} is3p set to true if the iframe is 3p.\n   * @param {function(!JsonObject, !Window, string)} requestCallback Callback\n   *     invoked whenever a new window subscribes.\n   */\n  constructor(iframe, type, is3p, requestCallback) {\n    /** @private @const {!Element} */\n    this.iframe_ = iframe;\n    /** @private @const {boolean} */\n    this.is3p_ = is3p;\n    /** @private @const {!Array<{win: !Window, origin: string}>} */\n    this.clientWindows_ = [];\n\n    /** @private @const {!UnlistenDef} */\n    this.unlisten_ = listenFor(\n      this.iframe_,\n      type,\n      (data, source, origin) => {\n        // This message might be from any window within the iframe, we need\n        // to keep track of which windows want to be sent updates.\n        if (!this.clientWindows_.some((entry) => entry.win == source)) {\n          this.clientWindows_.push({win: source, origin});\n        }\n        requestCallback(data, source, origin);\n      },\n      this.is3p_,\n      // For 3P frames we also allow nested frames within them to subscribe..\n      this.is3p_ /* opt_includingNestedWindows */\n    );\n  }\n\n  /**\n   * Sends a message to all subscribed windows.\n   * @param {string} type Type of the message.\n   * @param {!JsonObject} data Message payload.\n   */\n  send(type, data) {\n    // Remove clients that have been removed from the DOM.\n    remove(this.clientWindows_, (client) => !client.win.parent);\n    postMessageToWindows(\n      this.iframe_,\n      this.clientWindows_,\n      type,\n      data,\n      this.is3p_\n    );\n  }\n\n  /**\n   * Destroys iframe.\n   */\n  destroy() {\n    this.unlisten_();\n    this.clientWindows_.length = 0;\n  }\n}\n\n/**\n * @param {!Element} element\n * @return {boolean}\n */\nexport function looksLikeTrackingIframe(element) {\n  const {height, width} = element.getLayoutSize();\n  // This heuristic is subject to change.\n  if (width > 10 || height > 10) {\n    return false;\n  }\n  // Iframe is not tracking iframe if open with user interaction\n  return !closestAncestorElementBySelector(element, '.i-amphtml-overlay');\n}\n\n// Most common ad sizes\n// Array of [width, height] pairs.\nconst adSizes = [\n  [300, 250],\n  [320, 50],\n  [300, 50],\n  [320, 100],\n];\n\n/**\n * Guess whether this element might be an ad.\n * @param {!Element} element An amp-iframe element.\n * @return {boolean}\n * @visibleForTesting\n */\nexport function isAdLike(element) {\n  const {height, width} = element.getLayoutSize();\n  for (let i = 0; i < adSizes.length; i++) {\n    const refWidth = adSizes[i][0];\n    const refHeight = adSizes[i][1];\n    if (refHeight > height) {\n      continue;\n    }\n    if (refWidth > width) {\n      continue;\n    }\n    // Fuzzy matching to account for padding.\n    if (height - refHeight <= 20 && width - refWidth <= 20) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * @param {!Element} iframe\n * @return {!Element}\n */\nexport function disableScrollingOnIframe(iframe) {\n  addAttributesToElement(iframe, dict({'scrolling': 'no'}));\n\n  // This shouldn't work, but it does on Firefox.\n  // https://stackoverflow.com/a/15494969\n  setStyle(iframe, 'overflow', 'hidden');\n\n  return iframe;\n}\n\n/**\n * Returns true if win's properties can be accessed and win is defined.\n * This functioned is used to determine if a window is cross-domained\n * from the perspective of the current window.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function canInspectWindow(win) {\n  // TODO: this is not reliable.  The compiler assumes that property reads are\n  // side-effect free.  The recommended fix is to use goog.reflect.sinkValue\n  // but since we're not using the closure library I'm not sure how to do this.\n  // See https://github.com/google/closure-compiler/issues/3156\n  try {\n    // win['test'] could be truthy but not true the compiler shouldn't be able\n    // to optimize this check away.\n    return !!win.location.href && (win['test'] || true);\n  } catch (unusedErr) {\n    return false;\n  }\n}\n\n/** @const {string} */\nexport const FIE_EMBED_PROP = '__AMP_EMBED__';\n\n/**\n * Returns the embed created using `installFriendlyIframeEmbed` or `null`.\n * Caution: This will only return the FIE after the iframe has 'loaded'. If you\n * are checking before this signal you may be in a race condition that returns\n * null.\n * @param {!HTMLIFrameElement} iframe\n * @return {?./friendly-iframe-embed.FriendlyIframeEmbed}\n */\nexport function getFriendlyIframeEmbedOptional(iframe) {\n  return /** @type {?./friendly-iframe-embed.FriendlyIframeEmbed} */ (\n    iframe[FIE_EMBED_PROP]\n  );\n}\n\n/**\n * @param {!Element} element\n * @return {boolean}\n */\nexport function isInFie(element) {\n  return (\n    element.classList.contains('i-amphtml-fie') ||\n    !!closestAncestorElementBySelector(element, '.i-amphtml-fie')\n  );\n}\n", "import {escapeCssSelectorIdent} from '#core/dom/css-selectors';\nimport {layoutRectLtwh} from '#core/dom/layout/rect';\nimport {\n  closestAncestorElementBySelector,\n  matches,\n  scopedQuerySelector,\n  scopedQuerySelectorAll,\n} from '#core/dom/query';\nimport {computedStyle, getVendorJsPropertyName} from '#core/dom/style';\nimport {isEnumValue, isObject} from '#core/types';\nimport {isArray, toArray} from '#core/types/array';\nimport {map} from '#core/types/object';\nimport {dashToCamelCase} from '#core/types/string';\n\nimport {isExperimentOn} from '#experiments';\n\nimport {dev, devAssert, user, userAssert} from '#utils/log';\n\nimport {parseCss} from './parsers/css-expr';\nimport {CssNumberNode, CssTimeNode, isVarCss} from './parsers/css-expr-ast';\nimport {extractKeyframes} from './parsers/keyframes-extractor';\nimport {NativeWebAnimationRunner} from './runners/native-web-animation-runner';\nimport {ScrollTimelineWorkletRunner} from './runners/scrolltimeline-worklet-runner';\nimport {\n  InternalWebAnimationRequestDef,\n  WebAnimationDef,\n  WebAnimationSelectorDef,\n  WebAnimationSubtargetDef,\n  WebAnimationTimingDef,\n  WebAnimationTimingDirection,\n  WebAnimationTimingFill,\n  WebCompAnimationDef,\n  WebKeyframeAnimationDef,\n  WebKeyframesDef,\n  WebMultiAnimationDef,\n  WebSwitchAnimationDef,\n  isAllowlistedProp,\n} from './web-animation-types';\n\nimport {isInFie} from '../../../src/iframe-helper';\nimport {getMode} from '../../../src/mode';\nimport {assertHttpsUrl, resolveRelativeUrl} from '../../../src/url';\n\n/** @const {string} */\nconst TAG = 'amp-animation';\nconst TARGET_ANIM_ID = '__AMP_ANIM_ID';\n\n/**\n * Auto-incrementing ID generator for internal animation uses.\n * See `TARGET_ANIM_ID`.\n * @type {number}\n */\nlet animIdCounter = 0;\n\n/**\n * @const {!Object<string, boolean>}\n */\nconst SERVICE_PROPS = {\n  'offset': true,\n  'easing': true,\n};\n\n/**\n * Clip-path is an only CSS property we allow for animation that may require\n * vendor prefix. And it's always \"-webkit\". Use a simple map to avoid\n * expensive lookup for all other properties.\n */\nconst ADD_PROPS = {\n  'clip-path': '-webkit-clip-path',\n  'clipPath': '-webkit-clip-path',\n};\n\n/**\n * The scanner for the `WebAnimationDef` format. It calls the appropriate\n * callbacks based on the discovered animation types.\n * @abstract\n */\nclass Scanner {\n  /**\n   * @param {!WebAnimationDef|!Array<!WebAnimationDef>} spec\n   * @return {boolean}\n   */\n  scan(spec) {\n    if (isArray(spec)) {\n      // Returns `true` if any of the components scan successfully.\n      return spec.reduce((acc, comp) => this.scan(comp) || acc, false);\n    }\n\n    // Check whether the animation is enabled.\n    if (!this.isEnabled(/** @type {!WebAnimationDef} */ (spec))) {\n      return false;\n    }\n\n    // WebAnimationDef: (!WebMultiAnimationDef|!WebSpecAnimationDef|\n    //                   !WebCompAnimationDef|!WebKeyframeAnimationDef)\n    if (spec.animations) {\n      this.onMultiAnimation(/** @type {!WebMultiAnimationDef} */ (spec));\n    } else if (spec.switch) {\n      this.onSwitchAnimation(/** @type {!WebSwitchAnimationDef} */ (spec));\n    } else if (spec.animation) {\n      this.onCompAnimation(/** @type {!WebCompAnimationDef} */ (spec));\n    } else if (spec.keyframes) {\n      this.onKeyframeAnimation(/** @type {!WebKeyframeAnimationDef} */ (spec));\n    } else {\n      this.onUnknownAnimation(spec);\n    }\n    return true;\n  }\n\n  /**\n   * Whether the animation spec is enabled.\n   * @param {!WebAnimationDef} unusedSpec\n   * @return {boolean}\n   */\n  isEnabled(unusedSpec) {\n    return true;\n  }\n\n  /**\n   * @param {!WebMultiAnimationDef} unusedSpec\n   * @abstract\n   */\n  onMultiAnimation(unusedSpec) {}\n\n  /**\n   * @param {!WebSwitchAnimationDef} unusedSpec\n   * @abstract\n   */\n  onSwitchAnimation(unusedSpec) {}\n\n  /**\n   * @param {!WebCompAnimationDef} unusedSpec\n   * @abstract\n   */\n  onCompAnimation(unusedSpec) {}\n\n  /**\n   * @param {!WebKeyframeAnimationDef} unusedSpec\n   * @abstract\n   */\n  onKeyframeAnimation(unusedSpec) {}\n\n  /** @param {!Object} unusedSpec */\n  onUnknownAnimation(unusedSpec) {\n    throw dev().createError(\n      'unknown animation type: must have \"animations\" or \"keyframes\" field'\n    );\n  }\n}\n\n/**\n * Builds animation runners based on the provided spec.\n */\nexport class Builder {\n  /**\n   * @param {!Window} win\n   * @param {!Document|!ShadowRoot} rootNode\n   * @param {string} baseUrl\n   * @param {!../../../src/service/vsync-impl.Vsync} vsync\n   * @param {!../../../src/service/owners-interface.OwnersInterface} owners\n   * @param {!./web-animation-types.WebAnimationBuilderOptionsDef=} options\n   */\n  constructor(win, rootNode, baseUrl, vsync, owners, options = {}) {\n    /** @const @private */\n    this.win_ = win;\n\n    /** @const @private */\n    this.css_ = new CssContextImpl(win, rootNode, baseUrl, options);\n\n    /** @const @private */\n    this.vsync_ = vsync;\n\n    /** @const @private */\n    this.owners_ = owners;\n\n    /** @const @private {!Array<!Element>} */\n    this.targets_ = [];\n\n    /** @const @private {!Array<!Promise>} */\n    this.loaders_ = [];\n  }\n\n  /**\n   * Creates the animation runner for the provided spec. Waits for all\n   * necessary resources to be loaded before the runner is resolved.\n   * @param {!WebAnimationDef|!Array<!WebAnimationDef>} spec\n   * @param {?WebAnimationDef=} opt_args\n   * @param {?JsonObject=} opt_positionObserverData\n   * @return {!Promise<!./runners/animation-runner.AnimationRunner>}\n   */\n  createRunner(spec, opt_args, opt_positionObserverData = null) {\n    return this.resolveRequests([], spec, opt_args).then((requests) => {\n      if (getMode().localDev || getMode().development) {\n        user().fine(TAG, 'Animation: ', requests);\n      }\n      return Promise.all(this.loaders_).then(() => {\n        return this.isAnimationWorkletSupported_() && opt_positionObserverData\n          ? new ScrollTimelineWorkletRunner(\n              this.win_,\n              requests,\n              opt_positionObserverData\n            )\n          : new NativeWebAnimationRunner(requests);\n      });\n    });\n  }\n\n  /**\n   * @param {!Array<string>} path\n   * @param {!WebAnimationDef|!Array<!WebAnimationDef>} spec\n   * @param {?WebAnimationDef|undefined} args\n   * @param {?Element} target\n   * @param {?number} index\n   * @param {?Object<string, *>} vars\n   * @param {?WebAnimationTimingDef} timing\n   * @return {!Promise<!Array<!InternalWebAnimationRequestDef>>}\n   * @protected\n   */\n  resolveRequests(\n    path,\n    spec,\n    args,\n    target = null,\n    index = null,\n    vars = null,\n    timing = null\n  ) {\n    const scanner = this.createScanner_(path, target, index, vars, timing);\n    return this.vsync_.measurePromise(() =>\n      scanner.resolveRequests(spec, args)\n    );\n  }\n\n  /**\n   * @param {!Element} target\n   * @protected\n   */\n  requireLayout(target) {\n    if (!this.targets_.includes(target)) {\n      this.targets_.push(target);\n      this.loaders_.push(this.owners_.requireLayout(target));\n    }\n  }\n\n  /**\n   * @param {!Array<string>} path\n   * @param {?Element} target\n   * @param {?number} index\n   * @param {?Object<string, *>} vars\n   * @param {?WebAnimationTimingDef} timing\n   * @private\n   * @return {*} TODO(#23582): Specify return type\n   */\n  createScanner_(path, target, index, vars, timing) {\n    return new MeasureScanner(\n      this,\n      this.css_,\n      path,\n      target,\n      index,\n      vars,\n      timing\n    );\n  }\n\n  /**\n   * @return {boolean} Whether animationWorklet can be used.\n   * @private\n   */\n  isAnimationWorkletSupported_() {\n    return (\n      isExperimentOn(this.win_, 'chrome-animation-worklet') &&\n      'animationWorklet' in CSS &&\n      getMode(this.win_).runtime != 'inabox' &&\n      !isInFie(this.win_.document.documentElement)\n    );\n  }\n}\n\n/**\n * The scanner that evaluates all expressions and builds the final\n * `AnimationRunner` instance for the target animation. It must be\n * executed in the \"measure\" vsync phase.\n */\nexport class MeasureScanner extends Scanner {\n  /**\n   * @param {!Builder} builder\n   * @param {!CssContextImpl} css\n   * @param {!Array<string>} path\n   * @param {?Element} target\n   * @param {?number} index\n   * @param {?Object<string, *>} vars\n   * @param {?WebAnimationTimingDef} timing\n   */\n  constructor(builder, css, path, target, index, vars, timing) {\n    super();\n\n    /** @const @private */\n    this.builder_ = builder;\n\n    /** @const @private */\n    this.css_ = css;\n\n    /** @const @private */\n    this.path_ = path;\n\n    /** @private {?Element} */\n    this.target_ = target;\n\n    /** @private {?number} */\n    this.index_ = index;\n\n    /** @private {!Object<string, *>} */\n    this.vars_ = vars || map();\n\n    /** @private {!WebAnimationTimingDef} */\n    this.timing_ = timing || {\n      duration: 0,\n      delay: 0,\n      endDelay: 0,\n      iterations: 1,\n      iterationStart: 0,\n      easing: 'linear',\n      direction: WebAnimationTimingDirection.NORMAL,\n      fill: WebAnimationTimingFill.NONE,\n    };\n\n    /** @private {!Array<!InternalWebAnimationRequestDef>} */\n    this.requests_ = [];\n\n    /**\n     * Dependencies required to resolve all animation requests. In case of\n     * composition, all requests can only be resolved asynchronously. This\n     * dependencies are used to block `resolveRequests` to collect all\n     * dependenices.\n     * @const @private {!Array<!Promise>}\n     */\n    this.deps_ = [];\n  }\n\n  /**\n   * This methods scans all animation declarations specified in `spec`\n   * recursively to produce the animation requests. `opt_args` is an additional\n   * spec that can be used to default timing and variables.\n   * @param {!WebAnimationDef|!Array<!WebAnimationDef>} spec\n   * @param {?WebAnimationDef=} opt_args\n   * @return {!Promise<!Array<!InternalWebAnimationRequestDef>>}\n   */\n  resolveRequests(spec, opt_args) {\n    if (opt_args) {\n      this.with_(opt_args, () => {\n        this.scan(spec);\n      });\n    } else {\n      this.css_.withVars(this.vars_, () => {\n        this.scan(spec);\n      });\n    }\n    return Promise.all(this.deps_).then(() => this.requests_);\n  }\n\n  /** @override */\n  isEnabled(spec) {\n    if (spec.media && !this.css_.matchMedia(spec.media)) {\n      return false;\n    }\n    if (spec.supports && !this.css_.supports(spec.supports)) {\n      return false;\n    }\n    return true;\n  }\n\n  /** @override */\n  onMultiAnimation(spec) {\n    this.with_(spec, () => this.scan(spec.animations));\n  }\n\n  /** @override */\n  onSwitchAnimation(spec) {\n    // The first to match will be used; the rest will be ignored.\n    this.with_(spec, () => {\n      for (let i = 0; i < spec.switch.length; i++) {\n        const candidate = spec.switch[i];\n        if (this.scan(candidate)) {\n          // First matching candidate is applied and the rest are ignored.\n          break;\n        }\n      }\n    });\n  }\n\n  /** @override */\n  onCompAnimation(spec) {\n    userAssert(\n      this.path_.indexOf(spec.animation) == -1,\n      `Recursive animations are not allowed: \"${spec.animation}\"`\n    );\n    const newPath = this.path_.concat(spec.animation);\n    const animationElement = user().assertElement(\n      this.css_.getElementById(spec.animation),\n      `Animation not found: \"${spec.animation}\"`\n    );\n    // Currently, only `<amp-animation>` supplies animations. In the future\n    // this could become an interface.\n    userAssert(\n      animationElement.tagName == 'AMP-ANIMATION',\n      `Element is not an animation: \"${spec.animation}\"`\n    );\n    const otherSpecPromise = animationElement.getImpl().then((impl) => {\n      return impl.getAnimationSpec();\n    });\n    this.with_(spec, () => {\n      const {\n        index_: index,\n        target_: target,\n        timing_: timing,\n        vars_: vars,\n      } = this;\n      const promise = otherSpecPromise\n        .then((otherSpec) => {\n          if (!otherSpec) {\n            return;\n          }\n          return this.builder_.resolveRequests(\n            newPath,\n            otherSpec,\n            /* args */ null,\n            target,\n            index,\n            vars,\n            timing\n          );\n        })\n        .then((requests) => {\n          /** @type {!Array} */ (requests).forEach((request) =>\n            this.requests_.push(request)\n          );\n        });\n      this.deps_.push(promise);\n    });\n  }\n\n  /** @override */\n  onKeyframeAnimation(spec) {\n    this.with_(spec, () => {\n      const target = user().assertElement(this.target_, 'No target specified');\n      const keyframes = this.createKeyframes_(target, spec);\n      this.requests_.push({\n        target,\n        keyframes,\n        vars: this.vars_,\n        timing: this.timing_,\n      });\n    });\n  }\n\n  /**\n   * @param {!Element} target\n   * @param {!WebKeyframeAnimationDef} spec\n   * @return {!WebKeyframesDef}\n   * @private\n   */\n  createKeyframes_(target, spec) {\n    let specKeyframes = spec.keyframes;\n    if (typeof specKeyframes == 'string') {\n      // Keyframes name to be extracted from `<style>`.\n      const keyframes = extractKeyframes(this.css_.rootNode, specKeyframes);\n      userAssert(\n        keyframes,\n        `Keyframes not found in stylesheet: \"${specKeyframes}\"`\n      );\n      specKeyframes = keyframes;\n    }\n\n    if (isObject(specKeyframes)) {\n      // Property -> keyframes form.\n      // The object is cloned, while properties are verified to be\n      // allowlisted. Additionally, the `offset:0` frames are inserted\n      // to polyfill partial keyframes per spec.\n      // See https://github.com/w3c/web-animations/issues/187\n      const object = /** @type {!Object<string, *>} */ (specKeyframes);\n      /** @type {!WebKeyframesDef} */\n      const keyframes = {};\n      for (const prop in object) {\n        this.validateProperty_(prop);\n        const value = object[prop];\n        let preparedValue;\n        if (SERVICE_PROPS[prop]) {\n          preparedValue = value;\n        } else if (!isArray(value) || value.length == 1) {\n          // Missing \"from\" value. Measure and add.\n          const fromValue = this.css_.measure(target, prop);\n          const toValue = isArray(value) ? value[0] : value;\n          preparedValue = [fromValue, this.css_.resolveCss(toValue)];\n        } else {\n          preparedValue = value.map((v) => this.css_.resolveCss(v));\n        }\n        keyframes[prop] = preparedValue;\n        if (prop in ADD_PROPS) {\n          keyframes[ADD_PROPS[prop]] = preparedValue;\n        }\n      }\n      return keyframes;\n    }\n\n    if (isArray(specKeyframes) && specKeyframes.length > 0) {\n      // Keyframes -> property form.\n      // The array is cloned, while properties are verified to be allowlisted.\n      // Additionally, if the `offset:0` properties are inserted when absent\n      // to polyfill partial keyframes per spec.\n      // See https://github.com/w3c/web-animations/issues/187 and\n      // https://github.com/web-animations/web-animations-js/issues/14\n      const array = /** @type {!Array<!Object<string, *>>} */ (specKeyframes);\n      /** @type {!WebKeyframesDef} */\n      const keyframes = [];\n      const addStartFrame = array.length == 1 || array[0].offset > 0;\n      const startFrame = addStartFrame\n        ? map()\n        : this.css_.resolveCssMap(array[0]);\n      keyframes.push(startFrame);\n      const start = addStartFrame ? 0 : 1;\n      for (let i = start; i < array.length; i++) {\n        const frame = array[i];\n        for (const prop in frame) {\n          if (SERVICE_PROPS[prop]) {\n            continue;\n          }\n          this.validateProperty_(prop);\n          if (!startFrame[prop]) {\n            // Missing \"from\" value. Measure and add to start frame.\n            startFrame[prop] = this.css_.measure(target, prop);\n          }\n        }\n        keyframes.push(this.css_.resolveCssMap(frame));\n      }\n      for (let i = 0; i < keyframes.length; i++) {\n        const frame = keyframes[i];\n        for (const k in ADD_PROPS) {\n          if (k in frame) {\n            frame[ADD_PROPS[k]] = frame[k];\n          }\n        }\n      }\n      return keyframes;\n    }\n\n    // TODO(dvoytenko): support CSS keyframes per https://github.com/w3c/web-animations/issues/189\n    // Unknown form of keyframes spec.\n    throw user().createError('keyframes not found', specKeyframes);\n  }\n\n  /** @override */\n  onUnknownAnimation() {\n    throw user().createError(\n      'unknown animation type:' +\n        ' must have \"animation\", \"animations\" or \"keyframes\" field'\n    );\n  }\n\n  /**\n   * @param {string} prop\n   * @private\n   */\n  validateProperty_(prop) {\n    if (SERVICE_PROPS[prop]) {\n      return;\n    }\n    userAssert(\n      isAllowlistedProp(prop),\n      'Property is not allowlisted for animation: %s',\n      prop\n    );\n  }\n\n  /**\n   * Resolves common parameters of an animation: target, timing and vars.\n   * @param {!WebAnimationDef} spec\n   * @param {function()} callback\n   * @private\n   */\n  with_(spec, callback) {\n    // Save context.\n    const {\n      index_: prevIndex,\n      target_: prevTarget,\n      timing_: prevTiming,\n      vars_: prevVars,\n    } = this;\n\n    // Push new context and perform calculations.\n    const targets =\n      spec.target || spec.selector ? this.resolveTargets_(spec) : [null];\n    this.css_.setTargetLength(targets.length);\n    targets.forEach((target, index) => {\n      this.target_ = target || prevTarget;\n      this.index_ = target ? index : prevIndex;\n      this.css_.withTarget(this.target_, this.index_, () => {\n        const subtargetSpec = this.target_\n          ? this.matchSubtargets_(this.target_, this.index_ || 0, spec)\n          : spec;\n        this.vars_ = this.mergeVars_(subtargetSpec, prevVars);\n        this.css_.withVars(this.vars_, () => {\n          this.timing_ = this.mergeTiming_(subtargetSpec, prevTiming);\n          callback();\n        });\n      });\n    });\n\n    // Restore context.\n    this.target_ = prevTarget;\n    this.index_ = prevIndex;\n    this.vars_ = prevVars;\n    this.timing_ = prevTiming;\n  }\n\n  /**\n   * @param {!WebAnimationDef} spec\n   * @return {!Array<!Element>}\n   * @private\n   */\n  resolveTargets_(spec) {\n    let targets;\n    if (spec.selector) {\n      userAssert(!spec.target, 'Both \"selector\" and \"target\" are not allowed');\n      targets = this.css_.queryElements(spec.selector);\n      if (targets.length == 0) {\n        user().warn(TAG, `Target not found: \"${spec.selector}\"`);\n      }\n    } else if (spec.target) {\n      if (typeof spec.target == 'string') {\n        // TODO(dvoytenko, #9129): cleanup deprecated string targets.\n        user().error(TAG, 'string targets are deprecated');\n      }\n      const target = user().assertElement(\n        typeof spec.target == 'string'\n          ? this.css_.getElementById(spec.target)\n          : spec.target,\n        `Target not found: \"${spec.target}\"`\n      );\n      targets = [target];\n    } else if (this.target_) {\n      targets = [this.target_];\n    }\n    targets.forEach((target) => this.builder_.requireLayout(target));\n    return targets;\n  }\n\n  /**\n   * @param {!Element} target\n   * @param {number} index\n   * @param {!WebAnimationSelectorDef} spec\n   * @return {!WebAnimationSelectorDef}\n   */\n  matchSubtargets_(target, index, spec) {\n    if (!spec.subtargets || spec.subtargets.length == 0) {\n      return spec;\n    }\n    const result = map(spec);\n    spec.subtargets.forEach((subtargetSpec) => {\n      const matcher = this.getMatcher_(subtargetSpec);\n      if (matcher(target, index)) {\n        Object.assign(result, subtargetSpec);\n      }\n    });\n    return result;\n  }\n\n  /**\n   * @param {!WebAnimationSubtargetDef} spec\n   * @return {function(!Element, number):boolean}\n   */\n  getMatcher_(spec) {\n    if (spec.matcher) {\n      return spec.matcher;\n    }\n    userAssert(\n      (spec.index !== undefined || spec.selector !== undefined) &&\n        (spec.index === undefined || spec.selector === undefined),\n      'Only one \"index\" or \"selector\" must be specified'\n    );\n\n    let matcher;\n    if (spec.index !== undefined) {\n      // Match by index, e.g. `index: 0`.\n      const specIndex = Number(spec.index);\n      matcher = (target, index) => index === specIndex;\n    } else {\n      // Match by selector, e.g. `:nth-child(2n+1)`.\n      const specSelector = /** @type {string} */ (spec.selector);\n      matcher = (target) => {\n        try {\n          return matches(target, specSelector);\n        } catch (e) {\n          throw user().createError(\n            `Bad subtarget selector: \"${specSelector}\"`,\n            e\n          );\n        }\n      };\n    }\n    return (spec.matcher = matcher);\n  }\n\n  /**\n   * Merges vars by defaulting values from the previous vars.\n   * @param {!Object<string, *>} newVars\n   * @param {!Object<string, *>} prevVars\n   * @return {!Object<string, *>}\n   * @private\n   */\n  mergeVars_(newVars, prevVars) {\n    // First combine all vars (previous and new) in one map. The new vars take\n    // precedence. This is done so that the new vars can be resolved from both\n    // the previous and new vars.\n    const result = map(prevVars);\n    for (const k in newVars) {\n      if (k.startsWith('--')) {\n        result[k] = newVars[k];\n      }\n    }\n    this.css_.withVars(result, () => {\n      for (const k in newVars) {\n        if (k.startsWith('--')) {\n          result[k] = this.css_.resolveCss(newVars[k]);\n        }\n      }\n    });\n    return result;\n  }\n\n  /**\n   * Merges timing by defaulting values from the previous timing.\n   * @param {!WebAnimationTimingDef} newTiming\n   * @param {!WebAnimationTimingDef} prevTiming\n   * @return {!WebAnimationTimingDef}\n   * @private\n   */\n  mergeTiming_(newTiming, prevTiming) {\n    // CSS time values in milliseconds.\n    const duration = this.css_.resolveMillis(\n      newTiming.duration,\n      prevTiming.duration\n    );\n    const delay = this.css_.resolveMillis(newTiming.delay, prevTiming.delay);\n    const endDelay = this.css_.resolveMillis(\n      newTiming.endDelay,\n      prevTiming.endDelay\n    );\n\n    // Numeric.\n    const iterations = this.css_.resolveNumber(\n      newTiming.iterations,\n      dev().assertNumber(prevTiming.iterations)\n    );\n    const iterationStart = this.css_.resolveNumber(\n      newTiming.iterationStart,\n      prevTiming.iterationStart\n    );\n\n    // Identifier CSS values.\n    const easing = this.css_.resolveIdent(newTiming.easing, prevTiming.easing);\n    const direction = /** @type {!WebAnimationTimingDirection} */ (\n      this.css_.resolveIdent(newTiming.direction, prevTiming.direction)\n    );\n    const fill = /** @type {!WebAnimationTimingFill} */ (\n      this.css_.resolveIdent(newTiming.fill, prevTiming.fill)\n    );\n\n    // Validate.\n    this.validateTime_(duration, newTiming.duration, 'duration');\n    this.validateTime_(delay, newTiming.delay, 'delay', /* negative */ true);\n    this.validateTime_(endDelay, newTiming.endDelay, 'endDelay');\n    userAssert(\n      iterations != null && iterations >= 0,\n      '\"iterations\" is invalid: %s',\n      newTiming.iterations\n    );\n    userAssert(\n      iterationStart != null && iterationStart >= 0 && isFinite(iterationStart),\n      '\"iterationStart\" is invalid: %s',\n      newTiming.iterationStart\n    );\n\n    userAssert(\n      isEnumValue(WebAnimationTimingDirection, direction),\n      `Unknown direction: ${direction}`\n    );\n\n    userAssert(\n      isEnumValue(WebAnimationTimingFill, fill),\n      `Unknown fill: ${fill}`\n    );\n\n    return {\n      duration,\n      delay,\n      endDelay,\n      iterations,\n      iterationStart,\n      easing,\n      direction,\n      fill,\n    };\n  }\n\n  /**\n   * @param {number|undefined} value\n   * @param {*} newValue\n   * @param {string} field\n   * @param {boolean=} opt_allowNegative\n   * @private\n   */\n  validateTime_(value, newValue, field, opt_allowNegative) {\n    // Ensure that positive or zero values are only allowed.\n    userAssert(\n      value != null && (value >= 0 || (value < 0 && opt_allowNegative)),\n      '\"%s\" is invalid: %s',\n      field,\n      newValue\n    );\n    // Make sure that the values are in milliseconds: show a warning if\n    // time is fractional.\n    if (newValue != null && Math.floor(value) != value && value < 1) {\n      user().warn(\n        TAG,\n        `\"${field}\" is fractional.` +\n          ' Note that all times are in milliseconds.'\n      );\n    }\n  }\n}\n\n/**\n * @implements {./parsers/css-expr-ast.CssContext}\n */\nclass CssContextImpl {\n  /**\n   * @param {!Window} win\n   * @param {!Document|!ShadowRoot} rootNode\n   * @param {string} baseUrl\n   * @param {!./web-animation-types.WebAnimationBuilderOptionsDef} options\n   */\n  constructor(win, rootNode, baseUrl, options) {\n    const {scaleByScope = false, scope = null} = options;\n\n    /** @const @private */\n    this.win_ = win;\n\n    /** @const @private {!Document|!ShadowRoot} */\n    this.rootNode_ = rootNode;\n\n    /** @const @private {?Element} */\n    this.scope_ = scope;\n\n    /** @const @private {boolean} */\n    this.scaleByScope_ = scaleByScope;\n\n    /** @const @private */\n    this.baseUrl_ = baseUrl;\n\n    /** @private {!Object<string, !CSSStyleDeclaration>} */\n    this.computedStyleCache_ = map();\n\n    /** @private {!Object<string, ?./parsers/css-expr-ast.CssNode>} */\n    this.parsedCssCache_ = map();\n\n    /** @private {?number} */\n    this.targetLength_ = null;\n\n    /** @private {?Element} */\n    this.currentTarget_ = null;\n\n    /** @private {?number} */\n    this.currentIndex_ = null;\n\n    /** @private {?Object<string, *>} */\n    this.vars_ = null;\n\n    /** @private {!Array<string>} */\n    this.varPath_ = [];\n\n    /** @private {?string} */\n    this.dim_ = null;\n\n    /**\n     * @private {?{\n     *   size: {width: number, height: number},\n     *   offset: {x: number, y: number},\n     *   scaleFactorX: number,\n     *   scaleFactorY: number,\n     * }}\n     */\n    this.viewportParams_ = null;\n  }\n\n  /** @return {!Document|!ShadowRoot} */\n  get rootNode() {\n    return this.rootNode_;\n  }\n\n  /**\n   * @param {string} mediaQuery\n   * @return {boolean}\n   */\n  matchMedia(mediaQuery) {\n    return this.win_.matchMedia(mediaQuery).matches;\n  }\n\n  /**\n   * @param {string} query\n   * @return {boolean}\n   */\n  supports(query) {\n    if (this.win_.CSS && this.win_.CSS.supports) {\n      return this.win_.CSS.supports(query);\n    }\n    return false;\n  }\n\n  /**\n   * @param {string} id\n   * @return {?Element}\n   */\n  getElementById(id) {\n    return this.scopedQuerySelector_(`#${escapeCssSelectorIdent(id)}`);\n  }\n\n  /**\n   * @param {string} selector\n   * @return {!Array<!Element>}\n   */\n  queryElements(selector) {\n    try {\n      return toArray(this.scopedQuerySelectorAll_(selector));\n    } catch (e) {\n      throw user().createError(`Bad query selector: \"${selector}\"`, e);\n    }\n  }\n\n  /**\n   * @param {!Element} target\n   * @param {string} prop\n   * @return {string}\n   */\n  measure(target, prop) {\n    // Get ID.\n    let targetId = target[TARGET_ANIM_ID];\n    if (!targetId) {\n      targetId = String(++animIdCounter);\n      target[TARGET_ANIM_ID] = targetId;\n    }\n\n    // Get and cache styles.\n    let styles = this.computedStyleCache_[targetId];\n    if (!styles) {\n      styles = computedStyle(this.win_, target);\n      this.computedStyleCache_[targetId] = /** @type {!CSSStyleDeclaration} */ (\n        styles\n      );\n    }\n\n    // Resolve a var or a property.\n    return prop.startsWith('--')\n      ? styles.getPropertyValue(prop)\n      : styles[getVendorJsPropertyName(styles, dashToCamelCase(prop))];\n  }\n\n  /**\n   * @param {number} len\n   * @protected\n   */\n  setTargetLength(len) {\n    this.targetLength_ = len;\n  }\n\n  /**\n   * @param {?Element} target\n   * @param {?number} index\n   * @param {function(?Element):T} callback\n   * @return {T}\n   * @template T\n   * @protected\n   */\n  withTarget(target, index, callback) {\n    const {currentIndex_: prevIndex, currentTarget_: prev} = this;\n    this.currentTarget_ = target;\n    this.currentIndex_ = index;\n    const result = callback(target);\n    this.currentTarget_ = prev;\n    this.currentIndex_ = prevIndex;\n    return result;\n  }\n\n  /**\n   * @param {?Object<string, *>} vars\n   * @param {function():T} callback\n   * @return {T}\n   * @template T\n   * @protected\n   */\n  withVars(vars, callback) {\n    const prev = this.vars_;\n    this.vars_ = vars;\n    const result = callback();\n    this.vars_ = prev;\n    return result;\n  }\n\n  /**\n   * @param {*} input\n   * @return {string}\n   * @protected\n   */\n  resolveCss(input) {\n    // Will always return a valid string, since the default value is `''`.\n    return dev().assertString(\n      this.resolveCss_(input, /* def */ '', /* normalize */ true)\n    );\n  }\n\n  /**\n   * @param {!Object<string, *>} input\n   * @return {!Object<string, string|number>}\n   */\n  resolveCssMap(input) {\n    const result = map();\n    for (const k in input) {\n      if (k == 'offset') {\n        result[k] = input[k];\n      } else {\n        result[k] = this.resolveCss(input[k]);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * @param {*} input\n   * @param {string|undefined} def\n   * @return {string|undefined}\n   */\n  resolveIdent(input, def) {\n    return this.resolveCss_(input, def, /* normalize */ false);\n  }\n\n  /**\n   * @param {*} input\n   * @param {number|undefined} def\n   * @return {number|undefined}\n   */\n  resolveMillis(input, def) {\n    if (input != null && input !== '') {\n      if (typeof input == 'number') {\n        return input;\n      }\n      const node = this.resolveAsNode_(input, /* normalize */ false);\n      if (node) {\n        return CssTimeNode.millis(node);\n      }\n    }\n    return def;\n  }\n\n  /**\n   * @param {*} input\n   * @param {number|undefined} def\n   * @return {number|undefined}\n   */\n  resolveNumber(input, def) {\n    if (input != null && input !== '') {\n      if (typeof input == 'number') {\n        return input;\n      }\n      const node = this.resolveAsNode_(input, /* normalize */ false);\n      if (node) {\n        return CssNumberNode.num(node);\n      }\n    }\n    return def;\n  }\n\n  /**\n   * @param {*} input\n   * @param {string|undefined} def\n   * @param {boolean} normalize\n   * @return {string|undefined}\n   * @private\n   */\n  resolveCss_(input, def, normalize) {\n    if (input == null || input === '') {\n      return def;\n    }\n    const inputCss = String(input);\n    if (typeof input == 'number') {\n      return inputCss;\n    }\n    // Test first if CSS contains any variable components. Otherwise, there's\n    // no need to spend cycles to parse/evaluate.\n    if (!isVarCss(inputCss, normalize)) {\n      return inputCss;\n    }\n    const result = this.resolveAsNode_(inputCss, normalize);\n    return result != null ? result.css() : def;\n  }\n\n  /**\n   * @param {*} input\n   * @param {boolean} normalize\n   * @return {?./parsers/css-expr-ast.CssNode}\n   * @private\n   */\n  resolveAsNode_(input, normalize) {\n    if (input == null || input === '') {\n      return null;\n    }\n    if (typeof input == 'number') {\n      return new CssNumberNode(input);\n    }\n    // Check if the expression has already been parsed. Notice that the parsed\n    // value could be `null`.\n    const css = String(input);\n    let node = this.parsedCssCache_[css];\n    if (node === undefined) {\n      node = parseCss(css);\n      this.parsedCssCache_[css] = node;\n    }\n    if (!node) {\n      return null;\n    }\n    return node.resolve(this, normalize);\n  }\n\n  /**\n   * @return {!Element}\n   * @private\n   */\n  requireTarget_() {\n    return user().assertElement(\n      this.currentTarget_,\n      'Only allowed when target is specified'\n    );\n  }\n\n  /** @override */\n  getVar(varName) {\n    userAssert(\n      this.varPath_.indexOf(varName) == -1,\n      `Recursive variable: \"${varName}\"`\n    );\n    this.varPath_.push(varName);\n    const rawValue =\n      this.vars_ && this.vars_[varName] != undefined\n        ? this.vars_[varName]\n        : this.currentTarget_\n        ? this.measure(this.currentTarget_, varName)\n        : null;\n    if (rawValue == null || rawValue === '') {\n      user().warn(TAG, `Variable not found: \"${varName}\"`);\n    }\n    // No need to normalize vars - they will be normalized later.\n    const result = this.resolveAsNode_(rawValue, /* normalize */ false);\n    this.varPath_.pop();\n    return result;\n  }\n\n  /** @override */\n  withDimension(dim, callback) {\n    const savedDim = this.dim_;\n    this.dim_ = dim;\n    const result = callback();\n    this.dim_ = savedDim;\n    return result;\n  }\n\n  /** @override */\n  getDimension() {\n    return this.dim_;\n  }\n\n  /** @override */\n  getViewportSize() {\n    return this.getViewportParams_().size;\n  }\n\n  /** @private */\n  getViewportParams_() {\n    if (!this.viewportParams_) {\n      if (this.scope_ && this.scaleByScope_) {\n        const rect = this.scope_./*OK*/ getBoundingClientRect();\n        const {offsetHeight, offsetWidth} = this.scope_;\n        this.viewportParams_ = {\n          offset: {x: rect.x, y: rect.y},\n          size: {width: offsetWidth, height: offsetHeight},\n          scaleFactorX: offsetWidth / (rect.width || 1),\n          scaleFactorY: offsetHeight / (rect.height || 1),\n        };\n      } else {\n        const {innerHeight, innerWidth} = this.win_;\n        this.viewportParams_ = {\n          offset: {x: 0, y: 0},\n          size: {width: innerWidth, height: innerHeight},\n          scaleFactorX: 1,\n          scaleFactorY: 1,\n        };\n      }\n    }\n    return this.viewportParams_;\n  }\n\n  /** @override */\n  getCurrentIndex() {\n    this.requireTarget_();\n    return dev().assertNumber(this.currentIndex_);\n  }\n\n  /** @override */\n  getTargetLength() {\n    this.requireTarget_();\n    return dev().assertNumber(this.targetLength_);\n  }\n\n  /** @override */\n  getCurrentFontSize() {\n    return this.getElementFontSize_(this.requireTarget_());\n  }\n\n  /** @override */\n  getRootFontSize() {\n    return this.getElementFontSize_(this.win_.document.documentElement);\n  }\n\n  /**\n   * @param {!Element} target\n   * @return {number}\n   * @private\n   */\n  getElementFontSize_(target) {\n    return parseFloat(this.measure(target, 'font-size'));\n  }\n\n  /** @override */\n  getCurrentElementRect() {\n    return this.getElementRect_(this.requireTarget_());\n  }\n\n  /** @override */\n  getElementRect(selector, selectionMethod) {\n    return this.getElementRect_(this.getElement_(selector, selectionMethod));\n  }\n\n  /**\n   * @param {string} selector\n   * @param {?string} selectionMethod\n   * @return {!Element}\n   * @private\n   */\n  getElement_(selector, selectionMethod) {\n    devAssert(\n      selectionMethod == null || selectionMethod == 'closest',\n      'Unknown selection method: %s',\n      selectionMethod\n    );\n    let element;\n    try {\n      if (selectionMethod == 'closest') {\n        const maybeFoundInScope = closestAncestorElementBySelector(\n          this.requireTarget_(),\n          selector\n        );\n        if (\n          maybeFoundInScope &&\n          (!this.scope_ || this.scope_.contains(maybeFoundInScope))\n        ) {\n          element = maybeFoundInScope;\n        }\n      } else {\n        element = this.scopedQuerySelector_(selector);\n      }\n    } catch (e) {\n      throw user().createError(`Bad query selector: \"${selector}\"`, e);\n    }\n    return user().assertElement(element, `Element not found: ${selector}`);\n  }\n\n  /**\n   * @param {!Element} target\n   * @return {!../../../src/layout-rect.LayoutRectDef}\n   * @private\n   */\n  getElementRect_(target) {\n    const {offset, scaleFactorX, scaleFactorY} = this.getViewportParams_();\n    const {height, width, x, y} = target./*OK*/ getBoundingClientRect();\n\n    // This assumes default `transform-origin: center center`\n    return layoutRectLtwh(\n      (x - offset.x) * scaleFactorX,\n      (y - offset.y) * scaleFactorY,\n      width * scaleFactorX,\n      height * scaleFactorY\n    );\n  }\n\n  /** @override */\n  resolveUrl(url) {\n    const resolvedUrl = resolveRelativeUrl(url, this.baseUrl_);\n    return assertHttpsUrl(resolvedUrl, this.currentTarget_ || '');\n  }\n\n  /**\n   * @param {string} selector\n   * @return {?Element}\n   * @private\n   */\n  scopedQuerySelector_(selector) {\n    if (this.scope_) {\n      return /*OK*/ scopedQuerySelector(this.scope_, selector);\n    }\n    return this.rootNode_./*OK*/ querySelector(selector);\n  }\n\n  /**\n   * @param {string} selector\n   * @return {!NodeList}\n   * @private\n   */\n  scopedQuerySelectorAll_(selector) {\n    if (this.scope_) {\n      return /*OK*/ scopedQuerySelectorAll(this.scope_, selector);\n    }\n    return this.rootNode_./*OK*/ querySelectorAll(selector);\n  }\n}\n", "import {Services} from '#service';\n\nimport {installWebAnimationsIfNecessary} from './install-polyfill';\nimport {WebAnimationBuilderOptionsDef} from './web-animation-types';\nimport {Builder} from './web-animations';\n\nexport class WebAnimationService {\n  /**\n   * @param {!../../../src/service/ampdoc-impl.AmpDoc} ampdoc\n   */\n  constructor(ampdoc) {\n    /** @private @const */\n    this.ampdoc_ = ampdoc;\n\n    /** @private @const */\n    this.vsync_ = Services.vsyncFor(ampdoc.win);\n\n    /** @private @const */\n    this.owners_ = Services.ownersForDoc(ampdoc);\n  }\n\n  /**\n   * @param {!WebAnimationBuilderOptionsDef} options\n   * @return {!Promise<Builder>}\n   */\n  createBuilder(options) {\n    return installWebAnimationsIfNecessary(this.ampdoc_).then(\n      () =>\n        new Builder(\n          this.ampdoc_.win,\n          this.ampdoc_.getRootNode(),\n          this.ampdoc_.getUrl(),\n          this.vsync_,\n          this.owners_,\n          options\n        )\n    );\n  }\n}\n", "import {Services} from '#service';\n\n/**\n * Pass class helps to manage single-pass process. A pass is scheduled using\n * delay method. Only one pass can be pending at a time. If no pass is pending\n * the process is considered to be \"idle\".\n */\nexport class Pass {\n  /**\n   * Creates a new Pass instance.\n   * @param {!Window} win\n   * @param {function()} handler Handler to be executed when pass is triggered.\n   * @param {number=} opt_defaultDelay Default delay to be used when schedule\n   *   is called without one.\n   */\n  constructor(win, handler, opt_defaultDelay) {\n    this.timer_ = Services.timerFor(win);\n\n    /** @private @const {function()} */\n    this.handler_ = handler;\n\n    /** @private @const {number} */\n    this.defaultDelay_ = opt_defaultDelay || 0;\n\n    /** @private {number|string} */\n    this.scheduled_ = -1;\n\n    /** @private {number} */\n    this.nextTime_ = 0;\n\n    /** @private {boolean} */\n    this.running_ = false;\n\n    /**\n     * @private\n     * @const {function()}\n     */\n    this.boundPass_ = () => {\n      this.pass_();\n    };\n  }\n\n  /**\n   * Whether or not a pass is currently pending.\n   * @return {boolean}\n   */\n  isPending() {\n    return this.scheduled_ != -1;\n  }\n\n  /**\n   * Tries to schedule a new pass optionally with specified delay. If the new\n   * requested pass is requested before the pending pass, the pending pass is\n   * canceled. If the new pass is requested after the pending pass, the newly\n   * requested pass is ignored.\n   *\n   * Returns {@code true} if the pass has been scheduled and {@code false} if\n   * ignored.\n   *\n   * @param {number=} opt_delay Delay to schedule the pass. If not specified\n   *   the default delay is used, falling back to 0.\n   * @return {boolean}\n   */\n  schedule(opt_delay) {\n    let delay = opt_delay || this.defaultDelay_;\n    if (this.running_ && delay < 10) {\n      // If we get called recursively, wait at least 10ms for the next\n      // execution.\n      delay = 10;\n    }\n\n    const nextTime = Date.now() + delay;\n    // Schedule anew if nothing is scheduled currently or if the new time is\n    // sooner then previously requested.\n    if (!this.isPending() || nextTime - this.nextTime_ < -10) {\n      this.cancel();\n      this.nextTime_ = nextTime;\n      this.scheduled_ = this.timer_.delay(this.boundPass_, delay);\n\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   *\n   */\n  pass_() {\n    this.scheduled_ = -1;\n    this.nextTime_ = 0;\n    this.running_ = true;\n    this.handler_();\n    this.running_ = false;\n  }\n\n  /**\n   * Cancels the pending pass if any.\n   */\n  cancel() {\n    if (this.isPending()) {\n      this.timer_.cancel(this.scheduled_);\n      this.scheduled_ = -1;\n    }\n  }\n}\n", "import {ActionTrust} from '#core/constants/action-constants';\nimport {getChildJsonConfig} from '#core/dom';\nimport {setInitialDisplay, setStyles, toggle} from '#core/dom/style';\nimport {clamp} from '#core/math';\nimport {isFiniteNumber} from '#core/types';\n\nimport {Services} from '#service';\n\nimport {getDetail, listen} from '#utils/event-helper';\nimport {dev, userAssert} from '#utils/log';\n\nimport {installWebAnimationsIfNecessary} from './install-polyfill';\nimport {WebAnimationService} from './web-animation-service';\nimport {WebAnimationPlayState} from './web-animation-types';\nimport {Builder} from './web-animations';\n\nimport {Pass} from '../../../src/pass';\n\nconst TAG = 'amp-animation';\n\nexport class AmpAnimation extends AMP.BaseElement {\n  /** @param {!AmpElement} element */\n  constructor(element) {\n    super(element);\n\n    /** @private {boolean} */\n    this.triggerOnVisibility_ = false;\n\n    /** @private {boolean} */\n    this.isIntersecting_ = false;\n\n    /** @private {boolean} */\n    this.visible_ = false;\n\n    /** @private {boolean} */\n    this.pausedByAction_ = false;\n\n    /** @private {boolean} */\n    this.triggered_ = false;\n\n    /** @private {!Array<!UnlistenDef>} */\n    this.cleanups_ = [];\n\n    /** @private {?JsonObject} */\n    this.configJson_ = null;\n\n    /** @private {?./runners/animation-runner.AnimationRunner} */\n    this.runner_ = null;\n\n    /** @private {?Promise} */\n    this.runnerPromise_ = null;\n\n    /** @private {?Pass} */\n    this.restartPass_ = null;\n  }\n\n  /** @override */\n  buildCallback() {\n    const ampdoc = this.getAmpDoc();\n\n    // Trigger.\n    const trigger = this.element.getAttribute('trigger');\n    if (trigger) {\n      this.triggerOnVisibility_ = userAssert(\n        trigger == 'visibility',\n        'Only allowed value for \"trigger\" is \"visibility\": %s',\n        this.element\n      );\n    }\n\n    this.configJson_ = getChildJsonConfig(this.element);\n\n    if (this.triggerOnVisibility_) {\n      // Make the element minimally displayed to make sure that `layoutCallback`\n      // is called.\n      this.mutateElement(() => {\n        setStyles(this.element, {\n          visibility: 'hidden',\n          top: '0px',\n          left: '0px',\n          width: '1px',\n          height: '1px',\n          position: 'fixed',\n        });\n        toggle(this.element, true);\n        setInitialDisplay(this.element, 'block');\n      });\n    }\n\n    // Restart with debounce.\n    this.restartPass_ = new Pass(\n      this.win,\n      () => {\n        if (!this.pausedByAction_) {\n          this.startOrResume_();\n        }\n      },\n      /* delay */ 50\n    );\n\n    // Visibility.\n    this.cleanups_.push(\n      ampdoc.onVisibilityChanged(() => {\n        this.setVisible_(this.isIntersecting_ && ampdoc.isVisible());\n      })\n    );\n    const io = new ampdoc.win.IntersectionObserver(\n      (records) => {\n        const {isIntersecting} = records[records.length - 1];\n        this.isIntersecting_ = isIntersecting;\n        this.setVisible_(this.isIntersecting_ && ampdoc.isVisible());\n      },\n      {threshold: 0.001}\n    );\n    io.observe(dev().assertElement(this.element.parentElement));\n    this.cleanups_.push(() => io.disconnect());\n\n    // Resize.\n    this.cleanups_.push(listen(this.win, 'resize', () => this.onResize_()));\n\n    // Actions.\n    this.registerDefaultAction(\n      this.startAction_.bind(this),\n      'start',\n      ActionTrust.LOW\n    );\n    this.registerAction(\n      'restart',\n      this.restartAction_.bind(this),\n      ActionTrust.LOW\n    );\n    this.registerAction('pause', this.pauseAction_.bind(this), ActionTrust.LOW);\n    this.registerAction(\n      'resume',\n      this.resumeAction_.bind(this),\n      ActionTrust.LOW\n    );\n    this.registerAction(\n      'togglePause',\n      this.togglePauseAction_.bind(this),\n      ActionTrust.LOW\n    );\n    this.registerAction(\n      'seekTo',\n      this.seekToAction_.bind(this),\n      ActionTrust.LOW\n    );\n    this.registerAction(\n      'reverse',\n      this.reverseAction_.bind(this),\n      ActionTrust.LOW\n    );\n    this.registerAction(\n      'finish',\n      this.finishAction_.bind(this),\n      ActionTrust.LOW\n    );\n    this.registerAction(\n      'cancel',\n      this.cancelAction_.bind(this),\n      ActionTrust.LOW\n    );\n  }\n\n  /** @override */\n  detachedCallback() {\n    const cleanups = this.cleanups_.slice(0);\n    this.cleanups_.length = 0;\n    cleanups.forEach((cleanup) => cleanup());\n  }\n\n  /**\n   * Returns the animation spec.\n   * @return {?JsonObject}\n   */\n  getAnimationSpec() {\n    return /** @type {?JsonObject} */ (this.configJson_);\n  }\n\n  /** @override */\n  layoutCallback() {\n    if (this.triggerOnVisibility_) {\n      this.startAction_();\n    }\n    return Promise.resolve();\n  }\n\n  /** @override */\n  pauseCallback() {\n    this.setVisible_(false);\n  }\n\n  /**\n   * @param {?../../../src/service/action-impl.ActionInvocation=} opt_invocation\n   * @return {?Promise}\n   * @private\n   */\n  startAction_(opt_invocation) {\n    // The animation has been triggered, but there's no guarantee that it\n    // will actually be running.\n    this.triggered_ = true;\n    if (this.visible_) {\n      return this.startOrResume_(opt_invocation ? opt_invocation.args : null);\n    }\n    return Promise.resolve();\n  }\n\n  /**\n   * @param {!../../../src/service/action-impl.ActionInvocation} invocation\n   * @return {?Promise}\n   * @private\n   */\n  restartAction_(invocation) {\n    this.cancel_();\n    // The animation has been triggered, but there's no guarantee that it\n    // will actually be running.\n    this.triggered_ = true;\n    if (this.visible_) {\n      return this.startOrResume_(invocation.args);\n    }\n    return Promise.resolve();\n  }\n\n  /**\n   * @return {?Promise}\n   * @private\n   */\n  pauseAction_() {\n    if (!this.triggered_) {\n      return Promise.resolve();\n    }\n    return this.createRunnerIfNeeded_().then(() => {\n      this.pause_();\n      this.pausedByAction_ = true;\n    });\n  }\n\n  /**\n   * @return {?Promise}\n   * @private\n   */\n  resumeAction_() {\n    if (!this.triggered_) {\n      return Promise.resolve();\n    }\n    return this.createRunnerIfNeeded_().then(() => {\n      if (this.visible_) {\n        this.runner_.resume();\n        this.pausedByAction_ = false;\n      }\n    });\n  }\n\n  /**\n   * @return {?Promise}\n   * @private\n   */\n  togglePauseAction_() {\n    if (!this.triggered_) {\n      return Promise.resolve();\n    }\n    return this.createRunnerIfNeeded_().then(() => {\n      if (this.visible_) {\n        if (this.runner_.getPlayState() == WebAnimationPlayState.PAUSED) {\n          return this.startOrResume_();\n        } else {\n          this.pause_();\n          this.pausedByAction_ = true;\n        }\n      }\n    });\n  }\n\n  /**\n   * @param {!../../../src/service/action-impl.ActionInvocation} invocation\n   * @return {?Promise}\n   * @private\n   */\n  seekToAction_(invocation) {\n    let positionObserverData = null;\n    if (invocation.event) {\n      const detail = getDetail(/** @type {!Event} */ (invocation.event));\n      if (detail) {\n        positionObserverData = detail['positionObserverData'] || null;\n      }\n    }\n\n    return this.createRunnerIfNeeded_(null, positionObserverData).then(() => {\n      // The animation will be triggered (in paused state) and seek will happen\n      // regardless of visibility\n      this.triggered_ = true;\n      this.pause_();\n      this.pausedByAction_ = true;\n      // time based seek\n      const time = parseFloat(invocation.args && invocation.args['time']);\n      if (isFiniteNumber(time)) {\n        this.runner_.seekTo(time);\n      }\n      // percent based seek\n      const percent = parseFloat(invocation.args && invocation.args['percent']);\n      if (isFiniteNumber(percent)) {\n        this.runner_.seekToPercent(clamp(percent, 0, 1));\n      }\n    });\n  }\n\n  /**\n   * @return {?Promise}\n   * @private\n   */\n  reverseAction_() {\n    if (!this.triggered_) {\n      return Promise.resolve();\n    }\n    return this.createRunnerIfNeeded_().then(() => {\n      if (this.visible_) {\n        this.runner_.reverse();\n      }\n    });\n  }\n\n  /**\n   * @return {?Promise}\n   * @private\n   */\n  finishAction_() {\n    this.finish_();\n    return Promise.resolve();\n  }\n\n  /**\n   * @return {?Promise}\n   * @private\n   */\n  cancelAction_() {\n    this.cancel_();\n    return Promise.resolve();\n  }\n\n  /**\n   * @param {boolean} visible\n   * @private\n   */\n  setVisible_(visible) {\n    if (this.visible_ != visible) {\n      this.visible_ = visible;\n      if (this.triggered_) {\n        if (this.visible_) {\n          if (!this.pausedByAction_) {\n            this.startOrResume_();\n          }\n        } else {\n          this.pause_();\n        }\n      }\n    }\n  }\n\n  /** @private */\n  onResize_() {\n    // Store the previous `triggered` and `pausedByAction` value since\n    // `cancel` may reset it.\n    const {pausedByAction_: pausedByAction, triggered_: triggered} = this;\n\n    // Stop animation right away.\n    if (this.runner_) {\n      this.runner_.cancel();\n      this.runner_ = null;\n      this.runnerPromise_ = null;\n    }\n\n    // Restart the animation, but debounce to avoid re-starting it multiple\n    // times per restart.\n    this.triggered_ = triggered;\n    this.pausedByAction_ = pausedByAction;\n    if (this.triggered_ && this.visible_) {\n      this.restartPass_.schedule();\n    }\n  }\n\n  /**\n   * @param {?JsonObject=} opt_args\n   * @return {?Promise}\n   * @private\n   */\n  startOrResume_(opt_args) {\n    if (!this.triggered_ || !this.visible_) {\n      return null;\n    }\n\n    this.pausedByAction_ = false;\n\n    if (this.runner_) {\n      this.runner_.resume();\n      return null;\n    }\n\n    return this.createRunnerIfNeeded_(opt_args).then(() => {\n      this.runner_.start();\n    });\n  }\n\n  /**\n   * Creates the runner but animations will not start.\n   * @param {?JsonObject=} opt_args\n   * @param {?JsonObject=} opt_positionObserverData\n   * @return {!Promise}\n   * @private\n   */\n  createRunnerIfNeeded_(opt_args, opt_positionObserverData) {\n    if (!this.runnerPromise_) {\n      this.runnerPromise_ = this.createRunner_(\n        opt_args,\n        opt_positionObserverData\n      ).then((runner) => {\n        this.runner_ = runner;\n        this.runner_.onPlayStateChanged(this.playStateChanged_.bind(this));\n        this.runner_.init();\n      });\n    }\n\n    return this.runnerPromise_;\n  }\n\n  /** @private */\n  finish_() {\n    this.triggered_ = false;\n    this.pausedByAction_ = false;\n    if (this.runner_) {\n      this.runner_.finish();\n      this.runner_ = null;\n      this.runnerPromise_ = null;\n    }\n  }\n\n  /** @private */\n  cancel_() {\n    this.triggered_ = false;\n    this.pausedByAction_ = false;\n    if (this.runner_) {\n      this.runner_.cancel();\n      this.runner_ = null;\n      this.runnerPromise_ = null;\n    }\n  }\n\n  /**\n   * @param {?JsonObject=} opt_args\n   * @param {?JsonObject=} opt_positionObserverData\n   * @return {!Promise<!./runners/animation-runner.AnimationRunner>}\n   * @private\n   */\n  createRunner_(opt_args, opt_positionObserverData) {\n    // Force cast to `WebAnimationDef`. It will be validated during preparation\n    // phase.\n    const configJson = /** @type {!./web-animation-types.WebAnimationDef} */ (\n      this.configJson_\n    );\n    const args = /** @type {?./web-animation-types.WebAnimationDef} */ (\n      opt_args || null\n    );\n\n    // Ensure polyfill is installed.\n    const ampdoc = this.getAmpDoc();\n    const polyfillPromise = installWebAnimationsIfNecessary(ampdoc);\n    const readyPromise = ampdoc.whenReady();\n    const hostWin = this.win;\n    const baseUrl = ampdoc.getUrl();\n    return Promise.all([polyfillPromise, readyPromise]).then(() => {\n      const builder = new Builder(\n        hostWin,\n        this.getRootNode_(),\n        baseUrl,\n        this.getVsync(),\n        Services.ownersForDoc(this.element.getAmpDoc())\n      );\n      return builder.createRunner(configJson, args, opt_positionObserverData);\n    });\n  }\n\n  /**\n   * @return {!Document|!ShadowRoot}\n   * @private\n   */\n  getRootNode_() {\n    return this.getAmpDoc().getRootNode();\n  }\n\n  /** @private */\n  pause_() {\n    if (this.runner_) {\n      this.runner_.pause();\n    }\n  }\n\n  /**\n   * @param {!WebAnimationPlayState} playState\n   * @private\n   */\n  playStateChanged_(playState) {\n    if (playState == WebAnimationPlayState.FINISHED) {\n      this.finish_();\n    }\n  }\n}\n\nAMP.extension(TAG, '0.1', function (AMP) {\n  AMP.registerElement(TAG, AmpAnimation);\n  AMP.registerServiceForDoc('web-animation', WebAnimationService);\n});\n"],
  "mappings": "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,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,GAAE,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC,IAAG,IAAG,CAAC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AAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE,CAAC,GAAE;QAAI,IAAG,CAAC,GAAE;QAAI,IAAG,CAAC,GAAE;SAAK;QAAC,GAAE,CAAC,GAAE;QAAI,IAAG,CAAC,GAAE;QAAI,IAAG,CAAC,GAAE;SAAK;QAAC,GAAE,CAAC,GAAE;QAAI,IAAG,CAAC,GAAE;QAAI,IAAG,CAAC,GAAE;SAAK;QAAC,GAAE,CAAC,GAAE;QAAI,IAAG,CAAC,GAAE;QAAI,IAAG,CAAC,GAAE;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAI,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,IAAG,CAAC,GAAE;SAAM;QAAC,IAAG,CAAC,GAAE;SAAM;QAAC,GAAE;QAAI,GAAE;QAAE,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAI,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAI,GAAE;QAAE,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAI,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE,CAAC,GAAE;SAAI,EAAE,KAAI,CAAC,GAAE,KAAI;QAAC,IAAG,CAAC,GAAE;SAAM;QAAC,IAAG,CAAC,GAAE;QAAK,IAAG,CAAC,GAAE;SAAM;QAAC,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK,EAAE,KAAI,CAAC,GAAE,OAAM;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,IAAG,CAAC,GAAE;QAAK,IAAG;SAAK,EAAE,KAAI,CAAC,GAAE,MAAK;QAAC,IAAG,CAAC,GAAE;QAAK,IAAG;SAAK;QAAC,IAAG,CAAC,GAAE;QAAK,IAAG;SAAK;QAAC,IAAG,CAAC,GAAE;QAAK,IAAG;SAAK;QAAC,IAAG,CAAC,GAAE;QAAK,IAAG;SAAK,EAAE,KAAI,CAAC,GAAE,MAAK;QAAC,IAAG,CAAC,GAAE;SAAM;QAAC,GAAE,CAAC,GAAE;SAAM,EAAE,KAAI,CAAC,GAAE,MAAK;QAAC,IAAG,CAAC,GAAE;SAAM;QAAC,GAAE,CAAC,GAAE;SAAM,EAAE,KAAI,CAAC,GAAE,MAAK;QAAC,IAAG,CAAC,GAAE;SAAM;QAAC,GAAE,CAAC,GAAE;SAAM,EAAE,KAAI,CAAC,GAAE,MAAK;QAAC,IAAG,CAAC,GAAE;SAAM;QAAC,GAAE,CAAC,GAAE;SAAM;QAAC,IAAG,CAAC,GAAE;SAAM,EAAE,KAAI,CAAC,GAAE,MAAK;QAAC,IAAG,CAAC,GAAE;SAAM,EAAE,KAAI,CAAC,GAAE,MAAK,EAAE,KAAI,CAAC,GAAE,MAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK,EAAE,KAAI,CAAC,GAAE,MAAK;QAAC,GAAE;QAAI,GAAE;QAAE,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,IAAG,CAAC,GAAE;QAAK,IAAG,CAAC,GAAE;SAAM,EAAE,KAAI,CAAC,GAAE,MAAK;QAAC,GAAE;QAAI,GAAE;QAAE,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG,CAAC,GAAE;QAAK,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;Q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AAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAG,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;Q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AAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;SAAK;QAAC,GAAE;QAAI,GAAE;QAAE,GAAE;QAAE,GAAE;QAAE,GAAE;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAG,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,IAAG;QAAI,I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",
  "names": []
}
